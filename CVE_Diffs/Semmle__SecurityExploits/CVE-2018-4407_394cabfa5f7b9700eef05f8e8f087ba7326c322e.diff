Semmle__SecurityExploits
commit 394cabfa5f7b9700eef05f8e8f087ba7326c322e
Author:     Jorge Vallecillo <jorgevallecilloc@gmail.com>
AuthorDate: Sun Nov 25 10:16:14 2018 -0600
Commit:     Jorge Vallecillo <jorgevallecilloc@gmail.com>
CommitDate: Sun Nov 25 10:16:14 2018 -0600

     CVE-2018-4407 PoC docs: Advice to use linux capabilities instead of running with full root privileges

diff --git a/apple/darwin-xnu/icmp_error_CVE-2018-4407/README.md b/apple/darwin-xnu/icmp_error_CVE-2018-4407/README.md
index 5ce94d5..1dfd364 100644
--- a/apple/darwin-xnu/icmp_error_CVE-2018-4407/README.md
+++ b/apple/darwin-xnu/icmp_error_CVE-2018-4407/README.md
@@ -35,3 +35,12 @@ sudo ./crash_all
 ```
 
 Use `crash_all` with care: it will crash any unpatched Apple device that is connected to the same network as you.
+
+Alternatively you can give the `CAP_NET_RAW` capability to the binaries instead of using them under full root privileges:
+
+```bash
+sudo setcap cap_net_raw=ep crash_all
+sudo setcap cap_net_raw=ep direct_attack
+```
+
+Some libs are required to use setcap (libcap-ng-utils, libcap-progs, libcap2)
