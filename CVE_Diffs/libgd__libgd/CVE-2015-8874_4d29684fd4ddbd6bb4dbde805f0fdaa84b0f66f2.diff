libgd__libgd
commit 4d29684fd4ddbd6bb4dbde805f0fdaa84b0f66f2
Author:     Ondřej Surý <ondrej@sury.org>
AuthorDate: Fri May 20 09:39:38 2016 +0200
Commit:     Mike Frysinger <vapier@gentoo.org>
CommitDate: Fri May 20 10:37:44 2016 -0400

    CVE-2015-8874

diff --git a/src/gd.c b/src/gd.c
index 300dfce..0603247 100644
--- a/src/gd.c
+++ b/src/gd.c
@@ -1938,6 +1938,17 @@ BGD_DECLARE(void) gdImageFillToBorder (gdImagePtr im, int x, int y, int border,
 	restoreAlphaBleding = im->alphaBlendingFlag;
 	im->alphaBlendingFlag = 0;
 
+	if (x >= im->sx) {
+		x = im->sx - 1;
+	} else if (x < 0) {
+		x = 0;
+	}
+	if (y >= im->sy) {
+		y = im->sy - 1;
+	} else if (y < 0) {
+		y = 0;
+	}
+	
 	for (i = x; (i >= 0); i--) {
 		if (gdImageGetPixel (im, i, y) == border) {
 			break;
