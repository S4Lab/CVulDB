libguestfs__libguestfs
commit 38bc7c98dff94b5ad451da86817f34a6fbc75b08
Author:     Richard W.M. Jones <rjones@redhat.com>
AuthorDate: Thu Oct 21 23:33:15 2010 +0100
Commit:     Richard W.M. Jones <rjones@redhat.com>
CommitDate: Fri Oct 22 17:45:06 2010 +0100

    virt-make-fs: Specify format of disk (RHBZ#642934,CVE-2010-3851).

diff --git a/tools/virt-make-fs b/tools/virt-make-fs
index 1a6aee4fa..4e928af44 100755
--- a/tools/virt-make-fs
+++ b/tools/virt-make-fs
@@ -405,7 +405,7 @@ eval {
 
     # Run libguestfs.
     my $g = Sys::Guestfs->new ();
-    $g->add_drive ($output);
+    $g->add_drive_opts ($output, format => $format);
     $g->launch ();
 
     if ($type eq "ntfs" && !feature_available ($g, "ntfs3g", "ntfsprogs")) {
