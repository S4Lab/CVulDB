linux-okernel__linux-okernel
commit ab46ee26dc90c5608c0d51c33a029fe514c0a49d
Author:     Patrick McHardy <kaber@trash.net>
AuthorDate: Mon Jun 19 19:14:21 2006 +0200
Commit:     Chris Wright <chrisw@sous-sol.org>
CommitDate: Tue Jun 20 01:54:53 2006 -0700

    [PATCH] xt_sctp: fix endless loop caused by 0 chunk length (CVE-2006-3085)
    
    Fix endless loop in the SCTP match similar to those already fixed in the
    SCTP conntrack helper (was CVE-2006-1527).
    
    Signed-off-by: Patrick McHardy <kaber@trash.net>
    Signed-off-by: Chris Wright <chrisw@sous-sol.org>

diff --git a/net/netfilter/xt_sctp.c b/net/netfilter/xt_sctp.c
index 10fbfc5ba758..239018244407 100644
--- a/net/netfilter/xt_sctp.c
+++ b/net/netfilter/xt_sctp.c
@@ -62,7 +62,7 @@ match_packet(const struct sk_buff *skb,
 
 	do {
 		sch = skb_header_pointer(skb, offset, sizeof(_sch), &_sch);
-		if (sch == NULL) {
+		if (sch == NULL || sch->length == 0) {
 			duprintf("Dropping invalid SCTP packet.\n");
 			*hotdrop = 1;
 			return 0;
