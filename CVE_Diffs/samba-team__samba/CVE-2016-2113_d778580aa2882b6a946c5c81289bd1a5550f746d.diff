samba-team__samba
commit d778580aa2882b6a946c5c81289bd1a5550f746d
Author:     Stefan Metzmacher <metze@samba.org>
AuthorDate: Sat Mar 26 08:38:46 2016 +0100
Commit:     Stefan Metzmacher <metze@samba.org>
CommitDate: Wed Mar 30 04:17:29 2016 +0200

    CVE-2016-2113: selftest: use "tls verify peer = no_check"
    
    Individual tests will check the more secure values.
    
    BUG: https://bugzilla.samba.org/show_bug.cgi?id=11752
    
    Signed-off-by: Stefan Metzmacher <metze@samba.org>
    Reviewed-by: Alexander Bokovoy <ab@samba.org>

diff --git a/selftest/selftest.pl b/selftest/selftest.pl
index 11d661d38b5..f7b7f951bb9 100755
--- a/selftest/selftest.pl
+++ b/selftest/selftest.pl
@@ -586,6 +586,7 @@ sub write_clientconf($$$)
         winbind separator = /
 	tls cafile = ${cacert}
 	tls crlfile = ${cacrl_pem}
+	tls verify peer = no_check
 ";
 	close(CF);
 }
diff --git a/selftest/target/Samba4.pm b/selftest/target/Samba4.pm
index 4272159c5d5..f8db61875d2 100755
--- a/selftest/target/Samba4.pm
+++ b/selftest/target/Samba4.pm
@@ -523,6 +523,7 @@ sub provision_raw_step1($$)
 	interfaces = $ctx->{interfaces}
 	tls dh params file = $ctx->{tlsdir}/dhparms.pem
 	tls crlfile = ${crlfile}
+	tls verify peer = no_check
 	panic action = $RealBin/gdb_backtrace \%d
 	wins support = yes
 	server role = $ctx->{server_role}
