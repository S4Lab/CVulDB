samba-team__samba
commit 9c1ead502bc3258d444ea0cd5f3148653419d298
Author:     Stefan Metzmacher <metze@samba.org>
AuthorDate: Fri Dec 9 09:26:32 2016 +0100
Commit:     Karolin Seeger <kseeger@samba.org>
CommitDate: Wed Sep 20 13:04:10 2017 +0200

    CVE-2017-12150: s3:pylibsmb: make use of SMB_SIGNING_DEFAULT for 'samba.samba3.libsmb_samba_internal'
    
    BUG: https://bugzilla.samba.org/show_bug.cgi?id=12997
    
    Signed-off-by: Stefan Metzmacher <metze@samba.org>

diff --git a/source3/libsmb/pylibsmb.c b/source3/libsmb/pylibsmb.c
index 39afdc8a952..d2167e917d6 100644
--- a/source3/libsmb/pylibsmb.c
+++ b/source3/libsmb/pylibsmb.c
@@ -451,7 +451,7 @@ static int py_cli_state_init(struct py_cli_state *self, PyObject *args,
 
 	req = cli_full_connection_creds_send(
 		NULL, self->ev, "myname", host, NULL, 0, share, "?????",
-		cli_creds, flags, 0);
+		cli_creds, flags, SMB_SIGNING_DEFAULT);
 	if (!py_tevent_req_wait_exc(self->ev, req)) {
 		return -1;
 	}
