samba-team__samba
commit e7be37ec66870be1e34f15b418bcddab3dc6b0d4
Author:     Ralph Boehme <slow@samba.org>
AuthorDate: Fri Mar 18 08:45:11 2016 +0100
Commit:     Stefan Metzmacher <metze@samba.org>
CommitDate: Wed Mar 30 04:18:51 2016 +0200

    CVE-2016-2118(<=4.3) docs-xml: add "allow dcerpc auth level connect" defaulting to "yes"
    
    BUG: https://bugzilla.samba.org/show_bug.cgi?id=11616
    
    Signed-off-by: Ralph Boehme <slow@samba.org>
    Reviewed-by: Stefan Metzmacher <metze@samba.org>

diff --git a/lib/param/param_table.c b/lib/param/param_table.c
index 72d3189fdd7..5f699cf2218 100644
--- a/lib/param/param_table.c
+++ b/lib/param/param_table.c
@@ -4080,6 +4080,14 @@ struct parm_struct parm_table[] = {
 		.special	= NULL,
 		.enum_list	= enum_smb_signing_vals,
 	},
+	{
+		.label		= "allow dcerpc auth level connect",
+		.type		= P_BOOL,
+		.p_class	= P_GLOBAL,
+		.offset		= GLOBAL_VAR(allow_dcerpc_auth_level_connect),
+		.special	= NULL,
+		.enum_list	= NULL
+	},
 
 	{NULL,  P_BOOL,  P_NONE,  0,  NULL,  NULL,  0}
 };
