samba-team__samba
commit 894aad5f71382ece490c03ab92a9ff881ad0c98b
Author:     Stefan Metzmacher <metze@samba.org>
AuthorDate: Sat Mar 26 18:08:16 2016 +0100
Commit:     Stefan Metzmacher <metze@samba.org>
CommitDate: Tue Apr 12 19:25:24 2016 +0200

    CVE-2016-2111: s4:param: use "client use spnego" to initialize options->use_spnego
    
    BUG: https://bugzilla.samba.org/show_bug.cgi?id=11749
    
    Signed-off-by: Stefan Metzmacher <metze@samba.org>
    Reviewed-by: Alexander Bokovoy <ab@samba.org>

diff --git a/source4/param/loadparm.c b/source4/param/loadparm.c
index af3313f6dd8..71331fb1835 100644
--- a/source4/param/loadparm.c
+++ b/source4/param/loadparm.c
@@ -36,7 +36,7 @@ void lpcfg_smbcli_options(struct loadparm_context *lp_ctx,
 {
 	options->max_xmit = lpcfg_max_xmit(lp_ctx);
 	options->max_mux = lpcfg_max_mux(lp_ctx);
-	options->use_spnego = lpcfg_nt_status_support(lp_ctx) && lpcfg_use_spnego(lp_ctx);
+	options->use_spnego = lpcfg_nt_status_support(lp_ctx) && lpcfg_client_use_spnego(lp_ctx);
 	options->signing = lpcfg_client_signing(lp_ctx);
 	options->request_timeout = SMB_REQUEST_TIMEOUT;
 	options->ntstatus_support = lpcfg_nt_status_support(lp_ctx);
