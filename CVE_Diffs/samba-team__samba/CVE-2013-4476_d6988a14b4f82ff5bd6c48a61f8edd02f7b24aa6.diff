samba-team__samba
commit d6988a14b4f82ff5bd6c48a61f8edd02f7b24aa6
Author:     Björn Baumbach <bb@sernet.de>
AuthorDate: Tue Oct 29 17:49:55 2013 +0100
Commit:     Karolin Seeger <kseeger@samba.org>
CommitDate: Fri Nov 8 10:54:54 2013 +0100

    CVE-2013-4476: samba-tool provision: create ${private_dir}/tls with mode 0700
    
    Bug: https://bugzilla.samba.org/show_bug.cgi?id=10234
    
    Signed-off-by: Björn Baumbach <bb@sernet.de>
    Reviewed-by: Stefan Metzmacher <metze@samba.org>

diff --git a/python/samba/provision/__init__.py b/python/samba/provision/__init__.py
index 89f029a2afc..4af6b6955d0 100644
--- a/python/samba/provision/__init__.py
+++ b/python/samba/provision/__init__.py
@@ -2024,7 +2024,7 @@ def provision(logger, session_info, credentials, smbconf=None,
     if not os.path.exists(paths.private_dir):
         os.mkdir(paths.private_dir)
     if not os.path.exists(os.path.join(paths.private_dir, "tls")):
-        os.mkdir(os.path.join(paths.private_dir, "tls"))
+        os.makedirs(os.path.join(paths.private_dir, "tls"), 0700)
     if not os.path.exists(paths.state_dir):
         os.mkdir(paths.state_dir)
 
