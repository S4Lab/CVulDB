samba-team__samba
commit c20ee1bdfea010dfdc2a0ca6d373368787afdd0f
Author:     Ralph Boehme <slow@samba.org>
AuthorDate: Fri Mar 18 09:37:06 2016 +0100
Commit:     Stefan Metzmacher <metze@samba.org>
CommitDate: Wed Mar 30 04:17:28 2016 +0200

    CVE-2016-2113(<=4.3): docs-xml: add "tls verify peer" option defaulting to "no_check"
    
    BUG: https://bugzilla.samba.org/show_bug.cgi?id=11752
    
    Pair-Programmed-With: Stefan Metzmacher <metze@samba.org>
    
    Signed-off-by: Ralph Boehme <slow@samba.org>
    Signed-off-by: Stefan Metzmacher <metze@samba.org>

diff --git a/lib/param/param_table.c b/lib/param/param_table.c
index db58733fb85..815482b8db2 100644
--- a/lib/param/param_table.c
+++ b/lib/param/param_table.c
@@ -4048,6 +4048,14 @@ struct parm_struct parm_table[] = {
 		.special	= NULL,
 		.enum_list	= NULL
 	},
+	{
+		.label		= "tls verify peer",
+		.type		= P_ENUM,
+		.p_class	= P_GLOBAL,
+		.offset		= GLOBAL_VAR(tls_verify_peer),
+		.special	= NULL,
+		.enum_list	= enum_tls_verify_peer_vals,
+	},
 
 	{NULL,  P_BOOL,  P_NONE,  0,  NULL,  NULL,  0}
 };
