samba-team__samba
commit b26668c606057fb30b20efd912284c3e79d547ff
Author:     Andrew Bartlett <abartlet@samba.org>
AuthorDate: Thu Jan 3 20:39:23 2013 +1100
Commit:     Stefan Metzmacher <metze@samba.org>
CommitDate: Tue Jan 15 12:14:25 2013 +0100

    libcli/security: Ensure to fill in remaining_access for the initial case (bug #9554 - CVE-2013-0172)
    
    It is critically important that we initialise this element as otherwise
    all access is permitted.
    
    Andrew Bartlett
    
    Reviewed-by: Stefan Metzmacher <metze@samba.org>
    (cherry picked from commit a75805490d96a85786287f5d0522dd7671d6816e)

diff --git a/libcli/security/object_tree.c b/libcli/security/object_tree.c
index 6809c8e3452..dcbd310baea 100644
--- a/libcli/security/object_tree.c
+++ b/libcli/security/object_tree.c
@@ -53,6 +53,7 @@ bool insert_in_object_tree(TALLOC_CTX *mem_ctx,
 			return false;
 		}
 		(*root)->guid = *guid;
+		(*root)->remaining_access = init_access;
 		*new_node = *root;
 		return true;
 	}
