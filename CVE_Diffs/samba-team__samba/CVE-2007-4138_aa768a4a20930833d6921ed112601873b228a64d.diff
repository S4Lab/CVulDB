samba-team__samba
commit aa768a4a20930833d6921ed112601873b228a64d
Author:     Gerald Carter <jerry@samba.org>
AuthorDate: Tue Sep 11 18:08:07 2007 +0000
Commit:     Gerald (Jerry) Carter <jerry@samba.org>
CommitDate: Wed Oct 10 12:30:39 2007 -0500

    r25099: Commit fix for CVE-2007-4138 from 3.0.26 release.

diff --git a/source/nsswitch/idmap_ad.c b/source/nsswitch/idmap_ad.c
index 6f8839e4ba3..41dbb471f9a 100644
--- a/source/nsswitch/idmap_ad.c
+++ b/source/nsswitch/idmap_ad.c
@@ -773,7 +773,7 @@ static NTSTATUS nss_ad_get_info( struct nss_domain_entry *e,
        
 	if ( gid ) {		
 		if ( !ads_pull_uint32(ads, msg, ad_schema->posix_gidnumber_attr, gid ) )
-			*gid = 0;		
+			*gid = (uint32)-1;		
 	}
 		
 	return NT_STATUS_OK;
