samba-team__samba
commit 6395b6c578c78813266c9aa4ae3c0db49bb830ec
Author:     Garming Sam <garming@catalyst.net.nz>
AuthorDate: Thu Jan 21 10:25:44 2016 +1300
Commit:     Karolin Seeger <kseeger@samba.org>
CommitDate: Wed Feb 24 11:43:58 2016 +0100

    CVE-2016-0771: tests/dns: Correct error code for formerly unrun test
    
    Both Samba and Windows returned NXRRSET
    
    BUG: https://bugzilla.samba.org/show_bug.cgi?id=11128
    BUG: https://bugzilla.samba.org/show_bug.cgi?id=11686
    
    Signed-off-by: Garming Sam <garming@catalyst.net.nz>
    Reviewed-by: Stefan Metzmacher <metze@samba.org>
    Reviewed-by: Andrew Bartlett <abartlet@samba.org>

diff --git a/python/samba/tests/dns.py b/python/samba/tests/dns.py
index e6f502913f4..0f716a3d8f0 100644
--- a/python/samba/tests/dns.py
+++ b/python/samba/tests/dns.py
@@ -387,7 +387,7 @@ class TestDNSUpdates(DNSTest):
         p.answers = prereqs
 
         response = self.dns_transaction_udp(p)
-        self.assert_dns_rcode_equals(response, dns.DNS_RCODE_FORMERR)
+        self.assert_dns_rcode_equals(response, dns.DNS_RCODE_NXRRSET)
 
     def test_update_prereq_nonexisting_name(self):
         "test update with a nonexisting name"
