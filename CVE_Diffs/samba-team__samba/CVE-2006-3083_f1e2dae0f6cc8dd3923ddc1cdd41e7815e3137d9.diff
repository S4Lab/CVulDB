samba-team__samba
commit f1e2dae0f6cc8dd3923ddc1cdd41e7815e3137d9
Author:     Love Hörnquist Åstrand <lha@kth.se>
AuthorDate: Tue Aug 8 21:08:46 2006 +0000
Commit:     Love Hörnquist Åstrand <lha@kth.se>
CommitDate: Tue Aug 8 21:08:46 2006 +0000

    Check return values from seteuid, prompted by MIT advisory.
    Thanks to Tom Yu at MIT, and Michael Calmer and Marcus Meissner at SUSE.
    Either of CVE-2006-3083 or CVE-2006-3084.
    
    
    git-svn-id: svn://svn.h5l.se/heimdal/trunk/heimdal@17874 ec53bebd-3082-4978-b11e-865c3cabbd6b

diff --git a/appl/rcp/rcp.c b/appl/rcp/rcp.c
index 9ce3c174e60..e61246ac3ae 100644
--- a/appl/rcp/rcp.c
+++ b/appl/rcp/rcp.c
@@ -272,7 +272,8 @@ tolocal(int argc, char **argv)
 		}
 		free(bp);
 		sink(1, argv + argc - 1);
-		seteuid(0);
+		if (seteuid(0) < 0)
+			exit(1);
 		close(remin);
 		remin = remout = -1;
 	}
