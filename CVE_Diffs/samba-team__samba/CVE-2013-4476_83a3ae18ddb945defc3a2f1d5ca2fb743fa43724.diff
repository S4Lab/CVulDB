samba-team__samba
commit 83a3ae18ddb945defc3a2f1d5ca2fb743fa43724
Author:     Björn Baumbach <bb@sernet.de>
AuthorDate: Tue Oct 29 17:49:55 2013 +0100
Commit:     Karolin Seeger <kseeger@samba.org>
CommitDate: Mon Nov 11 11:14:36 2013 +0100

    CVE-2013-4476: samba-tool provision: create ${private_dir}/tls with mode 0700
    
    Bug: https://bugzilla.samba.org/show_bug.cgi?id=10234
    
    Signed-off-by: Björn Baumbach <bb@sernet.de>
    Reviewed-by: Stefan Metzmacher <metze@samba.org>

diff --git a/python/samba/provision/__init__.py b/python/samba/provision/__init__.py
index d8f353f54ae..4920735b247 100644
--- a/python/samba/provision/__init__.py
+++ b/python/samba/provision/__init__.py
@@ -2025,7 +2025,7 @@ def provision(logger, session_info, smbconf=None,
     if not os.path.exists(paths.private_dir):
         os.mkdir(paths.private_dir)
     if not os.path.exists(os.path.join(paths.private_dir, "tls")):
-        os.mkdir(os.path.join(paths.private_dir, "tls"))
+        os.makedirs(os.path.join(paths.private_dir, "tls"), 0700)
     if not os.path.exists(paths.state_dir):
         os.mkdir(paths.state_dir)
 
