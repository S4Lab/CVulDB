samba-team__samba
commit 7c7f42fb382bdd3dda43ed3cda8f9e60b75ac510
Author:     Ralph Boehme <slow@samba.org>
AuthorDate: Fri Mar 18 08:58:32 2016 +0100
Commit:     Stefan Metzmacher <metze@samba.org>
CommitDate: Wed Mar 30 04:07:59 2016 +0200

    CVE-2016-2115(<=4.3): docs-xml: add "client ipc min protocol" and "client ipc max protocol" options
    
    BUG: https://bugzilla.samba.org/show_bug.cgi?id=11796
    
    Signed-off-by: Ralph Boehme <slow@samba.org>
    Reviewed-by: Stefan Metzmacher <metze@samba.org>

diff --git a/lib/param/param_table.c b/lib/param/param_table.c
index 09d0fe9181b..9d12b669021 100644
--- a/lib/param/param_table.c
+++ b/lib/param/param_table.c
@@ -4492,6 +4492,22 @@ struct parm_struct parm_table[] = {
 		.special	= NULL,
 		.enum_list	= enum_tls_verify_peer_vals,
 	},
+	{
+		.label		= "client ipc max protocol",
+		.type		= P_ENUM,
+		.p_class	= P_GLOBAL,
+		.offset		= GLOBAL_VAR(_client_ipc_max_protocol),
+		.special	= NULL,
+		.enum_list	= enum_protocol,
+	},
+	{
+		.label		= "client ipc min protocol",
+		.type		= P_ENUM,
+		.p_class	= P_GLOBAL,
+		.offset		= GLOBAL_VAR(_client_ipc_min_protocol),
+		.special	= NULL,
+		.enum_list	= enum_protocol,
+	},
 
 	{NULL,  P_BOOL,  P_NONE,  0,  NULL,  NULL,  0}
 };
