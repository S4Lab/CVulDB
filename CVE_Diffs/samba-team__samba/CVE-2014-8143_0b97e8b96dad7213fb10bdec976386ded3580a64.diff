samba-team__samba
commit 0b97e8b96dad7213fb10bdec976386ded3580a64
Author:     Andrew Bartlett <abartlet@samba.org>
AuthorDate: Mon Dec 8 12:19:19 2014 +1300
Commit:     Karolin Seeger <kseeger@samba.org>
CommitDate: Thu Jan 15 20:18:07 2015 +0100

    CVE-2014-8143:pydsdb: Pull in UF_USE_AES_KEYS flag
    
    Bug: https://bugzilla.samba.org/show_bug.cgi?id=10993
    
    Change-Id: I36ad5ebc5d8a4811c41b59af90a3add4ae5fd857
    Signed-off-by: Andrew Bartlett <abartlet@samba.org>
    Reviewed-by: Garming Sam <garming@catalyst.net.nz>
    Reviewed-by: Stefan Metzmacher <metze@samba.org>

diff --git a/source4/dsdb/pydsdb.c b/source4/dsdb/pydsdb.c
index ee02483acd4..0a2b86eed6c 100644
--- a/source4/dsdb/pydsdb.c
+++ b/source4/dsdb/pydsdb.c
@@ -1152,6 +1152,7 @@ void initdsdb(void)
 	ADD_DSDB_FLAG(UF_TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION);
 	ADD_DSDB_FLAG(UF_NO_AUTH_DATA_REQUIRED);
 	ADD_DSDB_FLAG(UF_PARTIAL_SECRETS_ACCOUNT);
+	ADD_DSDB_FLAG(UF_USE_AES_KEYS);
 
 	/* groupType flags */
 	ADD_DSDB_FLAG(GTYPE_SECURITY_BUILTIN_LOCAL_GROUP);
