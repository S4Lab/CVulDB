samba-team__samba
commit dee5f093570a6586f4cf6d9dec4b002c33160862
Author:     Karolin Seeger <kseeger@samba.org>
AuthorDate: Wed Aug 27 13:23:20 2008 +0200
Commit:     Karolin Seeger <kseeger@samba.org>
CommitDate: Wed Aug 27 13:32:09 2008 +0200

    ldb: Fix permissions of new ldg files.
    
    This one fixes together with 2eaf4ed62 bug #5715 and CVE-2008-3789.
    
    Thanks to Steve Langasek <vorlon@debian.org> for reporting!
    
    Karolin
    (cherry picked from commit b666d0a4b597218f5f5020bf36d80d84dcbf7259)
    (This used to be commit 73f54df7fedc8f0db022f902100fd5eb1b629fb2)

diff --git a/source3/lib/ldb/common/ldb.c b/source3/lib/ldb/common/ldb.c
index e469c49399a..743711b9672 100644
--- a/source3/lib/ldb/common/ldb.c
+++ b/source3/lib/ldb/common/ldb.c
@@ -51,7 +51,7 @@ struct ldb_context *ldb_init(void *mem_ctx)
 	}
 
 	ldb_set_utf8_default(ldb);
-	ldb_set_create_perms(ldb, 0666);
+	ldb_set_create_perms(ldb, 0600);
 
 	return ldb;
 }
