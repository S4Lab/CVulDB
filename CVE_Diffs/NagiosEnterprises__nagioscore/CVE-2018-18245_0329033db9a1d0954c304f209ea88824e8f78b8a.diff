NagiosEnterprises__nagioscore
commit 0329033db9a1d0954c304f209ea88824e8f78b8a
Author:     Jake Omann <jomann@nagios.com>
AuthorDate: Wed Dec 19 11:36:12 2018 -0600
Commit:     Jake Omann <jomann@nagios.com>
CommitDate: Wed Dec 19 11:36:12 2018 -0600

    Fixed XSS vulnerability in Alert Summary report (CVE-2018-18245)

diff --git a/Changelog b/Changelog
index 881c15d1..f20b56a8 100644
--- a/Changelog
+++ b/Changelog
@@ -7,6 +7,7 @@ Nagios Core 4 Change Log
 FIXES
 * Fixed services sending recovery emails when they recover if host in down state (#572) (Scott Wilkerson)
 * Fixed soft recovery states for services (#575) (Jacob Omann)
+* Fixed XSS vulnerability in Alert Summary report (CVE-2018-18245) (Jacob Omann)
 
 4.4.2 - 2018-08-16
 ------------------
diff --git a/cgi/summary.c b/cgi/summary.c
index b732b3bf..63846c66 100644
--- a/cgi/summary.c
+++ b/cgi/summary.c
@@ -1785,7 +1785,7 @@ void display_recent_alerts(void) {
 
 		printf("<td CLASS='data%s'>%s</td>", bgclass, (temp_event->state_type == AE_SOFT_STATE) ? "SOFT" : "HARD");
 
-		printf("<td CLASS='data%s'>%s</td>", bgclass, temp_event->event_info);
+		printf("<td CLASS='data%s'>%s</td>", bgclass, html_encode(temp_event->event_info, 1));
 
 		printf("</tr>\n");
 		}
