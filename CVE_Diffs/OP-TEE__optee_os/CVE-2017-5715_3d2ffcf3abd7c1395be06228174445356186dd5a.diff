OP-TEE__optee_os
commit 3d2ffcf3abd7c1395be06228174445356186dd5a
Author:     Jens Wiklander <jens.wiklander@linaro.org>
AuthorDate: Tue Apr 3 18:24:49 2018 +0200
Commit:     Jérôme Forissier <jerome.forissier@linaro.org>
CommitDate: Fri Apr 13 09:37:19 2018 +0200

    core: add smccc.h
    
    Adds <smccc.h> introducing new features in SMC calling convention v1.1
    
    See also
    Link: https://developer.arm.com/-/media/developer/pdf/ARM_DEN_0070A_Firmware_interfaces_for_mitigating_CVE-2017-5715.pdf
    
    Reviewed-by: Etienne Carriere <etienne.carriere@linaro.org>
    Reviewed-by: Jerome Forissier <jerome.forissier@linaro.org>
    Signed-off-by: Jens Wiklander <jens.wiklander@linaro.org>

diff --git a/core/arch/arm/include/smccc.h b/core/arch/arm/include/smccc.h
new file mode 100644
index 00000000..8146cbe9
--- /dev/null
+++ b/core/arch/arm/include/smccc.h
@@ -0,0 +1,36 @@
+/* SPDX-License-Identifier: BSD-2-Clause */
+/*
+ * Copyright (c) 2018, Linaro Limited
+ */
+
+#ifndef __SMCCC_H
+#define __SMCCC_H
+
+/*
+ * Describes features of SMC Calling Convention from v1.1
+ * See also https://developer.arm.com/-/media/developer/pdf/ARM_DEN_0070A_Firmware_interfaces_for_mitigating_CVE-2017-5715.pdf
+ */
+
+/*
+ * Retrieve the implemented version of the SMC Calling Convention
+ * Mandatory from SMCCC v1.1
+ * Optional in SMCCC v1.0
+ */
+#define SMCCC_VERSION		0x80000000
+
+/*
+ * Determine the availability and capability of Arm Architecture Service
+ * functions.
+ * Mandatory from SMCCC v1.1
+ * Optional for SMCCC v1.0
+ */
+#define SMCCC_ARCH_FEATURES	0x80000001
+
+/*
+ * Execute the mitigation for CVE-2017-5715 on the calling PE
+ * Optional from SMCCC v1.1
+ * Not supported in SMCCC v1.0
+ */
+#define SMCCC_ARCH_WORKAROUND_1	0x80008000
+
+#endif /*__SMCCC_H*/
