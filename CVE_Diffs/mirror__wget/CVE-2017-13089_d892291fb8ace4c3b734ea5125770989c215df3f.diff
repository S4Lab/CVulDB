mirror__wget
commit d892291fb8ace4c3b734ea5125770989c215df3f
Author:     Tim Rühsen <tim.ruehsen@gmx.de>
AuthorDate: Fri Oct 20 10:59:38 2017 +0200
Commit:     Tim Rühsen <tim.ruehsen@gmx.de>
CommitDate: Thu Oct 26 17:29:38 2017 +0200

    Fix stack overflow in HTTP protocol handling (CVE-2017-13089)
    
    * src/http.c (skip_short_body): Return error on negative chunk size
    
    Reported-by: Antti Levomäki, Christian Jalio, Joonas Pihlaja from Forcepoint
    Reported-by: Juhani Eronen from Finnish National Cyber Security Centre

diff --git a/src/http.c b/src/http.c
index 55367688b..dc3182311 100644
--- a/src/http.c
+++ b/src/http.c
@@ -973,6 +973,9 @@ skip_short_body (int fd, wgint contlen, bool chunked)
               remaining_chunk_size = strtol (line, &endl, 16);
               xfree (line);
 
+              if (remaining_chunk_size < 0)
+                return false;
+
               if (remaining_chunk_size == 0)
                 {
                   line = fd_read_line (fd);
