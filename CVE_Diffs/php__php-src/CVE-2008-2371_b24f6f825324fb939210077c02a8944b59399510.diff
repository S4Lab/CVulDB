php__php-src
commit b24f6f825324fb939210077c02a8944b59399510
Author:     Nuno Lopes <nlopess@php.net>
AuthorDate: Sun Jul 6 15:23:44 2008 +0000
Commit:     Nuno Lopes <nlopess@php.net>
CommitDate: Sun Jul 6 15:23:44 2008 +0000

    MFB: fix CVE-2008-2371

diff --git a/ext/pcre/pcrelib/pcre_compile.c b/ext/pcre/pcrelib/pcre_compile.c
index 51a51e1253..0f3ebf93fd 100644
--- a/ext/pcre/pcrelib/pcre_compile.c
+++ b/ext/pcre/pcrelib/pcre_compile.c
@@ -4929,7 +4929,7 @@ we set the flag only if there is a literal "\r" or "\n" in the class. */
                (lengthptr == NULL || *lengthptr == 2 + 2*LINK_SIZE))
             {
             cd->external_options = newoptions;
-            options = newoptions;
+            options = *optionsptr = newoptions;
             }
          else
             {
