php__php-src
commit 16fb63384c1da5a132468670f83fbcc8fc7aa99d
Author:     Felipe Pena <felipe@php.net>
AuthorDate: Mon Jul 21 19:34:45 2008 +0000
Commit:     Felipe Pena <felipe@php.net>
CommitDate: Mon Jul 21 19:34:45 2008 +0000

    - MFB: Fixed securities issue detailed in CVE-2008-2665 and CVE-2008-2666.
      (patch by Christian Hoffmann)

diff --git a/NEWS b/NEWS
index bd6b44deed..8071e64208 100644
--- a/NEWS
+++ b/NEWS
@@ -1,6 +1,9 @@
 PHP                                                                        NEWS
 |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
 ?? ??? 2008, PHP 5.2.7
+- Fixed securities issue detailed in CVE-2008-2665 and CVE-2008-2666.
+  (Christian Hoffmann)
+
 - Reverted fix for bug #44197 due to change in behaviour in minor version.
   (Felipe)
 
diff --git a/main/safe_mode.c b/main/safe_mode.c
index b791351c3b..d9d1a4f02b 100644
--- a/main/safe_mode.c
+++ b/main/safe_mode.c
@@ -73,14 +73,6 @@ PHPAPI int php_checkuid_ex(const char *filename, const char *fopen_mode, int mod
 			mode = CHECKUID_CHECK_FILE_AND_DIR;
 		}
 	}
-
-	/* 
-	 * If given filepath is a URL, allow - safe mode stuff
-	 * related to URL's is checked in individual functions
-	 */
-	wrapper = php_stream_locate_url_wrapper(filename, NULL, STREAM_LOCATE_WRAPPERS_ONLY TSRMLS_CC);
-	if (wrapper != NULL)
-		return 1;
 		
 	/* First we see if the file is owned by the same user...
 	 * If that fails, passthrough and check directory...
