XQuartz__xorg-server
commit 87e94198432603d1ede6d4dabb34f8617e84c18b
Author:     Matthieu Herrb <matthieu.herrb@laas.fr>
AuthorDate: Tue Jun 10 12:22:30 2008 -0600
Commit:     Jeremy Huddleston <jeremyhu@freedesktop.org>
CommitDate: Wed Jun 11 11:33:50 2008 -0700

    CVE-2008-2361 - RENDER Extension crash
    
    An integer overflow may occur in the computation of the size of the
    glyph to be allocated by the ProcRenderCreateCursor() function which
    will cause less memory to be allocated than expected, leading later to
    dereferencing un-mapped memory, causing a crash of the X server.
    (cherry picked from commit 5257a0f83d5f3d80d0cd44dd76d047bac3869592)

diff --git a/render/render.c b/render/render.c
index 55f360a44..d7dd80c13 100644
--- a/render/render.c
+++ b/render/render.c
@@ -1502,6 +1502,8 @@ ProcRenderCreateCursor (ClientPtr client)
     pScreen = pSrc->pDrawable->pScreen;
     width = pSrc->pDrawable->width;
     height = pSrc->pDrawable->height;
+    if (height && width > UINT32_MAX/(height*sizeof(CARD32)))
+	return BadAlloc;
     if ( stuff->x > width 
       || stuff->y > height )
 	return (BadMatch);
