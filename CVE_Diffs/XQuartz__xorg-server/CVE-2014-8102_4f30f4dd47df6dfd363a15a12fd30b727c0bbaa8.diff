XQuartz__xorg-server
commit 4f30f4dd47df6dfd363a15a12fd30b727c0bbaa8
Author:     Alan Coopersmith <alan.coopersmith@oracle.com>
AuthorDate: Sun Jan 26 20:02:20 2014 -0800
Commit:     Julien Cristau <jcristau@debian.org>
CommitDate: Tue Dec 9 17:50:13 2014 +0100

    xfixes: unvalidated length in SProcXFixesSelectSelectionInput [CVE-2014-8102]
    
    Signed-off-by: Alan Coopersmith <alan.coopersmith@oracle.com>
    Reviewed-by: Peter Hutterer <peter.hutterer@who-t.net>
    (cherry picked from commit a0ece23a8bd300c8be10812d368dc8058c97c63e)
    Signed-off-by: Julien Cristau <jcristau@debian.org>

diff --git a/xfixes/select.c b/xfixes/select.c
index c088ed3de..e964d588c 100644
--- a/xfixes/select.c
+++ b/xfixes/select.c
@@ -201,6 +201,7 @@ SProcXFixesSelectSelectionInput(ClientPtr client)
 {
     REQUEST(xXFixesSelectSelectionInputReq);
 
+    REQUEST_SIZE_MATCH(xXFixesSelectSelectionInputReq);
     swaps(&stuff->length);
     swapl(&stuff->window);
     swapl(&stuff->selection);
