XQuartz__xorg-server
commit 7553082b9b883b5f130044f3d53bce2f0b660e52
Author:     Alan Coopersmith <alan.coopersmith@oracle.com>
AuthorDate: Sun Jan 26 17:18:54 2014 -0800
Commit:     Alan Coopersmith <alan.coopersmith@oracle.com>
CommitDate: Mon Dec 8 18:09:48 2014 -0800

    xcmisc: unvalidated length in SProcXCMiscGetXIDList() [CVE-2014-8096]
    
    Signed-off-by: Alan Coopersmith <alan.coopersmith@oracle.com>
    Reviewed-by: Peter Hutterer <peter.hutterer@who-t.net>

diff --git a/Xext/xcmisc.c b/Xext/xcmisc.c
index 034bfb63b..1e9101059 100644
--- a/Xext/xcmisc.c
+++ b/Xext/xcmisc.c
@@ -167,6 +167,7 @@ static int
 SProcXCMiscGetXIDList(ClientPtr client)
 {
     REQUEST(xXCMiscGetXIDListReq);
+    REQUEST_SIZE_MATCH(xXCMiscGetXIDListReq);
 
     swaps(&stuff->length);
     swapl(&stuff->count);
