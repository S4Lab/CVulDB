XQuartz__xorg-server
commit c4937bbb697579ceff0e30b17aca409f56e78566
Author:     Matthieu Herrb <matthieu.herrb@laas.fr>
AuthorDate: Sun Jun 8 11:14:31 2008 -0600
Commit:     Matthieu Herrb <matthieu@bluenote.herrb.net>
CommitDate: Tue Jun 10 11:42:35 2008 -0600

    CVE-2008-2361 - RENDER Extension crash
    
    An integer overflow may occur in the computation of the
    size of the  glyph to be allocated by the ProcRenderCreateCursor()
    function  which will cause less memory to be allocated than expected,
    leading later to dereferencing  un-mapped memory, causing a crash of
    the X server.

diff --git a/render/render.c b/render/render.c
index caaa2781c..74c5f6387 100644
--- a/render/render.c
+++ b/render/render.c
@@ -1504,6 +1504,8 @@ ProcRenderCreateCursor (ClientPtr client)
     pScreen = pSrc->pDrawable->pScreen;
     width = pSrc->pDrawable->width;
     height = pSrc->pDrawable->height;
+    if (height && width > UINT32_MAX/(height*sizeof(CARD32)))
+	return BadAlloc;
     if ( stuff->x > width 
       || stuff->y > height )
 	return (BadMatch);
