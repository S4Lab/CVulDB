XQuartz__xorg-server
commit 19b95cdd1d14a1e7d1abba1880ab023c96f19bf5
Author:     Matthieu Herrb <matthieu@bluenote.herrb.com>
AuthorDate: Thu Jan 17 17:03:39 2008 +0100
Commit:     Matthieu Herrb <matthieu@bluenote.herrb.com>
CommitDate: Thu Jan 17 17:03:39 2008 +0100

    Fix for CVE-2007-5958 - File existence disclosure.

diff --git a/Xext/security.c b/Xext/security.c
index ba057defd..e9d48c94d 100644
--- a/Xext/security.c
+++ b/Xext/security.c
@@ -1563,7 +1563,7 @@ SecurityLoadPropertyAccessList(void)
     if (!SecurityPolicyFile)
 	return;
 
-    f = fopen(SecurityPolicyFile, "r");
+    f = Fopen(SecurityPolicyFile, "r");
     if (!f)
     {
 	ErrorF("error opening security policy file %s\n",
@@ -1646,7 +1646,7 @@ SecurityLoadPropertyAccessList(void)
     }
 #endif /* PROPDEBUG */
 
-    fclose(f);
+    Fclose(f);
 } /* SecurityLoadPropertyAccessList */
 
 
