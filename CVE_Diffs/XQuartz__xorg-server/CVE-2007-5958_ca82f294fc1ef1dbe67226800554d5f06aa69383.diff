XQuartz__xorg-server
commit ca82f294fc1ef1dbe67226800554d5f06aa69383
Author:     Matthieu Herrb <matthieu@bluenote.herrb.com>
AuthorDate: Thu Jan 17 17:03:39 2008 +0100
Commit:     Jeremy Huddleston <jeremy@yuffie.local>
CommitDate: Thu Jan 17 11:18:26 2008 -0800

    Fix for CVE-2007-5958 - File existence disclosure.
    (cherry picked from commit 19b95cdd1d14a1e7d1abba1880ab023c96f19bf5)

diff --git a/Xext/security.c b/Xext/security.c
index ac762794a..4ba4a2028 100644
--- a/Xext/security.c
+++ b/Xext/security.c
@@ -1567,9 +1567,9 @@ SecurityLoadPropertyAccessList(void)
 	return;
 
 #ifndef __UNIXOS2__
-    f = fopen(SecurityPolicyFile, "r");
+    f = Fopen(SecurityPolicyFile, "r");
 #else
-    f = fopen((char*)__XOS2RedirRoot(SecurityPolicyFile), "r");
+    f = Fopen((char*)__XOS2RedirRoot(SecurityPolicyFile), "r");
 #endif    
     if (!f)
     {
@@ -1653,7 +1653,7 @@ SecurityLoadPropertyAccessList(void)
     }
 #endif /* PROPDEBUG */
 
-    fclose(f);
+    Fclose(f);
 } /* SecurityLoadPropertyAccessList */
 
 
