iputils__iputils
commit b2dda4bbaa44ea296f1d75acc64cace221935d0d
Author:     YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org>
AuthorDate: Wed Oct 6 20:38:42 2010 +0900
Commit:     YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org>
CommitDate: Wed Oct 6 20:38:45 2010 +0900

    ping: Fix resource consumption triggered by specially crafted ICMP Echo Reply (CVE-2010-2529)
    
    Signed-off-by: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org>

diff --git a/ping.c b/ping.c
index 4472d77..eacb29d 100644
--- a/ping.c
+++ b/ping.c
@@ -1032,7 +1032,7 @@ void pr_options(unsigned char * cp, int hlen)
 				i = j;
 			i -= IPOPT_MINOFF;
 			if (i <= 0)
-				continue;
+				break;
 			if (i == old_rrlen
 			    && !strncmp((char *)cp, old_rr, i)
 			    && !(options & F_FLOOD)) {
@@ -1069,7 +1069,7 @@ void pr_options(unsigned char * cp, int hlen)
 				i = j;
 			i -= 5;
 			if (i <= 0)
-				continue;
+				break;
 			flags = *++cp;
 			printf("\nTS: ");
 			cp++;
