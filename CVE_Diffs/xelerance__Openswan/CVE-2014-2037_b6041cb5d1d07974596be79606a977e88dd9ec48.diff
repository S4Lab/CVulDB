xelerance__Openswan
commit b6041cb5d1d07974596be79606a977e88dd9ec48
Author:     Patrick Naubert <patrickn@xelerance.com>
AuthorDate: Fri Feb 28 19:59:54 2014 -0500
Commit:     Patrick Naubert <patrickn@xelerance.com>
CommitDate: Fri Feb 28 19:59:54 2014 -0500

    Bring back NAT traversal that got mistakenly pulled out by CVE-2014-2037 patch. Patch by Thomas Geulig

diff --git a/lib/libopenswan/constants.c b/lib/libopenswan/constants.c
index 932b20514..09f7e8044 100644
--- a/lib/libopenswan/constants.c
+++ b/lib/libopenswan/constants.c
@@ -167,9 +167,18 @@ const char *const payload_name_ikev2_main[] = {
     NULL    /* termination for bitnamesof() */
 };
 
+const char *const payload_name_nat_d[] = {
+    "ISAKMP_NEXT_NAT-D",
+    "ISAKMP_NEXT_NAT-OA",
+    NULL
+};
+
+static enum_names payload_names_nat_d =
+{ ISAKMP_NEXT_NATD_DRAFTS, ISAKMP_NEXT_NATOA_DRAFTS, payload_name_nat_d, NULL };
+
 static enum_names payload_names_ikev2_main =
 { ISAKMP_NEXT_v2SA, ISAKMP_NEXT_v2EAP, payload_name_ikev2_main,
-  NULL };
+  &payload_names_nat_d };
 
 const char *const payload_name_ikev2[] = {
     "ISAKMP_NEXT_v2NONE",            /* 33 */
