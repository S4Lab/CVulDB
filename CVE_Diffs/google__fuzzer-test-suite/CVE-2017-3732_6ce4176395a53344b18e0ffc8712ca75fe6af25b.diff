google__fuzzer-test-suite
commit 6ce4176395a53344b18e0ffc8712ca75fe6af25b
Author:     Kostya Serebryany <konstantin.s.serebryany@gmail.com>
AuthorDate: Thu Jan 26 13:39:40 2017 -0800
Commit:     Kostya Serebryany <konstantin.s.serebryany@gmail.com>
CommitDate: Thu Jan 26 13:39:40 2017 -0800

    Add a benchmark for CVE-2017-3732

diff --git a/openssl-1.1.0c/README.md b/openssl-1.1.0c/README.md
new file mode 100644
index 0000000..901fc48
--- /dev/null
+++ b/openssl-1.1.0c/README.md
@@ -0,0 +1,19 @@
+Finds
+[CVE-2017-3732](https://www.openssl.org/news/secadv/20170126.txt),
+a carry propagating bug in [OpenSSL](https://www.openssl.org/)'s `BN_mod_exp`.
+This was originally
+[discovered](https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=407)
+by [OSS-Fuzz](https://github.com/google/oss-fuzz)
+using the in-tree
+[bignum fuzz target](https://github.com/openssl/openssl/blob/OpenSSL_1_1_0-stable/fuzz/bignum.c).
+
+This is similar to
+[CVE-2015-3193](https://blog.fuzzing-project.org/31-Fuzzing-Math-miscalculations-in-OpenSSLs-BN_mod_exp-CVE-2015-3193.html)
+but is a different bug.
+
+It took thousands of CPU hours to find this bug for the first time.
+Reproducer provided in this directory.
+
+```
+bignum.c:91: OpenSSL internal error: assertion failed: success
+```
diff --git a/openssl-1.1.0c/build.sh b/openssl-1.1.0c/build.sh
new file mode 100755
index 0000000..9cd3f4c
--- /dev/null
+++ b/openssl-1.1.0c/build.sh
@@ -0,0 +1,17 @@
+#!/bin/bash
+# Copyright 2017 Google Inc. All Rights Reserved.
+# Licensed under the Apache License, Version 2.0 (the "License");
+. $(dirname $0)/../common.sh
+
+build_lib() {
+  rm -rf BUILD
+  cp -rf SRC BUILD
+  (cd BUILD && ./config && make clean && make CC="clang $FUZZ_CXXFLAGS"  -j $JOBS)
+}
+
+get_git_tag https://github.com/openssl/openssl.git OpenSSL_1_1_0c SRC
+build_lib
+build_libfuzzer
+set -x
+clang $FUZZ_CXXFLAGS -DFuzzerTestOneInput=LLVMFuzzerTestOneInput -c -g BUILD/fuzz/bignum.c -I BUILD/include
+clang++ bignum.o $FUZZ_CXXFLAGS BUILD/libssl.a BUILD/libcrypto.a libFuzzer.a -lgcrypt -o $EXECUTABLE_NAME_BASE
diff --git a/openssl-1.1.0c/crash-ab3eea077a07a1353f86eea4b6075df2e6319a75 b/openssl-1.1.0c/crash-ab3eea077a07a1353f86eea4b6075df2e6319a75
new file mode 100644
index 0000000..8f4bbbe
Binary files /dev/null and b/openssl-1.1.0c/crash-ab3eea077a07a1353f86eea4b6075df2e6319a75 differ
