netblue30__firejail
commit 46dc2b34f1fbbc4597b4ff9f6a3cb28b2d500d1b
Author:     netblue30 <netblue30@yahoo.com>
AuthorDate: Tue Sep 27 15:12:11 2016 -0400
Commit:     netblue30 <netblue30@yahoo.com>
CommitDate: Tue Sep 27 15:12:11 2016 -0400

    CVE-2016-7545

diff --git a/src/firejail/join.c b/src/firejail/join.c
index f11d85cf..ea44019c 100644
--- a/src/firejail/join.c
+++ b/src/firejail/join.c
@@ -30,6 +30,12 @@ static uint64_t caps = 0;
 static int apply_seccomp = 0;
 #define BUFLEN 4096
 
+static void signal_handler(int sig){
+	flush_stdin();
+
+	exit(sig);
+}
+
 static void extract_command(int argc, char **argv, int index) {
 	EUID_ASSERT();
 	if (index >= argc)
@@ -187,6 +193,7 @@ void join(pid_t pid, int argc, char **argv, int index) {
 	char *homedir = cfg.homedir;
 	
 	extract_command(argc, argv, index);
+	signal (SIGTERM, signal_handler);
 
 	// if the pid is that of a firejail  process, use the pid of the first child process
 	EUID_ROOT();
