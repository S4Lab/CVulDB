libming__libming
commit cff9a3bd2c428ad0cd8c8deb538031e11f29a0fe
Author:     Hugo Lefeuvre <hle@debian.org>
AuthorDate: Sun Mar 11 21:58:51 2018 +0100
Commit:     Hugo Lefeuvre <hle@debian.org>
CommitDate: Sun Mar 11 21:58:51 2018 +0100

    Fix heap buffer overflow in listfdb.c
    
    listfdb reads nGlyphs + 1 glyphs and stores them in an array of size
    nGlyphs*sizeof(int), resulting in a heap buffer overflow.
    
    In this commit we replace for(i=0; i<=nGlyphs; ++i)
    by for(i=0; i < nGlyphs; ++i) so that only nGlyphs glyphs are read.
    
    This patch addresses CVE-2018-6358 (fixes #104).

diff --git a/NEWS b/NEWS
index 5b1c4897..f80a99a5 100644
--- a/NEWS
+++ b/NEWS
@@ -33,6 +33,7 @@
   * Use OpCode function instead of directly accessing actions array without
     checks in util/decompile.c. This is potentially avoiding numerous
     issues similar to #105 or #83.
+  * Fix heap buffer overflow in listfdb.c (issue #104).
 
 0.4.8 - 2017-04-07
 
diff --git a/util/listfdb.c b/util/listfdb.c
index d1cdddec..b69aaed1 100644
--- a/util/listfdb.c
+++ b/util/listfdb.c
@@ -394,7 +394,7 @@ void printDefineFont2(FILE *f)
 
   here = fileOffset;
 
-  for(i=0; i<=nGlyphs; ++i)
+  for(i=0; i<nGlyphs; ++i)
   {
     if(flags & FONTINFO2_WIDEOFFSETS)
       off = readUInt32(f);
