libming__libming
commit 80ebea953f0da0a5206bfaf02d5396d292e91a3a
Author:     Balint Reczey <balint@balintreczey.hu>
AuthorDate: Thu Jan 5 16:50:25 2017 +0100
Commit:     Sandro Santilli <strk@kbt.io>
CommitDate: Mon Jan 30 09:54:52 2017 +0100

    Don't try printing unknown block.
    
    This fixes the crash also known as CVE-2016-9828.
    
    Fixes: #60

diff --git a/util/outputtxt.c b/util/outputtxt.c
index 7783dd52..eabee846 100644
--- a/util/outputtxt.c
+++ b/util/outputtxt.c
@@ -2934,6 +2934,6 @@ outputBlock (int type, SWF_Parserstruct * blockp, FILE* stream)
 	  return;
 	}
     }
-  outputSWF_UNKNOWNBLOCK(blockp);
+  SWF_error("printing type:  %d (%s) is not implemented", type, blockName(type));
   return;
 }
