libming__libming
commit 9141f1df0d6ecb84f298633ba03569bbf5c842d0
Author:     Hugo Lefeuvre <hle@debian.org>
AuthorDate: Wed Jan 17 10:52:47 2018 +0100
Commit:     Hugo Lefeuvre <hle@debian.org>
CommitDate: Wed Jan 17 10:52:47 2018 +0100

    Fix left shift of a negative value in readSBits.
    
    Check for !number before left-shifting by (number-1).
    
    This commit fixes CVE-2018-5294 (fixes #97).

diff --git a/NEWS b/NEWS
index 35c02852..b0256279 100644
--- a/NEWS
+++ b/NEWS
@@ -26,6 +26,8 @@
     detected) (CVE-2017-16898, issue #75).
   * Fix integer overflow vulnerability in util/read.c (out-of-range left
     shift in readUInt32) (CVE-2018-5251, issue #98)
+  * Fix left shift of a negative value in util/read.c (left shift of a
+    negative value in readSBits) (CVE-2018-5294, issue #97)
 
 0.4.8 - 2017-04-07
 
diff --git a/util/read.c b/util/read.c
index 32f4c673..bce95ef1 100644
--- a/util/read.c
+++ b/util/read.c
@@ -107,7 +107,7 @@ int readSBits(FILE *f, int number)
 {
   int num = readBits(f, number);
 
-  if(num & (1<<(number-1)))
+  if(number && num & (1<<(number-1)))
     return num - (1<<number);
   else
     return num;
