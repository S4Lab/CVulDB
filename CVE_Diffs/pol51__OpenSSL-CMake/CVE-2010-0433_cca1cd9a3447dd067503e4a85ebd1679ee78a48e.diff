pol51__OpenSSL-CMake
commit cca1cd9a3447dd067503e4a85ebd1679ee78a48e
Author:     Dr. Stephen Henson <steve@openssl.org>
AuthorDate: Wed Mar 3 15:41:18 2010 +0000
Commit:     Dr. Stephen Henson <steve@openssl.org>
CommitDate: Wed Mar 3 15:41:18 2010 +0000

    Submitted by: Tomas Hoger <thoger@redhat.com>
    
    Fix for CVE-2010-0433 where some kerberos enabled versions of OpenSSL
    could be crashed if the relevant tables were not present (e.g. chrooted).

diff --git a/CHANGES b/CHANGES
index b59daae5b..a51168ef9 100644
--- a/CHANGES
+++ b/CHANGES
@@ -909,6 +909,12 @@
 
   *) Change 'Configure' script to enable Camellia by default.
      [NTT]
+  
+   Changes between 0.9.8m and 0.9.8n [xx XXX xxxx]
+  
+  *) Fix for CVE-2010-0433 where some kerberos enabled versions of OpenSSL 
+     could be crashed if the relevant tables were not present (e.g. chrooted).
+     [Tomas Hoger <thoger@redhat.com>]
 
  Changes between 0.9.8l and 0.9.8m  [xx XXX xxxx]
 
diff --git a/ssl/kssl.c b/ssl/kssl.c
index b5fa1f147..0033e9bf6 100644
--- a/ssl/kssl.c
+++ b/ssl/kssl.c
@@ -1803,6 +1803,9 @@ kssl_ctx_show(KSSL_CTX *kssl_ctx)
                                      kssl_ctx->service_name ? kssl_ctx->service_name: KRB5SVC,
                                      KRB5_NT_SRV_HST, &princ);
 
+    if (krb5rc)
+	goto exit;
+
     krb5rc = krb5_kt_get_entry(krb5context, krb5keytab, 
                                 princ,
                                 0 /* IGNORE_VNO */,
