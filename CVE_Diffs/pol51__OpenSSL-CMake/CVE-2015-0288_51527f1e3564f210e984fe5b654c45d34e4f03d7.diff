pol51__OpenSSL-CMake
commit 51527f1e3564f210e984fe5b654c45d34e4f03d7
Author:     Dr. Stephen Henson <steve@openssl.org>
AuthorDate: Wed Feb 18 00:34:59 2015 +0000
Commit:     Dr. Stephen Henson <steve@openssl.org>
CommitDate: Mon Mar 2 15:26:47 2015 +0000

    Check public key is not NULL.
    
    CVE-2015-0288
    PR#3708
    
    Reviewed-by: Matt Caswell <matt@openssl.org>
    (cherry picked from commit 28a00bcd8e318da18031b2ac8778c64147cd54f9)

diff --git a/crypto/x509/x509_req.c b/crypto/x509/x509_req.c
index bc6e566c9..01795f4b3 100644
--- a/crypto/x509/x509_req.c
+++ b/crypto/x509/x509_req.c
@@ -92,6 +92,8 @@ X509_REQ *X509_to_X509_REQ(X509 *x, EVP_PKEY *pkey, const EVP_MD *md)
         goto err;
 
     pktmp = X509_get_pubkey(x);
+    if (pktmp == NULL)
+        goto err;
     i = X509_REQ_set_pubkey(ret, pktmp);
     EVP_PKEY_free(pktmp);
     if (!i)
