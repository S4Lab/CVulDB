franciscofranco__bacon
commit c42c97017f71562eb9b92641c259d2ff9effcbe9
Author:     Xiaojun Sang <xsang@codeaurora.org>
AuthorDate: Fri Dec 16 16:25:27 2016 +0800
Commit:     Joey Rizzoli <joey@lineageos.org>
CommitDate: Wed Jun 14 22:18:04 2017 +0200

    ASoC: soc: msm: initialize buffer to prevent kernel data leakage
    
    To prevent potential kernel stack data leakage, initialize
    channel_map[].
    
    CRs-Fixed: 1100878
    CAF-Change-Id: I7b81cea20485bc7514551672bb54c7fd455049e3
    Signed-off-by: Xiaojun Sang <xsang@codeaurora.org>
    CVE-2016-5347
    [haggertk]: Backport to 3.4/msm8974
     * Same logic in our msm-pcm-routing-v2.c as opposed to original
       msm-qti-pp-config.c
    
    Change-Id: Iea0b630d1785e03d16da2d4f651846ab06d73e23

diff --git a/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c b/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c
index 7b78214eda3..a2c978c9f14 100644
--- a/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c
+++ b/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c
@@ -1162,7 +1162,7 @@ static int msm_routing_set_multimedia2_vol_mixer(struct snd_kcontrol *kcontrol,
 static int msm_routing_get_channel_map_mixer(struct snd_kcontrol *kcontrol,
 					struct snd_ctl_elem_value *ucontrol)
 {
-	char channel_map[PCM_FORMAT_MAX_NUM_CHANNEL];
+	char channel_map[PCM_FORMAT_MAX_NUM_CHANNEL] = {0};
 	int i;
 
 	adm_get_multi_ch_map(channel_map);
