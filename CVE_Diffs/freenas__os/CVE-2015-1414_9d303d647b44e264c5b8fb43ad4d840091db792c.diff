freenas__os
commit 9d303d647b44e264c5b8fb43ad4d840091db792c
Author:     delphij <delphij@FreeBSD.org>
AuthorDate: Wed Feb 25 05:43:02 2015 +0000
Commit:     delphij <delphij@FreeBSD.org>
CommitDate: Wed Feb 25 05:43:02 2015 +0000

    Instant MFC:
    
    Fix integer overflow in IGMP protocol.
    
    Security:       FreeBSD-SA-15:04.igmp
    Security:       CVE-2015-1414
    Found by:       Mateusz Kocielski, Logicaltrust
    Analyzed by:    Marek Kroemeke, Mateusz Kocielski (shm@NetBSD.org) and
                    22733db72ab3ed94b5f8a1ffcde850251fe6f466
    Submited by:    Mariusz Zaborski <oshogbo@FreeBSD.org>
    Reviewed by:    bms
    Approved by:    so

diff --git a/sys/netinet/igmp.c b/sys/netinet/igmp.c
index 9f31a191c75..908f304aeac 100644
--- a/sys/netinet/igmp.c
+++ b/sys/netinet/igmp.c
@@ -1533,8 +1533,8 @@ igmp_input(struct mbuf *m, int off)
 		case IGMP_VERSION_3: {
 				struct igmpv3 *igmpv3;
 				uint16_t igmpv3len;
-				uint16_t srclen;
-				int nsrc;
+				uint16_t nsrc;
+				int srclen;
 
 				IGMPSTAT_INC(igps_rcv_v3_queries);
 				igmpv3 = (struct igmpv3 *)igmp;
