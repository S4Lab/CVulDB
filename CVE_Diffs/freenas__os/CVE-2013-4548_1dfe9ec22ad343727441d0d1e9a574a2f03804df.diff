freenas__os
commit 1dfe9ec22ad343727441d0d1e9a574a2f03804df
Author:     des <des@FreeBSD.org>
AuthorDate: Tue Nov 19 09:35:20 2013 +0000
Commit:     des <des@FreeBSD.org>
CommitDate: Tue Nov 19 09:35:20 2013 +0000

    Pre-zero the MAC context.
    
    Security:       CVE-2013-4548
    Security:       FreeBSD-SA-13:14.openssh
    Approved by:    re (implicit)

diff --git a/crypto/openssh/monitor_wrap.c b/crypto/openssh/monitor_wrap.c
index 88ff68330ae..c004d3731cb 100644
--- a/crypto/openssh/monitor_wrap.c
+++ b/crypto/openssh/monitor_wrap.c
@@ -482,7 +482,7 @@ mm_newkeys_from_blob(u_char *blob, int blen)
 	buffer_init(&b);
 	buffer_append(&b, blob, blen);
 
-	newkey = xmalloc(sizeof(*newkey));
+	newkey = xcalloc(1, sizeof(*newkey));
 	enc = &newkey->enc;
 	mac = &newkey->mac;
 	comp = &newkey->comp;
