freenas__os
commit 2e0f17c8dfb3f40056e9e2189257f541927d8c70
Author:     glebius <glebius@FreeBSD.org>
AuthorDate: Tue May 17 22:29:59 2016 +0000
Commit:     glebius <glebius@FreeBSD.org>
CommitDate: Tue May 17 22:29:59 2016 +0000

    Use unsigned version of min() when handling arguments of SETFKEY ioctl.
    
    Submitted by:   C Turt <cturt hardenedbsd.org>
    Security:       SA-16:18
    Security:       CVE-2016-1886

diff --git a/sys/dev/kbd/kbd.c b/sys/dev/kbd/kbd.c
index 80367628888..f1a1b29ab22 100644
--- a/sys/dev/kbd/kbd.c
+++ b/sys/dev/kbd/kbd.c
@@ -996,7 +996,7 @@ genkbd_commonioctl(keyboard_t *kbd, u_long cmd, caddr_t arg)
 			splx(s);
 			return (error);
 		}
-		kbd->kb_fkeytab[fkeyp->keynum].len = imin(fkeyp->flen, MAXFK);
+		kbd->kb_fkeytab[fkeyp->keynum].len = min(fkeyp->flen, MAXFK);
 		bcopy(fkeyp->keydef, kbd->kb_fkeytab[fkeyp->keynum].str,
 		    kbd->kb_fkeytab[fkeyp->keynum].len);
 		break;
