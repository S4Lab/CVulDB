freenas__os
commit 071cdaa1c206943d0162ff9d2c0d34ab7c6f1f6c
Author:     delphij <delphij@ccf9f872-aa2e-dd11-9fc8-001c23d0bc1f>
AuthorDate: Fri Jul 26 22:40:17 2013 +0000
Commit:     delphij <delphij@ccf9f872-aa2e-dd11-9fc8-001c23d0bc1f>
CommitDate: Fri Jul 26 22:40:17 2013 +0000

    Fix Denial of Service vulnerability in named(8). [13:07]
    
    Security:       CVE-2013-4854
    Security:       FreeBSD-SA-13:07.bind
    Approved by:    so
    
    
    git-svn-id: svn+ssh://svn.freebsd.org/base/head@253692 ccf9f872-aa2e-dd11-9fc8-001c23d0bc1f

diff --git a/contrib/bind9/lib/dns/rdata/generic/keydata_65533.c b/contrib/bind9/lib/dns/rdata/generic/keydata_65533.c
index 2592c30f6a0..317e1a87246 100644
--- a/contrib/bind9/lib/dns/rdata/generic/keydata_65533.c
+++ b/contrib/bind9/lib/dns/rdata/generic/keydata_65533.c
@@ -176,7 +176,7 @@ fromwire_keydata(ARGS_FROMWIRE) {
 	UNUSED(options);
 
 	isc_buffer_activeregion(source, &sr);
-	if (sr.length < 4)
+	if (sr.length < 16)
 		return (ISC_R_UNEXPECTEDEND);
 
 	isc_buffer_forward(source, sr.length);
