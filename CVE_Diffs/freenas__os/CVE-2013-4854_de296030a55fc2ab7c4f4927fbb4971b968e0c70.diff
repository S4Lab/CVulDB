freenas__os
commit de296030a55fc2ab7c4f4927fbb4971b968e0c70
Author:     delphij <delphij@FreeBSD.org>
AuthorDate: Fri Jul 26 22:43:09 2013 +0000
Commit:     delphij <delphij@FreeBSD.org>
CommitDate: Fri Jul 26 22:43:09 2013 +0000

    Fix Denial of Service vulnerability in named(8). [13:07]
    
    Security:       CVE-2013-4854
    Security:       FreeBSD-SA-13:07.bind
    Approved by:    re (rodrigc)

diff --git a/contrib/bind9/lib/dns/rdata/generic/keydata_65533.c b/contrib/bind9/lib/dns/rdata/generic/keydata_65533.c
index 2592c30f6a0..317e1a87246 100644
--- a/contrib/bind9/lib/dns/rdata/generic/keydata_65533.c
+++ b/contrib/bind9/lib/dns/rdata/generic/keydata_65533.c
@@ -176,7 +176,7 @@ fromwire_keydata(ARGS_FROMWIRE) {
 	UNUSED(options);
 
 	isc_buffer_activeregion(source, &sr);
-	if (sr.length < 4)
+	if (sr.length < 16)
 		return (ISC_R_UNEXPECTEDEND);
 
 	isc_buffer_forward(source, sr.length);
