freenas__os
commit 4211f6cab45563c934a7b19d99bd150efbd59543
Author:     emaste <emaste@FreeBSD.org>
AuthorDate: Thu Nov 23 14:30:41 2017 +0000
Commit:     emaste <emaste@FreeBSD.org>
CommitDate: Thu Nov 23 14:30:41 2017 +0000

    bfd: fix segfault in the ihex parser on malformed ihex file
    
    From binutils commit 0102ea8cec5fc509bba6c91df61b7ce23a799d32, made
    available under GPLv2 by Nick Clifton.
    
    PR:             198824
    MFC after:      1 week
    Security:       CVE-2014-8503

diff --git a/contrib/binutils/bfd/ihex.c b/contrib/binutils/bfd/ihex.c
index 9f765b33f77..67ac720a6eb 100644
--- a/contrib/binutils/bfd/ihex.c
+++ b/contrib/binutils/bfd/ihex.c
@@ -320,7 +320,7 @@ ihex_scan (bfd *abfd)
 	    {
 	      if (! ISHEX (buf[i]))
 		{
-		  ihex_bad_byte (abfd, lineno, hdr[i], error);
+		  ihex_bad_byte (abfd, lineno, buf[i], error);
 		  goto error_return;
 		}
 	    }
