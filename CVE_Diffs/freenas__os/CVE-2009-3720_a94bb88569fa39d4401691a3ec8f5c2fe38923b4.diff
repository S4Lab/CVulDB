freenas__os
commit a94bb88569fa39d4401691a3ec8f5c2fe38923b4
Author:     delphij <delphij@FreeBSD.org>
AuthorDate: Fri Dec 11 02:06:06 2009 +0000
Commit:     delphij <delphij@FreeBSD.org>
CommitDate: Fri Dec 11 02:06:06 2009 +0000

    Apply a vendor fix (rev 1.165): Don't update next pointer since it could
    confuse tokenizer.
    
    Obtained from:  expat CVS
    Security:       CVE-2009-3720

diff --git a/lib/xmlparse.c b/lib/xmlparse.c
index 94e31de9da3..e111460d0a3 100644
--- a/lib/xmlparse.c
+++ b/lib/xmlparse.c
@@ -3725,7 +3725,6 @@ doProlog(XML_Parser parser,
         return XML_ERROR_NO_ELEMENTS;
       default:
         tok = -tok;
-        next = end;
         break;
       }
     }
