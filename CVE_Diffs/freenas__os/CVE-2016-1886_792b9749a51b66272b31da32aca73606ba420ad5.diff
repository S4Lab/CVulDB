freenas__os
commit 792b9749a51b66272b31da32aca73606ba420ad5
Author:     glebius <glebius@ccf9f872-aa2e-dd11-9fc8-001c23d0bc1f>
AuthorDate: Tue May 17 22:28:42 2016 +0000
Commit:     glebius <glebius@ccf9f872-aa2e-dd11-9fc8-001c23d0bc1f>
CommitDate: Tue May 17 22:28:42 2016 +0000

    Use unsigned version of min() when handling arguments of SETFKEY ioctl.
    
    Submitted by:   C Turt <cturt hardenedbsd.org>
    Security:       SA-16:18
    Security:       CVE-2016-1886
    
    
    git-svn-id: svn+ssh://svn.freebsd.org/base/head@300089 ccf9f872-aa2e-dd11-9fc8-001c23d0bc1f

diff --git a/sys/dev/kbd/kbd.c b/sys/dev/kbd/kbd.c
index 389ef7575bb..6a386088ff1 100644
--- a/sys/dev/kbd/kbd.c
+++ b/sys/dev/kbd/kbd.c
@@ -996,7 +996,7 @@ genkbd_commonioctl(keyboard_t *kbd, u_long cmd, caddr_t arg)
 			splx(s);
 			return (error);
 		}
-		kbd->kb_fkeytab[fkeyp->keynum].len = imin(fkeyp->flen, MAXFK);
+		kbd->kb_fkeytab[fkeyp->keynum].len = min(fkeyp->flen, MAXFK);
 		bcopy(fkeyp->keydef, kbd->kb_fkeytab[fkeyp->keynum].str,
 		    kbd->kb_fkeytab[fkeyp->keynum].len);
 		break;
