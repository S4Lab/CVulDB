beagleboard__buildroot
commit 86eb94636e0dcfaf332ba808eeee04a61b13af60
Author:     Peter Korsgaard <peter@korsgaard.com>
AuthorDate: Fri Oct 27 14:02:08 2017 +0200
Commit:     Peter Korsgaard <peter@korsgaard.com>
CommitDate: Sat Oct 28 09:10:05 2017 +0200

    wget: security bump to version 1.19.2
    
    Fixes the following security issues:
    
    CVE-2017-13089: The http.c:skip_short_body() function is called in some
    circumstances, such as when processing redirects.  When the response is sent
    chunked, the chunk parser uses strtol() to read each chunk's length, but
    doesn't check that the chunk length is a non-negative number.  The code then
    tries to skip the chunk in pieces of 512 bytes by using the MIN() macro, but
    ends up passing the negative chunk length to connect.c:fd_read().  As
    fd_read() takes an int argument, the high 32 bits of the chunk length are
    discarded, leaving fd_read() with a completely attacker controlled length
    argument.
    
    CVE-2017-13090: The retr.c:fd_read_body() function is called when processing
    OK responses.  When the response is sent chunked, the chunk parser uses
    strtol() to read each chunk's length, but doesn't check that the chunk
    length is a non-negative number.  The code then tries to read the chunk in
    pieces of 8192 bytes by using the MIN() macro, but ends up passing the
    negative chunk length to retr.c:fd_read().  As fd_read() takes an int
    argument, the high 32 bits of the chunk length are discarded, leaving
    fd_read() with a completely attacker controlled length argument.  The
    attacker can corrupt malloc metadata after the allocated buffer.
    
    Drop now upstreamed patch and change to .tar.lz as .tar.xz is no longer
    available.
    
    Also add a hash for the license file while we're at it.
    
    Signed-off-by: Peter Korsgaard <peter@korsgaard.com>

diff --git a/package/wget/0001-Fix-CRLF-injection-in-Wget-host-part.patch b/package/wget/0001-Fix-CRLF-injection-in-Wget-host-part.patch
deleted file mode 100644
index 380b075244..0000000000
--- a/package/wget/0001-Fix-CRLF-injection-in-Wget-host-part.patch
+++ /dev/null
@@ -1,40 +0,0 @@
-From 4d729e322fae359a1aefaafec1144764a54e8ad4 Mon Sep 17 00:00:00 2001
-From: =?UTF-8?q?Tim=20R=C3=BChsen?= <tim.ruehsen@gmx.de>
-Date: Mon, 6 Mar 2017 10:04:22 +0100
-Subject: [PATCH] Fix CRLF injection in Wget host part
-
-* src/url.c (url_parse): Reject control characters in host part of URL
-
-Reported-by: Orange Tsai
-Signed-off-by: Baruch Siach <baruch@tkos.co.il>
----
-Patch status: upstream commit 4d729e322fae35
-
- src/url.c | 11 +++++++++++
- 1 file changed, 11 insertions(+)
-
-diff --git a/src/url.c b/src/url.c
-index 8f8ff0b881af..7d36b27d7b92 100644
---- a/src/url.c
-+++ b/src/url.c
-@@ -925,6 +925,17 @@ url_parse (const char *url, int *error, struct iri *iri, bool percent_encode)
-       url_unescape (u->host);
-       host_modified = true;
- 
-+      /* check for invalid control characters in host name */
-+      for (p = u->host; *p; p++)
-+        {
-+          if (c_iscntrl(*p))
-+            {
-+              url_free(u);
-+              error_code = PE_INVALID_HOST_NAME;
-+              goto error;
-+            }
-+        }
-+
-       /* Apply IDNA regardless of iri->utf8_encode status */
-       if (opt.enable_iri && iri)
-         {
--- 
-2.11.0
-
diff --git a/package/wget/wget.hash b/package/wget/wget.hash
index 5f22396b05..0048557946 100644
--- a/package/wget/wget.hash
+++ b/package/wget/wget.hash
@@ -1,2 +1,4 @@
 # Locally calculated after checking pgp signature
-sha256 0c950b9671881222a4d385b013c9604e98a8025d1988529dfca0e93617744cd2  wget-1.19.1.tar.xz
+sha256 d59a745ad2c522970660bb30d38601f9457b151b322e01fa20a5a0da0f55df07  wget-1.19.2.tar.lz
+# Locally calculated
+sha256 8ceb4b9ee5adedde47b31e975c1d90c73ad27b6b165a1dcd80c7c545eb65b903  COPYING
diff --git a/package/wget/wget.mk b/package/wget/wget.mk
index 4cb48dce67..a7d904405b 100644
--- a/package/wget/wget.mk
+++ b/package/wget/wget.mk
@@ -4,8 +4,8 @@
 #
 ################################################################################
 
-WGET_VERSION = 1.19.1
-WGET_SOURCE = wget-$(WGET_VERSION).tar.xz
+WGET_VERSION = 1.19.2
+WGET_SOURCE = wget-$(WGET_VERSION).tar.lz
 WGET_SITE = $(BR2_GNU_MIRROR)/wget
 WGET_DEPENDENCIES = host-pkgconf
 WGET_LICENSE = GPL-3.0+
