beagleboard__buildroot
commit 69636df180e4a723b6160685b605dfbe326a0d26
Author:     Gustavo Zacarias <gustavo@zacarias.com.ar>
AuthorDate: Tue Jun 17 16:05:49 2014 -0300
Commit:     Peter Korsgaard <peter@korsgaard.com>
CommitDate: Wed Jun 18 13:53:43 2014 +0200

    links: add security fix for CVE-2013-6050
    
    Also fix LICENSE typo.
    
    Signed-off-by: Gustavo Zacarias <gustavo@zacarias.com.ar>
    Signed-off-by: Peter Korsgaard <peter@korsgaard.com>

diff --git a/package/links/links-no-largefile.patch b/package/links/links-0001-no-largefile.patch
similarity index 100%
rename from package/links/links-no-largefile.patch
rename to package/links/links-0001-no-largefile.patch
diff --git a/package/links/links-0002-CVE-2013-6050.patch b/package/links/links-0002-CVE-2013-6050.patch
new file mode 100644
index 0000000000..d85c2503c0
--- /dev/null
+++ b/package/links/links-0002-CVE-2013-6050.patch
@@ -0,0 +1,17 @@
+Description: Fix integer overflow in graphics mode (CVE-2013-6050)
+Author: Mikulas Patocka <mikulas@artax.karlin.mff.cuni.cz>
+Bug-CVE: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6050
+
+Index: links-2.7/html_tbl.c
+===================================================================
+--- links-2.7.orig/html_tbl.c   2013-11-22 01:57:29.000000000 +0100
++++ links-2.7/html_tbl.c        2013-11-22 01:58:30.000000000 +0100
+@@ -1550,6 +1550,8 @@ static void add_to_rect_sets(struct rect
+ static void add_to_cell_sets(struct table_cell ****s, int **nn, int *n, struct rect *r, struct table_cell *c)
+ {
+ 	int i, j;
++	if (r->y1 < 0 || r->y2 < 0)
++		fatal_exit("add_to_cell_sets: integer overflow: %d, %d", r->y1, r->y2);
+ 	for (i = r->y1 >> RECT_BOUND_BITS; i <= (r->y2 - 1) >> RECT_BOUND_BITS; i++) {
+ 		if (i >= *n) {
+ 			struct table_cell ***ns;
diff --git a/package/links/links.mk b/package/links/links.mk
index 6e683dd094..a7baa4c756 100644
--- a/package/links/links.mk
+++ b/package/links/links.mk
@@ -7,7 +7,7 @@
 LINKS_VERSION = 2.7
 LINKS_SITE = http://links.twibright.com/download
 LINKS_DEPENDENCIES = host-pkgconf
-LINKS_LICNSE = GPLv2+
+LINKS_LICENSE = GPLv2+
 LINKS_LICENSE_FILES = COPYING
 
 ifeq ($(BR2_PACKAGE_LINKS_GRAPHICS),y)
