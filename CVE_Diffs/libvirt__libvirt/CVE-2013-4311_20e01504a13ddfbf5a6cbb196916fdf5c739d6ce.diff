libvirt__libvirt
commit 20e01504a13ddfbf5a6cbb196916fdf5c739d6ce
Author:     Jiri Denemark <jdenemar@redhat.com>
AuthorDate: Tue Jul 15 15:18:33 2014 +0200
Commit:     Jiri Denemark <jdenemar@redhat.com>
CommitDate: Tue Jul 15 16:34:53 2014 +0200

    spec: Update polkit dependencies for CVE-2013-4311
    
    Use secured polkit on distros which provide it. However, RHEL-6 will
    still allow for older polkit-0.93 rather than forcing polkit-0.96-5
    which is not available in all RHEL-6 releases.

diff --git a/libvirt.spec.in b/libvirt.spec.in
index 8d1acfa09d..47bfec54e0 100644
--- a/libvirt.spec.in
+++ b/libvirt.spec.in
@@ -535,7 +535,9 @@ BuildRequires: module-init-tools
 BuildRequires: cyrus-sasl-devel
 %endif
 %if %{with_polkit}
-    %if 0%{?fedora} >= 12 || 0%{?rhel} >= 6
+    %if 0%{?fedora} >= 20 || 0%{?rhel} >= 7
+BuildRequires: polkit-devel >= 0.112
+    %elif 0%{?fedora} >= 12 || 0%{?rhel} >= 6
 BuildRequires: polkit-devel >= 0.93
     %else
 BuildRequires: PolicyKit-devel >= 0.6
@@ -698,7 +700,9 @@ Requires: avahi-libs
         %endif
     %endif
     %if %{with_polkit}
-        %if 0%{?fedora} >= 12 || 0%{?rhel} >=6
+        %if 0%{?fedora} >= 20 || 0%{?rhel} >= 7
+Requires: polkit >= 0.112
+        %elif 0%{?fedora} >= 12 || 0%{?rhel} >=6
 Requires: polkit >= 0.93
         %else
 Requires: PolicyKit >= 0.6
