libvirt__libvirt
commit ae076bb40e0e150aef41361b64001138d04d6c60
Author:     Daniel P. Berrangé <berrange@redhat.com>
AuthorDate: Wed Mar 27 11:22:49 2019 +0000
Commit:     Daniel P. Berrangé <berrange@redhat.com>
CommitDate: Thu Apr 11 15:21:53 2019 +0100

    remote: enforce ACL write permission for getting guest time & hostname
    
    Getting the guest time and hostname both require use of guest agent
    commands. These must not be allowed for read-only users, so the
    permissions check must validate "write" permission not "read".
    
    Fixes CVE-2019-3886
    Reviewed-by: Jim Fehlig <jfehlig@suse.com>
    Signed-off-by: Daniel P. Berrangé <berrange@redhat.com>

diff --git a/src/remote/remote_protocol.x b/src/remote/remote_protocol.x
index 74be4b37d0..11f44ee267 100644
--- a/src/remote/remote_protocol.x
+++ b/src/remote/remote_protocol.x
@@ -5513,7 +5513,7 @@ enum remote_procedure {
 
     /**
      * @generate: both
-     * @acl: domain:read
+     * @acl: domain:write
      */
     REMOTE_PROC_DOMAIN_GET_HOSTNAME = 277,
 
@@ -5908,7 +5908,7 @@ enum remote_procedure {
 
     /**
      * @generate: none
-     * @acl: domain:read
+     * @acl: domain:write
      */
     REMOTE_PROC_DOMAIN_GET_TIME = 337,
 
