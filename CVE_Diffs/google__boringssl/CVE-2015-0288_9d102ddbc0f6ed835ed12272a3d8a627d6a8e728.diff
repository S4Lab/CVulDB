google__boringssl
commit 9d102ddbc0f6ed835ed12272a3d8a627d6a8e728
Author:     David Benjamin <davidben@chromium.org>
AuthorDate: Tue Mar 3 10:31:43 2015 -0800
Commit:     Adam Langley <agl@google.com>
CommitDate: Fri Mar 6 18:55:32 2015 +0000

    Check public key is not NULL.
    
    CVE-2015-0288
    PR#3708
    
    (Imported from upstream's 28a00bcd8e318da18031b2ac8778c64147cd54f9.)
    
    Change-Id: I6d60691da4c6860f87c753c065e93e9d0704aba9
    Reviewed-on: https://boringssl-review.googlesource.com/3750
    Reviewed-by: Adam Langley <agl@google.com>

diff --git a/crypto/x509/x509_req.c b/crypto/x509/x509_req.c
index daaedb692..2732d6e76 100644
--- a/crypto/x509/x509_req.c
+++ b/crypto/x509/x509_req.c
@@ -92,6 +92,8 @@ X509_REQ *X509_to_X509_REQ(X509 *x, EVP_PKEY *pkey, const EVP_MD *md)
 		goto err;
 
 	pktmp = X509_get_pubkey(x);
+	if (pktmp == NULL)
+		goto err;
 	i=X509_REQ_set_pubkey(ret,pktmp);
 	EVP_PKEY_free(pktmp);
 	if (!i) goto err;
