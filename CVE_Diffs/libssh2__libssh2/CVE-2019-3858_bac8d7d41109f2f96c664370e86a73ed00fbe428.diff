libssh2__libssh2
commit bac8d7d41109f2f96c664370e86a73ed00fbe428
Author:     Michael Buckley <michael@buckleyisms.com>
AuthorDate: Tue Dec 4 13:10:41 2018 -0800
Commit:     Michael Buckley <michael@buckleyisms.com>
CommitDate: Thu Mar 14 15:24:52 2019 -0700

    Prevent zero-byte allocation in sftp_packet_read() which could lead to an out-of-bounds read. https://libssh2.org/CVE-2019-3858.html

diff --git a/src/sftp.c b/src/sftp.c
index 21bd8bff..41b5696e 100644
--- a/src/sftp.c
+++ b/src/sftp.c
@@ -345,6 +345,10 @@ sftp_packet_read(LIBSSH2_SFTP *sftp)
                 return _libssh2_error(session,
                                       LIBSSH2_ERROR_CHANNEL_PACKET_EXCEEDED,
                                       "SFTP packet too large");
+            if (sftp->partial_len == 0)
+                return _libssh2_error(session,
+                                      LIBSSH2_ERROR_ALLOC,
+                                      "Unable to allocate empty SFTP packet");
 
             _libssh2_debug(session, LIBSSH2_TRACE_SFTP,
                            "Data begin - Packet Length: %lu",
