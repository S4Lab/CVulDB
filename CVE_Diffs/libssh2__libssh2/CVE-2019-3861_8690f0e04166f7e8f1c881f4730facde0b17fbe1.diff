libssh2__libssh2
commit 8690f0e04166f7e8f1c881f4730facde0b17fbe1
Author:     Michael Buckley <michael@buckleyisms.com>
AuthorDate: Tue Dec 4 12:44:26 2018 -0800
Commit:     Michael Buckley <michael@buckleyisms.com>
CommitDate: Thu Mar 14 15:24:52 2019 -0700

    Sanitize padding_length - _libssh2_transport_read(). https://libssh2.org/CVE-2019-3861.html
    
    This prevents an underflow resulting in a potential out-of-bounds read if a server sends a too-large padding_length, possibly with malicious intent.

diff --git a/src/transport.c b/src/transport.c
index f1b7bcf0..071c50e0 100644
--- a/src/transport.c
+++ b/src/transport.c
@@ -445,6 +445,10 @@ int _libssh2_transport_read(LIBSSH2_SESSION * session)
             }
 
             p->padding_length = block[4];
+            if ( p->padding_length > p->packet_length - 1 ) {
+                return LIBSSH2_ERROR_DECRYPT;
+            }
+
 
             /* total_num is the number of bytes following the initial
                (5 bytes) packet length and padding length fields */
