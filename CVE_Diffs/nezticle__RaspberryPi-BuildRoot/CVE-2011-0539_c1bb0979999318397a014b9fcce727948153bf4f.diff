nezticle__RaspberryPi-BuildRoot
commit c1bb0979999318397a014b9fcce727948153bf4f
Author:     Gustavo Zacarias <gustavo@zacarias.com.ar>
AuthorDate: Fri Feb 11 10:27:18 2011 -0300
Commit:     Peter Korsgaard <jacmet@sunsite.dk>
CommitDate: Mon Feb 14 22:22:05 2011 +0100

    openssh: security bump to version 5.8p1
    
    http://www.openssh.com/txt/legacy-cert.adv
    CVE-2011-0539
    
    Signed-off-by: Gustavo Zacarias <gustavo@zacarias.com.ar>
    Signed-off-by: Peter Korsgaard <jacmet@sunsite.dk>

diff --git a/package/openssh/S50sshd b/package/openssh/S50sshd
index 3821449fb..f0d2aef5a 100644
--- a/package/openssh/S50sshd
+++ b/package/openssh/S50sshd
@@ -25,6 +25,14 @@ if [ ! -f /etc/ssh_host_dsa_key ] ; then
 	echo
         /usr/bin/ssh-keygen -t dsa -f /etc/ssh_host_dsa_key -C '' -N ''
 fi
+
+# Check for the SSH2 ECDSA key
+if [ ! -f /etc/ssh_host_ecdsa_key ]; then
+	echo Generating ECDSA Key...
+	echo THIS CAN TAKE A MINUTE OR TWO DEPENDING ON YOUR PROCESSOR!
+	echo
+	/usr/bin/ssh-keygen -t ecdsa -f /etc/ssh_host_ecdsa_key -C '' -N ''
+fi
                 
 umask 077
 
diff --git a/package/openssh/openssh.mk b/package/openssh/openssh.mk
index 3db7156cb..104977e48 100644
--- a/package/openssh/openssh.mk
+++ b/package/openssh/openssh.mk
@@ -4,7 +4,7 @@
 #
 #############################################################
 
-OPENSSH_VERSION = 5.6p1
+OPENSSH_VERSION = 5.8p1
 OPENSSH_SITE = http://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable
 OPENSSH_CONF_ENV = LD="$(TARGET_CC)" LDFLAGS="$(TARGET_CFLAGS)"
 OPENSSH_CONF_OPT = --libexecdir=/usr/lib --disable-lastlog --disable-utmp \
