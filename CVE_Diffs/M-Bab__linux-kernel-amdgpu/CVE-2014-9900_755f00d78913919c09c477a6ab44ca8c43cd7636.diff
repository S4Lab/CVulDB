M-Bab__linux-kernel-amdgpu
commit 755f00d78913919c09c477a6ab44ca8c43cd7636
Author:     Avijit Kanti Das <avijitnsec@codeaurora.org>
AuthorDate: Thu Jun 8 06:41:15 2017 -0700
Commit:     Seth Forshee <seth.forshee@canonical.com>
CommitDate: Mon Jul 3 07:37:30 2017 -0500

    UBUNTU: SAUCE: (no-up) net: Zeroing the structure ethtool_wolinfo in ethtool_get_wol()
    
    CVE-2014-9900
    
    memset() the structure ethtool_wolinfo that has padded bytes
    but the padded bytes have not been zeroed out.
    
    Change-Id: If3fd2d872a1b1ab9521d937b86a29fc468a8bbfe
    Signed-off-by: Avijit Kanti Das <avijitnsec@codeaurora.org>
    Signed-off-by: Brad Figg <brad.figg@canonical.com>
    Acked-by: Seth Forshee <seth.forshee@canonical.com>
    Acked-by: Colin Ian King <colin.king@canonical.com>
    Signed-off-by: Seth Forshee <seth.forshee@canonical.com>

diff --git a/net/core/ethtool.c b/net/core/ethtool.c
index 03111a2d6653..d1b7b5bc5ea4 100644
--- a/net/core/ethtool.c
+++ b/net/core/ethtool.c
@@ -1452,11 +1452,13 @@ static int ethtool_reset(struct net_device *dev, char __user *useraddr)
 
 static int ethtool_get_wol(struct net_device *dev, char __user *useraddr)
 {
-	struct ethtool_wolinfo wol = { .cmd = ETHTOOL_GWOL };
+	struct ethtool_wolinfo wol;
 
 	if (!dev->ethtool_ops->get_wol)
 		return -EOPNOTSUPP;
 
+	memset(&wol, 0, sizeof(struct ethtool_wolinfo));
+	wol.cmd = ETHTOOL_GWOL;
 	dev->ethtool_ops->get_wol(dev, &wol);
 
 	if (copy_to_user(useraddr, &wol, sizeof(wol)))
