openwrt__openwrt
commit aeec1dd7bab6da7e231f43d0206c8a7bc1614919
Author:     Zoltan HERPAI <wigyori@uid0.hu>
AuthorDate: Mon Jul 30 15:16:59 2018 +0200
Commit:     Zoltan HERPAI <wigyori@uid0.hu>
CommitDate: Thu Aug 9 00:45:39 2018 +0200

    firmware: intel-microcode: bump to 20180703
    
      * New upstream microcode data file 20180703
        + Updated Microcodes:
          sig 0x000206d6, pf_mask 0x6d, 2018-05-08, rev 0x061d, size 18432
          sig 0x000206d7, pf_mask 0x6d, 2018-05-08, rev 0x0714, size 19456
          sig 0x000306e4, pf_mask 0xed, 2018-04-25, rev 0x042d, size 15360
          sig 0x000306e7, pf_mask 0xed, 2018-04-25, rev 0x0714, size 17408
          sig 0x000306f2, pf_mask 0x6f, 2018-04-20, rev 0x003d, size 33792
          sig 0x000306f4, pf_mask 0x80, 2018-04-20, rev 0x0012, size 17408
          sig 0x000406f1, pf_mask 0xef, 2018-04-19, rev 0xb00002e, size 28672
          sig 0x00050654, pf_mask 0xb7, 2018-05-15, rev 0x200004d, size 31744
          sig 0x00050665, pf_mask 0x10, 2018-04-20, rev 0xe00000a, size 18432
          sig 0x000706a1, pf_mask 0x01, 2017-12-26, rev 0x0022, size 73728
        + First batch of fixes for: Intel SA-00115, CVE-2018-3639, CVE-2018-3640
        + Implements IBRS/IBPB/STIPB support, Spectre-v2 mitigation
        + SSBD support (Spectre-v4 mitigation) and fix Spectre-v3a for:
          Sandybridge server, Ivy Bridge server, Haswell server, Skylake server,
          Broadwell server, a few HEDT Core i7/i9 models that are actually gimped
          server dies.
    
    Signed-off-by: Zoltan HERPAI <wigyori@uid0.hu>

diff --git a/package/firmware/intel-microcode/Makefile b/package/firmware/intel-microcode/Makefile
index 1b7288fc14..9571feed93 100644
--- a/package/firmware/intel-microcode/Makefile
+++ b/package/firmware/intel-microcode/Makefile
@@ -8,12 +8,12 @@
 include $(TOPDIR)/rules.mk
 
 PKG_NAME:=intel-microcode
-PKG_VERSION:=20180312
-PKG_RELEASE:=1
+PKG_VERSION:=20180703
+PKG_RELEASE:=2
 
 PKG_SOURCE:=intel-microcode_3.$(PKG_VERSION).$(PKG_RELEASE).tar.xz
 PKG_SOURCE_URL:=http://ftp.debian.org/debian/pool/non-free/i/intel-microcode/
-PKG_HASH:=6ccb295d23961c7b96a69280e30fdce939e1d905147b22b8428886b173812d52
+PKG_HASH:=26dfaa47100ce3d06f968edefa7539da10de7b96d5d8e26ee8174a040ee5cdae
 PKG_BUILD_DIR:=$(BUILD_DIR)/$(PKG_NAME)-3.$(PKG_VERSION).$(PKG_RELEASE)
 
 PKG_BUILD_DEPENDS:=iucode-tool/host
@@ -36,14 +36,14 @@ endef
 
 define Build/Compile
 	IUCODE_TOOL=$(STAGING_DIR)/../host/bin/iucode_tool $(MAKE) -C $(PKG_BUILD_DIR)
-	mkdir $(PKG_BUILD_DIR)/intel-ucode
+	mkdir $(PKG_BUILD_DIR)/intel-ucode-ipkg
 	$(STAGING_DIR)/../host/bin/iucode_tool -q \
-		--write-firmware=$(PKG_BUILD_DIR)/intel-ucode $(PKG_BUILD_DIR)/$(MICROCODE).bin
+		--write-firmware=$(PKG_BUILD_DIR)/intel-ucode-ipkg $(PKG_BUILD_DIR)/$(MICROCODE).bin
 endef
 
 define Package/intel-microcode/install
 	$(INSTALL_DIR) $(1)/lib/firmware/intel-ucode
-	$(INSTALL_DATA) $(PKG_BUILD_DIR)/intel-ucode/* $(1)/lib/firmware/intel-ucode
+	$(INSTALL_DATA) $(PKG_BUILD_DIR)/intel-ucode-ipkg/* $(1)/lib/firmware/intel-ucode
 endef
 
 $(eval $(call BuildPackage,intel-microcode))
