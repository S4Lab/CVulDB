the-tcpdump-group__tcpdump
commit 607b8c3d61966a7cd15ae5aaef023392076eb9a3
Author:     Francois-Xavier Le Bail <devel.fx.lebail@orange.fr>
AuthorDate: Wed Mar 22 18:03:24 2017 +0100
Commit:     Denis Ovsienko <denis@ovsienko.info>
CommitDate: Mon Sep 4 00:08:58 2017 +0100

    CVE-2017-13024/IPv6 mobility: Add another test for a previous bounds check fix
    
    This is another capture file supplied by Bhargava Shastry, modified
    so the capture file won't cause 'tcpdump: pcap_loop: truncated dump file'

diff --git a/tests/TESTLIST b/tests/TESTLIST
index 7975fb2d..a5ea3d18 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -524,6 +524,7 @@ ip_printroute_asan	ip_printroute_asan.pcap		ip_printroute_asan.out	-v
 mobility_opt_asan	mobility_opt_asan.pcap		mobility_opt_asan.out	-v
 mobility_opt_asan_2	mobility_opt_asan_2.pcap	mobility_opt_asan_2.out	-v
 mobility_opt_asan_3	mobility_opt_asan_3.pcap	mobility_opt_asan_3.out	-v
+mobility_opt_asan_4	mobility_opt_asan_4.pcap	mobility_opt_asan_4.out	-v
 
 # RTP tests
 # fuzzed pcap
diff --git a/tests/mobility_opt_asan_4.out b/tests/mobility_opt_asan_4.out
new file mode 100644
index 00000000..d44f4e9d
--- /dev/null
+++ b/tests/mobility_opt_asan_4.out
@@ -0,0 +1 @@
+IP6 (class 0x50, flowlabel 0x00004, hlim 237, next-header Mobile IP (old) (62) payload length: 7168) d3c3:b2a9:200:400::6238:2949 > 9675:86dd:7300:2c:1c7f:ffff:ffc3:b2a1: mobility: BU seq#=116 A lifetime=15360(pad1)(pad1)(type-0x3c: len=19)(ni: ho=0x0400 co=0x0012)[|MOBILITY]
diff --git a/tests/mobility_opt_asan_4.pcap b/tests/mobility_opt_asan_4.pcap
new file mode 100644
index 00000000..c03cad65
Binary files /dev/null and b/tests/mobility_opt_asan_4.pcap differ
