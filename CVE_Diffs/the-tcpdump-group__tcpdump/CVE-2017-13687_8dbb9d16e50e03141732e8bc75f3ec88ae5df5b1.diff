the-tcpdump-group__tcpdump
commit 8dbb9d16e50e03141732e8bc75f3ec88ae5df5b1
Author:     Guy Harris <guy@alum.mit.edu>
AuthorDate: Wed Feb 8 10:54:27 2017 -0800
Commit:     Denis Ovsienko <denis@ovsienko.info>
CommitDate: Mon Sep 4 00:08:58 2017 +0100

    CVE-2017-13687/CHDLC: Add a test.
    
    This is for the fix made a few commits before, which had no tests.
    
    Add a test using the capture file supplied by Kamil Frankowicz.

diff --git a/tests/TESTLIST b/tests/TESTLIST
index 19654550..e5fb7a3c 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -452,6 +452,7 @@ hoobr_juniper		hoobr_juniper.pcap		hoobr_juniper.out
 hoobr_juniper2		hoobr_juniper2.pcap		hoobr_juniper2.out
 hoobr_juniper3		hoobr_juniper3.pcap		hoobr_juniper3.out
 hoobr_parse_field	hoobr_parse_field.pcap		hoobr_parse_field.out
+hoobr_chdlc_print	hoobr_chdlc_print.pcap		hoobr_chdlc_print.out
 
 # bad packets from Wilfried Kirsch
 slip-bad-direction	slip-bad-direction.pcap		slip-bad-direction.out	-ve
diff --git a/tests/hoobr_chdlc_print.out b/tests/hoobr_chdlc_print.out
new file mode 100644
index 00000000..5701077d
--- /dev/null
+++ b/tests/hoobr_chdlc_print.out
@@ -0,0 +1,26 @@
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+[|chdlc]
diff --git a/tests/hoobr_chdlc_print.pcap b/tests/hoobr_chdlc_print.pcap
new file mode 100644
index 00000000..ffc75a4b
Binary files /dev/null and b/tests/hoobr_chdlc_print.pcap differ
