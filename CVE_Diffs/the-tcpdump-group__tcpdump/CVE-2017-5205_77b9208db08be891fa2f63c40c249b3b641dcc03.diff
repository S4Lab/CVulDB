the-tcpdump-group__tcpdump
commit 77b9208db08be891fa2f63c40c249b3b641dcc03
Author:     Denis Ovsienko <denis@ovsienko.info>
AuthorDate: Mon Jan 16 11:19:00 2017 +0000
Commit:     Francois-Xavier Le Bail <fx.lebail@yahoo.com>
CommitDate: Wed Jan 18 09:16:42 2017 +0100

    CVE-2017-5205/add a test case
    
    The .pcap file comes from Francois-Xavier Le Bail.

diff --git a/tests/TESTLIST b/tests/TESTLIST
index 7b487e09..1e6edfdd 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -70,6 +70,8 @@ ikev2four	ikev2four.pcap		ikev2four.out	-t -v
 ikev2fourv	ikev2four.pcap		ikev2fourv.out	-t -v -v -v
 ikev2fourv4	ikev2four.pcap		ikev2fourv4.out	-t -v -v -v -v
 # ikev2pI2 test in crypto.sh
+ikev2pI2-segfault	ikev2pI2-segfault.pcap	ikev2pI2-segfault.out	-t
+ikev2pI2-segfault-v	ikev2pI2-segfault.pcap	ikev2pI2-segfault-v.out	-t -v
 
 # IETF ROLL RPL packets
 dio02           rpl-19-pickdag.pcap         rpl-19-pickdag.out  -t -v -v
diff --git a/tests/ikev2pI2-segfault-v.out b/tests/ikev2pI2-segfault-v.out
new file mode 100644
index 00000000..a690ef96
--- /dev/null
+++ b/tests/ikev2pI2-segfault-v.out
@@ -0,0 +1,8 @@
+IP (tos 0x0, ttl 64, id 0, offset 0, flags [none], proto UDP (17), length 536, bad cksum 0 (->f48e)!)
+    192.1.2.45.500 > 192.1.2.23.500: isakmp 2.0 msgid 00000000: parent_sa ikev2_init[I]:
+    (sa[C]: len=240
+        (p: #1 protoid=isakmp transform=4 len=40
+            (t: #1 type=encr id=#26380 )
+            (t: #2 type=integ id=hmac-sha )
+            (t: #3 type=prf id=hmac-sha )
+            (v2e)) [|v2sa]) [|v2ke]
diff --git a/tests/ikev2pI2-segfault.out b/tests/ikev2pI2-segfault.out
new file mode 100644
index 00000000..c7f02811
--- /dev/null
+++ b/tests/ikev2pI2-segfault.out
@@ -0,0 +1 @@
+IP 192.1.2.45.500 > 192.1.2.23.500: isakmp: parent_sa ikev2_init[I]
diff --git a/tests/ikev2pI2-segfault.pcap b/tests/ikev2pI2-segfault.pcap
new file mode 100644
index 00000000..43a7e284
Binary files /dev/null and b/tests/ikev2pI2-segfault.pcap differ
