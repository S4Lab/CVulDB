the-tcpdump-group__tcpdump
commit 496be87393765efd1e62b29df100ea3c7a718972
Author:     Francois-Xavier Le Bail <fx.lebail@yahoo.com>
AuthorDate: Fri Dec 23 21:53:26 2016 +0100
Commit:     Francois-Xavier Le Bail <fx.lebail@yahoo.com>
CommitDate: Wed Jan 18 09:16:41 2017 +0100

    CVE-2017-5203/BOOTP: Add a bounds check
    
    This fix GitHub issue #557

diff --git a/print-bootp.c b/print-bootp.c
index 26ac0de9..fe798a04 100644
--- a/print-bootp.c
+++ b/print-bootp.c
@@ -293,6 +293,7 @@ bootp_print(netdissect_options *ndo,
 	ND_PRINT((ndo, "BOOTP/DHCP, %s",
 		  tok2str(bootp_op_values, "unknown (0x%02x)", bp->bp_op)));
 
+	ND_TCHECK(bp->bp_hlen);
 	if (bp->bp_htype == 1 && bp->bp_hlen == 6 && bp->bp_op == BOOTPREQUEST) {
 		ND_TCHECK2(bp->bp_chaddr[0], 6);
 		ND_PRINT((ndo, " from %s", etheraddr_string(ndo, bp->bp_chaddr)));
