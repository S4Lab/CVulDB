the-tcpdump-group__tcpdump
commit 35e410ca1f6ae8d87c9103cf04d6f6c85735b11b
Author:     Francois-Xavier Le Bail <fx.lebail@yahoo.com>
AuthorDate: Sat Feb 6 14:49:56 2016 +0100
Commit:     Francois-Xavier Le Bail <fx.lebail@yahoo.com>
CommitDate: Sat Feb 6 15:26:14 2016 +0100

    Add three test cases for already fixed CVEs
    
    CVEs by Steffen Bauch
    CVE-2014-8767: OLSR
    CVE-2014-8768: Geonet
    CVE-2014-8769: AODV

diff --git a/tests/TESTLIST b/tests/TESTLIST
index 325c30ff..a7320406 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -291,6 +291,11 @@ medsa-e		medsa.pcap		medsa-e.out	-t -e
 # VXLAN tests
 vxlan  vxlan.pcap  vxlan.out  -# -t -e
 
+# CVEs 2014 malformed packets from Steffen Bauch
+cve-2014-8767-OLSR cve-2014-8767-OLSR.pcap cve-2014-8767-OLSR.out -t -v
+cve-2014-8768-Geonet cve-2014-8768-Geonet.pcap cve-2014-8768-Geonet.out -t -v
+cve-2014-8769-AODV cve-2014-8769-AODV.pcap cve-2014-8769-AODV.out -t -v
+
 # bad packets from Kevin Day
 # cve-2015-2155 -- futz testing on FORCES printer
 kday1           kday1.pcap              kday1.out       -t -v
diff --git a/tests/cve-2014-8767-OLSR.out b/tests/cve-2014-8767-OLSR.out
new file mode 100644
index 00000000..edfb0670
--- /dev/null
+++ b/tests/cve-2014-8767-OLSR.out
@@ -0,0 +1,4 @@
+IP (tos 0x15,ECT(1), ttl 77, id 62335, offset 0, flags [DF], proto UDP (17), length 61, bad cksum 30c6 (->22af)!)
+    10.1.1.104.698 > 10.2.2.2.514: OLSRv4, seq 0x0202, length 33
+	TC Message (0x02), originator 2.2.2.2, ttl 2, hop 2
+	  vtime 0.070s, msg-seq 0x0202, length 2 (invalid)
diff --git a/tests/cve-2014-8767-OLSR.pcap b/tests/cve-2014-8767-OLSR.pcap
new file mode 100644
index 00000000..67036ed7
Binary files /dev/null and b/tests/cve-2014-8767-OLSR.pcap differ
diff --git a/tests/cve-2014-8768-Geonet.out b/tests/cve-2014-8768-Geonet.out
new file mode 100644
index 00000000..4b7182d5
--- /dev/null
+++ b/tests/cve-2014-8768-Geonet.out
@@ -0,0 +1 @@
+GeoNet src:07:07:07:07:07:07; v:12 NH:6-Unknown HT:5-1-TopoScopeBcast-MH HopLim:7 Payload:1799 GN_ADDR:ef:06:07:35:97:00:24:8c lat:4521984 lon:1039368000 Malformed (small) 
diff --git a/tests/cve-2014-8768-Geonet.pcap b/tests/cve-2014-8768-Geonet.pcap
new file mode 100644
index 00000000..345ed242
Binary files /dev/null and b/tests/cve-2014-8768-Geonet.pcap differ
diff --git a/tests/cve-2014-8769-AODV.out b/tests/cve-2014-8769-AODV.out
new file mode 100644
index 00000000..0bb70b49
--- /dev/null
+++ b/tests/cve-2014-8769-AODV.out
@@ -0,0 +1,2 @@
+IP truncated-ip - 58880 bytes missing! (tos 0x0, ttl 64, id 62335, offset 0, flags [DF], proto UDP (17), length 58941, bad cksum 30c6 (->49c3)!)
+    10.1.1.104.654 > 10.2.2.2.3328:  aodv rerr  [items 0] [19192]:
diff --git a/tests/cve-2014-8769-AODV.pcap b/tests/cve-2014-8769-AODV.pcap
new file mode 100644
index 00000000..3cd15691
Binary files /dev/null and b/tests/cve-2014-8769-AODV.pcap differ
