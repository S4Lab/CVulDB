the-tcpdump-group__tcpdump
commit 909fb30769e92d3f432b41d3eea3c0623bc03c84
Author:     Francois-Xavier Le Bail <fx.lebail@yahoo.com>
AuthorDate: Fri Dec 23 22:11:18 2016 +0100
Commit:     Francois-Xavier Le Bail <fx.lebail@yahoo.com>
CommitDate: Wed Jan 18 09:16:41 2017 +0100

    CVE-2017-5202/ISOCLNS: Add two bounds checks
    
    This fix GitHub issue #558

diff --git a/print-isoclns.c b/print-isoclns.c
index 0d63679c..e507d54d 100644
--- a/print-isoclns.c
+++ b/print-isoclns.c
@@ -798,11 +798,13 @@ clnp_print(netdissect_options *ndo,
 
         pptr += sizeof(struct clnp_header_t);
         li -= sizeof(struct clnp_header_t);
+	ND_TCHECK(*pptr);
         dest_address_length = *pptr;
         dest_address = pptr + 1;
 
         pptr += (1 + dest_address_length);
         li -= (1 + dest_address_length);
+	ND_TCHECK(*pptr);
         source_address_length = *pptr;
         source_address = pptr +1;
 
