abrt__abrt
commit 1246f1d466b7eeaacdcbc65ef7081f626f7335ad
Author:     Jakub Filak <jfilak@redhat.com>
AuthorDate: Wed Sep 30 14:14:31 2015 +0200
Commit:     Jakub Filak <jfilak@redhat.com>
CommitDate: Mon Nov 23 14:52:53 2015 +0100

    abrtd: switch owner of the dump location to 'root'
    
    Additional hardening suggested by Florian Weimer <fweimer@redhat.com>
    Related to CVE-2015-5287
    
    Signed-off-by: Jakub Filak <jfilak@redhat.com>

diff --git a/src/daemon/abrtd.c b/src/daemon/abrtd.c
index 0352eed4..90a71636 100644
--- a/src/daemon/abrtd.c
+++ b/src/daemon/abrtd.c
@@ -195,7 +195,7 @@ static void sanitize_dump_dir_rights(void)
      * us with thousands of bogus or malicious dumps */
     /* 07000 bits are setuid, setgit, and sticky, and they must be unset */
     /* 00777 bits are usual "rwxrwxrwx" access rights */
-    ensure_writable_dir(g_settings_dump_location, DEFAULT_DUMP_LOCATION_MODE, "abrt");
+    ensure_writable_dir_group(g_settings_dump_location, DEFAULT_DUMP_LOCATION_MODE, "root", "abrt");
     /* temp dir */
     ensure_writable_dir(VAR_RUN"/abrt", 0755, "root");
 }
