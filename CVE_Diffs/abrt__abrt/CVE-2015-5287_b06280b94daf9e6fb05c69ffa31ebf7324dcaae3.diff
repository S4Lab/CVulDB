abrt__abrt
commit b06280b94daf9e6fb05c69ffa31ebf7324dcaae3
Author:     Jakub Filak <jfilak@redhat.com>
AuthorDate: Wed Sep 30 12:19:48 2015 +0200
Commit:     Jakub Filak <jfilak@redhat.com>
CommitDate: Mon Nov 23 14:36:31 2015 +0100

    ccpp: ignore crashes of ABRT binaries if DebugLevel == 0
    
    Prior this commit abrt-hook-ccpp was saved core file of any
    crashed process executing program whose name starts with "abrt" in
    DUMP_LOCATION.
    
    ABRT does not check size constraints of these core files, so the files
    could consume an uncontrolled amount of disk space.
    
    Related to CVE-2015-5287
    Related: #1262252
    
    Signed-off-by: Jakub Filak <jfilak@redhat.com>

diff --git a/src/hooks/abrt-hook-ccpp.c b/src/hooks/abrt-hook-ccpp.c
index 12b3f118..7a19cc2a 100644
--- a/src/hooks/abrt-hook-ccpp.c
+++ b/src/hooks/abrt-hook-ccpp.c
@@ -842,6 +842,13 @@ int main(int argc, char** argv)
     const char *last_slash = strrchr(executable, '/');
     if (last_slash && strncmp(++last_slash, "abrt", 4) == 0)
     {
+        if (g_settings_debug_level == 0)
+        {
+            log_warning("Ignoring crash of %s (SIG%s).",
+                        executable, signame ? signame : signal_str);
+            goto finito;
+        }
+
         /* If abrtd/abrt-foo crashes, we don't want to create a _directory_,
          * since that can make new copy of abrtd to process it,
          * and maybe crash again...
