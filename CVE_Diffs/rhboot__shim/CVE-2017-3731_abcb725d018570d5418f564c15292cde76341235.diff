rhboot__shim
commit abcb725d018570d5418f564c15292cde76341235
Author:     Yashaswini Hanji <yashaswini.hanji@intel.com>
AuthorDate: Thu Feb 16 18:35:30 2017 -0800
Commit:     Yashaswini Hanji <yashaswini.hanji@intel.com>
CommitDate: Tue Mar 7 10:18:45 2017 -0800

    Update OpenSSL from 1.0.1u to 1.0.2k due to 1.0.1 deprication
    
    CVE-2017-3731
    CVE-2017-3732
    CVE-2016-7055
    CVE-2016-7052

diff --git a/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.1u/engines-install-in-libdir-ssl.patch b/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.2k/0001-OpenSSL-1.0.2-Change-LIBDIR-engines-to-LIBDIR-ssl-en.patch
similarity index 70%
rename from meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.1u/engines-install-in-libdir-ssl.patch
rename to meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.2k/0001-OpenSSL-1.0.2-Change-LIBDIR-engines-to-LIBDIR-ssl-en.patch
index d8a6f1a..8c59a72 100644
--- a/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.1u/engines-install-in-libdir-ssl.patch
+++ b/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.2k/0001-OpenSSL-1.0.2-Change-LIBDIR-engines-to-LIBDIR-ssl-en.patch
@@ -1,11 +1,19 @@
-Upstream-Status: Inappropriate [configuration]
+From d3cae41cc50ddc8c36a63b4463aeb2d1606d90b4 Mon Sep 17 00:00:00 2001
+From: Calvin Park <calvin.s.park@intel.com>
+Date: Tue, 28 Feb 2017 15:21:02 -0800
+Subject: [PATCH] OpenSSL 1.0.2 Change $(LIBDIR)/engines to
+ $(LIBDIR)/ssl/engines
 
+---
+ openssl-1.0.0/engines/Makefile        | 10 +++++-----
+ openssl-1.0.0/engines/ccgost/Makefile |  8 ++++----
+ 2 files changed, 9 insertions(+), 9 deletions(-)
 
-Index: openssl-1.0.0/engines/Makefile
-===================================================================
---- openssl-1.0.0.orig/engines/Makefile
+diff --git openssl-1.0.0/engines/Makefile openssl-1.0.0/engines/Makefile
+index 2058ff4..fe8e9ca 100644
+--- openssl-1.0.0/engines/Makefile
 +++ openssl-1.0.0/engines/Makefile
-@@ -107,7 +107,7 @@
+@@ -107,13 +107,13 @@ install:
  	@[ -n "$(INSTALLTOP)" ] # should be set by top Makefile...
  	@if [ -n "$(SHARED_LIBS)" ]; then \
  		set -e; \
@@ -14,16 +22,19 @@ Index: openssl-1.0.0/engines/Makefile
  		for l in $(LIBNAMES); do \
  			( echo installing $$l; \
  			  pfx=lib; \
-@@ -119,13 +119,13 @@
+ 			  if expr "$(PLATFORM)" : "Cygwin" >/dev/null; then \
+ 				sfx=".so"; \
+-				cp cyg$$l.dll $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$$pfx$$l$$sfx.new; \
++				cp cyg$$l.dll $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/ssl/engines/$$pfx$$l$$sfx.new; \
+ 			  else \
+ 				case "$(CFLAGS)" in \
+ 				*DSO_BEOS*)	sfx=".so";;	\
+@@ -122,10 +122,10 @@ install:
  				*DSO_WIN32*)	sfx="eay32.dll"; pfx=;;	\
  				*)		sfx=".bad";;	\
  				esac; \
 -				cp $$pfx$$l$$sfx $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$$pfx$$l$$sfx.new; \
 +				cp $$pfx$$l$$sfx $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/ssl/engines/$$pfx$$l$$sfx.new; \
- 			  else \
- 				sfx=".so"; \
--				cp cyg$$l.dll $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$$pfx$$l$$sfx.new; \
-+				cp cyg$$l.dll $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/ssl/engines/$$pfx$$l$$sfx.new; \
  			  fi; \
 -			  chmod 555 $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$$pfx$$l$$sfx.new; \
 -			  mv -f $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$$pfx$$l$$sfx.new $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$$pfx$$l$$sfx ); \
@@ -32,20 +43,25 @@ Index: openssl-1.0.0/engines/Makefile
  		done; \
  	fi
  	@target=install; $(RECURSIVE_MAKE)
-Index: openssl-1.0.0/engines/ccgost/Makefile
-===================================================================
---- openssl-1.0.0.orig/engines/ccgost/Makefile
+diff --git openssl-1.0.0/engines/ccgost/Makefile openssl-1.0.0/engines/ccgost/Makefile
+index f378530..5286e23 100644
+--- openssl-1.0.0/engines/ccgost/Makefile
 +++ openssl-1.0.0/engines/ccgost/Makefile
-@@ -53,13 +53,13 @@
+@@ -47,7 +47,7 @@ install:
+ 		pfx=lib; \
+ 		if expr "$(PLATFORM)" : "Cygwin" >/dev/null; then \
+ 			sfx=".so"; \
+-			cp cyg$(LIBNAME).dll $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$${pfx}$(LIBNAME)$$sfx.new; \
++			cp cyg$(LIBNAME).dll $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/ssl/engines/$${pfx}$(LIBNAME)$$sfx.new; \
+ 		else \
+ 			case "$(CFLAGS)" in \
+ 			*DSO_BEOS*) sfx=".so";; \
+@@ -56,10 +56,10 @@ install:
  			*DSO_WIN32*) sfx="eay32.dll"; pfx=;; \
  			*) sfx=".bad";; \
  			esac; \
 -			cp $${pfx}$(LIBNAME)$$sfx $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$${pfx}$(LIBNAME)$$sfx.new; \
 +			cp $${pfx}$(LIBNAME)$$sfx $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/ssl/engines/$${pfx}$(LIBNAME)$$sfx.new; \
- 		else \
- 			sfx=".so"; \
--			cp cyg$(LIBNAME).dll $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$${pfx}$(LIBNAME)$$sfx.new; \
-+			cp cyg$(LIBNAME).dll $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/ssl/engines/$${pfx}$(LIBNAME)$$sfx.new; \
  		fi; \
 -		chmod 555 $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$${pfx}$(LIBNAME)$$sfx.new; \
 -		mv -f $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$${pfx}$(LIBNAME)$$sfx.new $(INSTALL_PREFIX)$(INSTALLTOP)/$(LIBDIR)/engines/$${pfx}$(LIBNAME)$$sfx; \
@@ -54,3 +70,6 @@ Index: openssl-1.0.0/engines/ccgost/Makefile
  	fi
  
  links:
+-- 
+2.10.1 (Apple Git-78)
+
diff --git a/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.1u/debian/debian-targets.patch b/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.2k/debian/debian-targets.patch
similarity index 100%
rename from meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.1u/debian/debian-targets.patch
rename to meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.2k/debian/debian-targets.patch
diff --git a/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.1u/debian/no-rpath.patch b/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.2k/debian/no-rpath.patch
similarity index 100%
rename from meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.1u/debian/no-rpath.patch
rename to meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.2k/debian/no-rpath.patch
diff --git a/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.1u/find.pl b/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.2k/find.pl
similarity index 100%
rename from meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.1u/find.pl
rename to meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl-1.0.2k/find.pl
diff --git a/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl_1.0.1u.bb b/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl_1.0.2k.bb
similarity index 78%
rename from meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl_1.0.1u.bb
rename to meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl_1.0.2k.bb
index ed36074..af2f3ea 100644
--- a/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl_1.0.1u.bb
+++ b/meta-clanton/meta-clanton-bsp/recipes-devtools/openssl/openssl_1.0.2k.bb
@@ -16,12 +16,12 @@ export OE_LDFLAGS="${LDFLAGS}"
 SRC_URI += " \
             file://debian/debian-targets.patch \
             file://debian/no-rpath.patch \
-            file://engines-install-in-libdir-ssl.patch \
+            file://0001-OpenSSL-1.0.2-Change-LIBDIR-engines-to-LIBDIR-ssl-en.patch \
             file://find.pl \
            "
 
-SRC_URI[md5sum] = "130bb19745db2a5a09f22ccbbf7e69d0"
-SRC_URI[sha256sum] = "4312b4ca1215b6f2c97007503d80db80d5157f76f8f7d3febbe6b4c56ff26739"
+SRC_URI[md5sum] = "f965fc0bf01bf882b31314b61391ae65"
+SRC_URI[sha256sum] = "6b3977c61f2aedf0f96367dcfb5c6e578cf37e7b8d913b4ecb6643c3cb88d8c0"
 
 PACKAGES =+ " \
 	${PN}-engines \
