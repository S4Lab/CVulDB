openssl__openssl
commit 47333a34d5485fc7788fc121c0bf8e754f8ffc55
Author:     Dr. Stephen Henson <steve@openssl.org>
AuthorDate: Wed Mar 3 15:41:00 2010 +0000
Commit:     Dr. Stephen Henson <steve@openssl.org>
CommitDate: Wed Mar 3 15:41:00 2010 +0000

    Submitted by: Tomas Hoger <thoger@redhat.com>
    
    Fix for CVE-2010-0433 where some kerberos enabled versions of OpenSSL
    could be crashed if the relevant tables were not present (e.g. chrooted).

diff --git a/CHANGES b/CHANGES
index 178a68dbda..c0a0cf41c0 100644
--- a/CHANGES
+++ b/CHANGES
@@ -842,6 +842,12 @@
 
   *) Change 'Configure' script to enable Camellia by default.
      [NTT]
+  
+   Changes between 0.9.8m and 0.9.8n [xx XXX xxxx]
+  
+  *) Fix for CVE-2010-0433 where some kerberos enabled versions of OpenSSL 
+     could be crashed if the relevant tables were not present (e.g. chrooted).
+     [Tomas Hoger <thoger@redhat.com>]
 
  Changes between 0.9.8l and 0.9.8m  [25 Feb 2010]
 
diff --git a/ssl/kssl.c b/ssl/kssl.c
index 4fb655285b..b820e37464 100644
--- a/ssl/kssl.c
+++ b/ssl/kssl.c
@@ -1803,6 +1803,9 @@ kssl_ctx_show(KSSL_CTX *kssl_ctx)
                                      kssl_ctx->service_name ? kssl_ctx->service_name: KRB5SVC,
                                      KRB5_NT_SRV_HST, &princ);
 
+    if (krb5rc)
+	goto exit;
+
     krb5rc = krb5_kt_get_entry(krb5context, krb5keytab, 
                                 princ,
                                 0 /* IGNORE_VNO */,
