liblouis__liblouis
commit d8cfdf1ab64a4c9c6685efe45bc735f68dac618c
Author:     Mike Gorse <mgorse@suse.com>
AuthorDate: Wed Aug 30 12:53:02 2017 -0500
Commit:     Mike Gorse <mgorse@linux-e5s4.suse>
CommitDate: Wed Aug 30 16:36:06 2017 -0500

    resolveSubtable: Fix buffer overflow parsing a malformed table
    
    The subtable's name can theoretically be up to MAXSTRING characters long.
    The base name is then copied into a buffer, and the subtable's name is
    appended, so we should allocate more than MAXSTRING bytes for the buffer.
    
    Fixes CVE-2017-13739, CVE-2017-13740, and CVE-2017-13742.

diff --git a/liblouis/compileTranslationTable.c b/liblouis/compileTranslationTable.c
index f5c4c068..5ec8812b 100644
--- a/liblouis/compileTranslationTable.c
+++ b/liblouis/compileTranslationTable.c
@@ -4980,7 +4980,7 @@ resolveSubtable (const char *table, const char *base, const char *searchPath)
 
   if (table == NULL || table[0] == '\0')
     return NULL;
-  tableFile = (char *) malloc (MAXSTRING * sizeof(char));
+  tableFile = (char *) malloc (MAXSTRING * sizeof(char) * 2);
   
   //
   // First try to resolve against base
