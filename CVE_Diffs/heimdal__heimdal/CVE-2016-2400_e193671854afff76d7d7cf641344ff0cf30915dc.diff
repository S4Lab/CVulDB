heimdal__heimdal
commit e193671854afff76d7d7cf641344ff0cf30915dc
Author:     Nicolas Williams <nico@twosigma.com>
AuthorDate: Mon Feb 29 18:34:57 2016 -0600
Commit:     Nicolas Williams <nico@twosigma.com>
CommitDate: Mon Feb 29 19:13:12 2016 -0600

    kadmind: fix pw leak from CVE-2016-2400 fix

diff --git a/kadmin/server.c b/kadmin/server.c
index 823769796..b339a9ac7 100644
--- a/kadmin/server.c
+++ b/kadmin/server.c
@@ -194,6 +194,8 @@ kadmind_dispatch(void *kadm_handlep, krb5_boolean initial,
             ret = check_aliases(contextp, &ent, NULL);
             if (ret) {
                 kadm5_free_principal_ent(kadm_handlep, &ent);
+                memset(password, 0, strlen(password));
+                free(password);
                 goto fail;
             }
         }
