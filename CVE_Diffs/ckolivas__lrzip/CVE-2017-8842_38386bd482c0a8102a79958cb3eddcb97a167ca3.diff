ckolivas__lrzip
commit 38386bd482c0a8102a79958cb3eddcb97a167ca3
Author:     Con Kolivas <kernel@kolivas.org>
AuthorDate: Fri Mar 9 17:39:40 2018 +1100
Commit:     Con Kolivas <kernel@kolivas.org>
CommitDate: Fri Mar 9 17:39:40 2018 +1100

    CVE-2017-8842 Fix divide-by-zero in bufRead::get

diff --git a/libzpaq/libzpaq.h b/libzpaq/libzpaq.h
index 93387da..cbe211d 100644
--- a/libzpaq/libzpaq.h
+++ b/libzpaq/libzpaq.h
@@ -465,7 +465,8 @@ struct bufRead: public libzpaq::Reader {
 
 	int get() {
 		if (progress && !(*s_len % 128)) {
-			int pct = (total_len - *s_len) * 100 / total_len;
+			int pct = (total_len > 0) ?
+				(total_len - *s_len) * 100 / total_len : 100;
 
 			if (pct / 10 != *last_pct / 10) {
 				int i;
