RobertCNelson__linux-stable-rcn-ee
commit 988042953360dcc04a965965f08e11b7e8329328
Author:     Patrick McHardy <kaber@trash.net>
AuthorDate: Tue Jan 10 02:00:07 2006 +0100
Commit:     Greg Kroah-Hartman <gregkh@suse.de>
CommitDate: Mon Jan 30 22:42:30 2006 -0800

    [PATCH] Fix crash in ip_nat_pptp (CVE-2006-0036)
    
    When an inbound PPTP_IN_CALL_REQUEST packet is received the
    PPTP NAT helper uses a NULL pointer in pointer arithmentic to
    calculate the offset in the packet which needs to be mangled
    and corrupts random memory or crashes.
    
    Signed-off-by: Patrick McHardy <kaber@trash.net>
    Signed-off-by: Chris Wright <chrisw@sous-sol.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

diff --git a/net/ipv4/netfilter/ip_nat_helper_pptp.c b/net/ipv4/netfilter/ip_nat_helper_pptp.c
index 56e29fae641b..4fe711c27ba8 100644
--- a/net/ipv4/netfilter/ip_nat_helper_pptp.c
+++ b/net/ipv4/netfilter/ip_nat_helper_pptp.c
@@ -313,7 +313,7 @@ pptp_inbound_pkt(struct sk_buff **pskb,
 		break;
 	case PPTP_IN_CALL_REQUEST:
 		/* only need to nat in case PAC is behind NAT box */
-		break;
+		return NF_ACCEPT;
 	case PPTP_WAN_ERROR_NOTIFY:
 		pcid = &pptpReq->wanerr.peersCallID;
 		break;
