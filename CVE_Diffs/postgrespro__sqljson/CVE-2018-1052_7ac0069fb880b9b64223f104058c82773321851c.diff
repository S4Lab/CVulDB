postgrespro__sqljson
commit 7ac0069fb880b9b64223f104058c82773321851c
Author:     Peter Eisentraut <peter_e@gmx.net>
AuthorDate: Thu Nov 15 23:22:19 2018 +0100
Commit:     Peter Eisentraut <peter_e@gmx.net>
CommitDate: Thu Nov 15 23:22:19 2018 +0100

    A small tweak to some comments for PartitionKeyData
    
    It was not really that obvious that there's meant to be exactly 1 item
    in the partexprs List for each zero-valued partattrs element.  Some
    incorrect code using these fields was the cause of CVE-2018-1052, so
    it's worthwhile to mention how they should be used in the comments.
    
    Author: David Rowley <david.rowley@2ndquadrant.com>

diff --git a/src/include/utils/partcache.h b/src/include/utils/partcache.h
index 873c60fafd..2939032f0a 100644
--- a/src/include/utils/partcache.h
+++ b/src/include/utils/partcache.h
@@ -26,9 +26,9 @@ typedef struct PartitionKeyData
 	char		strategy;		/* partitioning strategy */
 	int16		partnatts;		/* number of columns in the partition key */
 	AttrNumber *partattrs;		/* attribute numbers of columns in the
-								 * partition key */
+								 * partition key or 0 if it's an expr */
 	List	   *partexprs;		/* list of expressions in the partitioning
-								 * key, or NIL */
+								 * key, one for each zero-valued partattrs */
 
 	Oid		   *partopfamily;	/* OIDs of operator families */
 	Oid		   *partopcintype;	/* OIDs of opclass declared input data types */
