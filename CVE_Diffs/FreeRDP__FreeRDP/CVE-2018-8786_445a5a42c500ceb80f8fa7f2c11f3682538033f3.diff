FreeRDP__FreeRDP
commit 445a5a42c500ceb80f8fa7f2c11f3682538033f3
Author:     Armin Novak <armin.novak@thincast.com>
AuthorDate: Mon Oct 22 16:25:13 2018 +0200
Commit:     Armin Novak <armin.novak@thincast.com>
CommitDate: Tue Nov 20 11:08:31 2018 +0100

    Fixed CVE-2018-8786
    
    Thanks to Eyal Itkin from Check Point Software Technologies.

diff --git a/libfreerdp/core/update.c b/libfreerdp/core/update.c
index 5e0757dcb..c2ca42cc4 100644
--- a/libfreerdp/core/update.c
+++ b/libfreerdp/core/update.c
@@ -208,11 +208,9 @@ BITMAP_UPDATE* update_read_bitmap_update(rdpUpdate* update, wStream* s)
 
 	if (bitmapUpdate->number > bitmapUpdate->count)
 	{
-		UINT16 count;
-		BITMAP_DATA* newdata;
-		count = bitmapUpdate->number * 2;
-		newdata = (BITMAP_DATA*) realloc(bitmapUpdate->rectangles,
-		                                 sizeof(BITMAP_DATA) * count);
+		UINT32 count = bitmapUpdate->number * 2;
+		BITMAP_DATA* newdata = (BITMAP_DATA*) realloc(bitmapUpdate->rectangles,
+		                       sizeof(BITMAP_DATA) * count);
 
 		if (!newdata)
 			goto fail;
