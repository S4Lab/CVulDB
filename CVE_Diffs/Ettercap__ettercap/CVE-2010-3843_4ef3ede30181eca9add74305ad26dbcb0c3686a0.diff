Ettercap__ettercap
commit 4ef3ede30181eca9add74305ad26dbcb0c3686a0
Author:     Emilio Escobar <eescobar@gmail.com>
AuthorDate: Thu Aug 23 09:16:28 2012 -0400
Commit:     Emilio Escobar <eescobar@gmail.com>
CommitDate: Thu Aug 23 09:16:28 2012 -0400

    More changes to mitigate:
    CVE-2010-3843
    CVE-2010-3844

diff --git a/src/interfaces/gtk/ec_gtk_conf.c b/src/interfaces/gtk/ec_gtk_conf.c
index a1ef0c0f..c1133efc 100644
--- a/src/interfaces/gtk/ec_gtk_conf.c
+++ b/src/interfaces/gtk/ec_gtk_conf.c
@@ -72,9 +72,7 @@ void gtkui_conf_read(void) {
 #ifdef OS_WINDOWS
    path = ec_win_get_user_dir();
 #else
-   /* TODO: get the dopped privs home dir instead of "/root" */
-   /* path = g_get_home_dir(); */
-   path = g_get_tmp_dir();
+   path = g_get_home_dir();
 #endif
 
    filename = g_build_filename(path, ".ettercap_gtk", NULL);
diff --git a/src/interfaces/gtk/ec_gtk_mitm.c b/src/interfaces/gtk/ec_gtk_mitm.c
index c2efd09d..23aa53e5 100644
--- a/src/interfaces/gtk/ec_gtk_mitm.c
+++ b/src/interfaces/gtk/ec_gtk_mitm.c
@@ -180,9 +180,9 @@ void gtkui_icmp_redir(void)
 
       snprintf(params, 6, "icmp:");
 
-      strncat(params, gtk_entry_get_text(GTK_ENTRY(entry1)), PARAMS_LEN);
-      strncat(params, "/", PARAMS_LEN);
-      strncat(params, gtk_entry_get_text(GTK_ENTRY(entry2)), PARAMS_LEN);
+      strncat(params, gtk_entry_get_text(GTK_ENTRY(entry1)), ETH_ASCII_ADDR_LEN);
+      strncat(params, "/", 1);
+      strncat(params, gtk_entry_get_text(GTK_ENTRY(entry2)), IP6_ASCII_ADDR_LEN);
 
       gtkui_start_mitm();
    }
