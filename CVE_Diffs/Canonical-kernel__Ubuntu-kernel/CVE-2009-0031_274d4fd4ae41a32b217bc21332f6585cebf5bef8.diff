Canonical-kernel__Ubuntu-kernel
commit 274d4fd4ae41a32b217bc21332f6585cebf5bef8
Author:     Vegard Nossum <vegard.nossum@gmail.com>
AuthorDate: Sat Jan 17 17:45:45 2009 +0100
Commit:     Stefan Bader <stefan.bader@canonical.com>
CommitDate: Wed Mar 18 14:34:55 2009 +0100

    security: introduce missing kfree
    
    CVE-2009-0031
    
    commit 0d54ee1c7850a954026deec4cd4885f331da35cc upstream
    
    Plug this leak.
    
    Acked-by: David Howells <dhowells@redhat.com>
    Cc: James Morris <jmorris@namei.org>
    Cc: <stable@kernel.org>
    Signed-off-by: Vegard Nossum <vegard.nossum@gmail.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Stefan Bader <stefan.bader@canonical.com>

diff --git a/security/keys/keyctl.c b/security/keys/keyctl.c
index d9ca15c109cc..a8d9d7e3a4f4 100644
--- a/security/keys/keyctl.c
+++ b/security/keys/keyctl.c
@@ -253,6 +253,7 @@ long keyctl_join_session_keyring(const char __user *_name)
 
 	/* join the session */
 	ret = join_session_keyring(name);
+	kfree(name);
 
  error:
 	return ret;
