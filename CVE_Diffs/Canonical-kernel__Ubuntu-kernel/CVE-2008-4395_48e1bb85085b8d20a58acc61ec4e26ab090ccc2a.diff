Canonical-kernel__Ubuntu-kernel
commit 48e1bb85085b8d20a58acc61ec4e26ab090ccc2a
Author:     Stefan Bader <stefan.bader@canonical.com>
AuthorDate: Tue Nov 4 20:26:18 2008 +0100
Commit:     Stefan Bader <stefan.bader@canonical.com>
CommitDate: Wed Nov 5 09:28:39 2008 +0100

    UBUNTU: ndiswrapper: Print exactly the number of characters in essid
    
    OriginalAuthor: Andreas Kaseorg
    OriginalLocation: http://ndiswrapper.svn.sourceforge.net/viewvc/ndiswrapper?view=rev&revision=2673
    Bug: #275860
    CVE-2008-4395
    
    Print exactly the number of characters in essid, to prevent buffer overflow.
    Patch from Anders Kaseorg.
    
    Signed-off-by: Stefan Bader <stefan.bader@canonical.com>

diff --git a/ubuntu/misc/ndiswrapper/proc.c b/ubuntu/misc/ndiswrapper/proc.c
index 7f7b1aae35ad..fa09f5052e01 100644
--- a/ubuntu/misc/ndiswrapper/proc.c
+++ b/ubuntu/misc/ndiswrapper/proc.c
@@ -98,7 +98,7 @@ static int procfs_read_ndis_encr(char *page, char **start, off_t off,
 
 	res = mp_query(wnd, OID_802_11_SSID, &essid, sizeof(essid));
 	if (!res)
-		p += sprintf(p, "essid=%.*s\n", essid.length + 1, essid.essid);
+		p += sprintf(p, "essid=%.*s\n", essid.length, essid.essid);
 	res = mp_query_int(wnd, OID_802_11_ENCRYPTION_STATUS, &encr_status);
 	if (!res) {
 		typeof(&wnd->encr_info.keys[0]) tx_key;
