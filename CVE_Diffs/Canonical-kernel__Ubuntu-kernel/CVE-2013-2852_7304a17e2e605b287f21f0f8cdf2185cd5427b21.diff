Canonical-kernel__Ubuntu-kernel
commit 7304a17e2e605b287f21f0f8cdf2185cd5427b21
Author:     Kees Cook <keescook@chromium.org>
AuthorDate: Thu Jun 20 12:31:37 2013 +0100
Commit:     Brad Figg <brad.figg@canonical.com>
CommitDate: Thu Jun 20 12:19:47 2013 -0700

    b43: stop format string leaking into error msgs
    
    BugLink: https://bugs.launchpad.net/bugs/1189833
    
    The module parameter "fwpostfix" is userspace controllable, unfiltered,
    and is used to define the firmware filename. b43_do_request_fw() populates
    ctx->errors[] on error, containing the firmware filename. b43err()
    parses its arguments as a format string. For systems with b43 hardware,
    this could lead to a uid-0 to ring-0 escalation.
    
    CVE-2013-2852
    
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Cc: stable@vger.kernel.org
    Signed-off-by: John W. Linville <linville@tuxdriver.com>
    (cherry picked from commit e0e29b683d6784ef59bbc914eac85a04b650e63c)
    
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

diff --git a/drivers/net/wireless/b43/main.c b/drivers/net/wireless/b43/main.c
index 9bd53667042d..c14acea14b7c 100644
--- a/drivers/net/wireless/b43/main.c
+++ b/drivers/net/wireless/b43/main.c
@@ -2287,7 +2287,7 @@ static int b43_request_firmware(struct b43_wldev *dev)
 	for (i = 0; i < B43_NR_FWTYPES; i++) {
 		errmsg = ctx->errors[i];
 		if (strlen(errmsg))
-			b43err(dev->wl, errmsg);
+			b43err(dev->wl, "%s", errmsg);
 	}
 	b43_print_fw_helptext(dev->wl, 1);
 	err = -ENOENT;
