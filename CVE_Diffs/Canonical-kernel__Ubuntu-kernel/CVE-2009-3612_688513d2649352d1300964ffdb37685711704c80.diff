Canonical-kernel__Ubuntu-kernel
commit 688513d2649352d1300964ffdb37685711704c80
Author:     Jiri Pirko <jpirko@redhat.com>
AuthorDate: Thu Oct 8 01:21:46 2009 -0700
Commit:     Stefan Bader <stefan.bader@canonical.com>
CommitDate: Tue Dec 1 19:58:49 2009 +0100

    netlink: fix typo in initialization
    
    CVE-2009-3612
    
    Commit 9ef1d4c7c7aca1cd436612b6ca785b726ffb8ed8 ("[NETLINK]: Missing
    initializations in dumped data") introduced a typo in
    initialization. This patch fixes this.
    
    Signed-off-by: Jiri Pirko <jpirko@redhat.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    (cherry picked from commit ad61df918c44316940404891d5082c63e79c256a)
    
    Signed-off-by: Leann Ogasawara <leann.ogasawara@canonical.com>
    Signed-off-by: Stefan Bader <stefan.bader@canonical.com>

diff --git a/net/sched/cls_api.c b/net/sched/cls_api.c
index 03657976fd50..ea30ed4b8573 100644
--- a/net/sched/cls_api.c
+++ b/net/sched/cls_api.c
@@ -320,7 +320,7 @@ tcf_fill_node(struct sk_buff *skb, struct tcf_proto *tp, unsigned long fh,
 	tcm = NLMSG_DATA(nlh);
 	tcm->tcm_family = AF_UNSPEC;
 	tcm->tcm__pad1 = 0;
-	tcm->tcm__pad1 = 0;
+	tcm->tcm__pad2 = 0;
 	tcm->tcm_ifindex = tp->q->dev->ifindex;
 	tcm->tcm_parent = tp->classid;
 	tcm->tcm_info = TC_H_MAKE(tp->prio, tp->protocol);
