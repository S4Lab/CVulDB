Canonical-kernel__Ubuntu-kernel
commit a95cd7d25918bb7cf8fd3f374615ae2308169438
Author:     Salva Peiró <speiro@ai2.upv.es>
AuthorDate: Tue Dec 17 10:06:30 2013 +0100
Commit:     Tim Gardner <tim.gardner@canonical.com>
CommitDate: Thu Jan 30 03:38:04 2014 -0700

    hamradio/yam: fix info leak in ioctl
    
    CVE-2014-1446
    
    BugLink: http://bugs.launchpad.net/bugs/1271445
    
    The yam_ioctl() code fails to initialise the cmd field
    of the struct yamdrv_ioctl_cfg. Add an explicit memset(0)
    before filling the structure to avoid the 4-byte info leak.
    
    Signed-off-by: Salva Peiró <speiro@ai2.upv.es>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    (cherry picked from commit 8e3fbf870481eb53b2d3a322d1fc395ad8b367ed)
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>
    Acked-by: Brad Figg <brad.figg@canonical.com>

diff --git a/drivers/net/hamradio/yam.c b/drivers/net/hamradio/yam.c
index 694132e04af6..1a1002d069b9 100644
--- a/drivers/net/hamradio/yam.c
+++ b/drivers/net/hamradio/yam.c
@@ -1060,6 +1060,7 @@ static int yam_ioctl(struct net_device *dev, struct ifreq *ifr, int cmd)
 		break;
 
 	case SIOCYAMGCFG:
+		memset(&yi, 0, sizeof(yi));
 		yi.cfg.mask = 0xffffffff;
 		yi.cfg.iobase = yp->iobase;
 		yi.cfg.irq = yp->irq;
