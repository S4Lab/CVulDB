Canonical-kernel__Ubuntu-kernel
commit 36e24ba01c34029ab2861c4464d2547529278eeb
Author:     Mathias Krause <minipli@googlemail.com>
AuthorDate: Thu Jul 12 08:46:54 2012 +0200
Commit:     Tim Gardner <tim.gardner@canonical.com>
CommitDate: Wed Apr 17 06:54:26 2013 -0600

    isofs: avoid info leak on export
    
    CVE-2012-6549
    
    BugLink: http://bugs.launchpad.net/bugs/1156774
    
    For type 1 the parent_offset member in struct isofs_fid gets copied
    uninitialized to userland. Fix this by initializing it to 0.
    
    Signed-off-by: Mathias Krause <minipli@googlemail.com>
    Signed-off-by: Jan Kara <jack@suse.cz>
    (cherry picked from commit fe685aabf7c8c9f138e5ea900954d295bf229175)
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

diff --git a/fs/isofs/export.c b/fs/isofs/export.c
index e81a30593ba9..caec670db81d 100644
--- a/fs/isofs/export.c
+++ b/fs/isofs/export.c
@@ -131,6 +131,7 @@ isofs_export_encode_fh(struct dentry *dentry,
 	len = 3;
 	fh32[0] = ei->i_iget5_block;
  	fh16[2] = (__u16)ei->i_iget5_offset;  /* fh16 [sic] */
+	fh16[3] = 0;  /* avoid leaking uninitialized data */
 	fh32[2] = inode->i_generation;
 	if (connectable && !S_ISDIR(inode->i_mode)) {
 		struct inode *parent;
