Canonical-kernel__Ubuntu-kernel
commit c5d8ed7345d83fd4158d28bba9dc544ec91480c9
Author:     Salva Peiró <speiro@ai2.upv.es>
AuthorDate: Wed Apr 30 19:48:02 2014 +0200
Commit:     Brad Figg <brad.figg@canonical.com>
CommitDate: Wed Jun 25 08:52:40 2014 -0700

    media-device: fix infoleak in ioctl media_enum_entities()
    
    This fixes CVE-2014-1739.
    
    Signed-off-by: Salva Peiró <speiro@ai2.upv.es>
    Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Cc: stable@vger.kernel.org
    Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>
    (cherry picked from commit e6a623460e5fc960ac3ee9f946d3106233fd28d8)
    CVE-2014-1739
    BugLink: http://bugs.launchpad.net/bugs/1333609
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

diff --git a/drivers/media/media-device.c b/drivers/media/media-device.c
index 6f9eb94e85b3..25968dcfa422 100644
--- a/drivers/media/media-device.c
+++ b/drivers/media/media-device.c
@@ -90,6 +90,7 @@ static long media_device_enum_entities(struct media_device *mdev,
 	struct media_entity *ent;
 	struct media_entity_desc u_ent;
 
+	memset(&u_ent, 0, sizeof(u_ent));
 	if (copy_from_user(&u_ent.id, &uent->id, sizeof(u_ent.id)))
 		return -EFAULT;
 
