Canonical-kernel__Ubuntu-kernel
commit 3e7fd2954d5cf88a2ad3421f1818bd222751d74e
Author:     Mathias Krause <minipli@googlemail.com>
AuthorDate: Tue Mar 26 17:18:33 2013 +0000
Commit:     Tim Gardner <tim.gardner@canonical.com>
CommitDate: Tue Mar 26 11:38:15 2013 -0600

    atm: fix info leak in getsockopt(SO_ATMPVC)
    
    CVE-2012-6546
    
    BugLink: http://bugs.launchpad.net/bugs/1156759
    
    The ATM code fails to initialize the two padding bytes of struct
    sockaddr_atmpvc inserted for alignment. Add an explicit memset(0)
    before filling the structure to avoid the info leak.
    
    Signed-off-by: Mathias Krause <minipli@googlemail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    (back ported from commit e862f1a9b7df4e8196ebec45ac62295138aa3fc2)
    
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>
    
    Conflicts:
            net/atm/common.c
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

diff --git a/net/atm/common.c b/net/atm/common.c
index 950bd16d2383..0baf05e8d34b 100644
--- a/net/atm/common.c
+++ b/net/atm/common.c
@@ -749,6 +749,7 @@ int vcc_getsockopt(struct socket *sock, int level, int optname,
 				if (!vcc->dev ||
 				    !test_bit(ATM_VF_ADDR,&vcc->flags))
 					return -ENOTCONN;
+				memset(&pvc, 0, sizeof(pvc));
 				pvc.sap_family = AF_ATMPVC;
 				pvc.sap_addr.itf = vcc->dev->number;
 				pvc.sap_addr.vpi = vcc->vpi;
