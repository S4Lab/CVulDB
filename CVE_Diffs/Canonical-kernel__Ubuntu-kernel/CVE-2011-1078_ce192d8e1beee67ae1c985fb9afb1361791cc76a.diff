Canonical-kernel__Ubuntu-kernel
commit ce192d8e1beee67ae1c985fb9afb1361791cc76a
Author:     Vasiliy Kulikov <segoon@openwall.com>
AuthorDate: Tue Jul 26 19:51:02 2011 +0100
Commit:     Herton Ronaldo Krzesinski <herton.krzesinski@canonical.com>
CommitDate: Wed Aug 10 10:02:34 2011 -0300

    Bluetooth: sco: fix information leak to userspace, CVE-2011-1078
    
    struct sco_conninfo has one padding byte in the end.  Local variable
    cinfo of type sco_conninfo is copied to userspace with this uninizialized
    one byte, leading to old stack contents leak.
    
    Signed-off-by: Vasiliy Kulikov <segoon@openwall.com>
    Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>
    
    (cherry picked from commit c4c896e1471aec3b004a693c689f60be3b17ac86)
    CVE-2011-1078
    BugLink: http://bugs.launchpad.net/bugs/816542
    Signed-off-by: Andy Whitcroft <apw@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

diff --git a/net/bluetooth/sco.c b/net/bluetooth/sco.c
index dffee7c22671..cd76104bef8d 100644
--- a/net/bluetooth/sco.c
+++ b/net/bluetooth/sco.c
@@ -820,6 +820,7 @@ static int sco_sock_getsockopt(struct socket *sock, int level, int optname, char
 			break;
 		}
 
+		memset(&cinfo, 0, sizeof(cinfo));
 		cinfo.hci_handle = sco_pi(sk)->conn->hcon->handle;
 		memcpy(cinfo.dev_class, sco_pi(sk)->conn->hcon->dev_class, 3);
 
