Canonical-kernel__Ubuntu-kernel
commit d2dd70151e4be8ee75c7ee9fd3e7123c36bad5bc
Author:     Kees Cook <kees.cook@canonical.com>
AuthorDate: Mon Jan 31 17:59:15 2011 +0000
Commit:     Brad Figg <brad.figg@canonical.com>
CommitDate: Thu Feb 10 09:22:32 2011 -0800

    net: ax25: fix information leak to userland harder, CVE-2010-3875
    
    Commit fe10ae53384e48c51996941b7720ee16995cbcb7 adds a memset() to clear
    the structure being sent back to userspace, but accidentally used the
    wrong size.
    
    Reported-by: Brad Spengler <spender@grsecurity.net>
    Signed-off-by: Kees Cook <kees.cook@canonical.com>
    Cc: stable@kernel.org
    Signed-off-by: David S. Miller <davem@davemloft.net>
    
    CVE-2010-3875
    BugLink: http://bugs.launchpad.net/bugs/710714
    (cherry picked from commit 5b919f833d9d60588d026ad82d17f17e8872c7a9 upstream)
    Signed-off-by: Andy Whitcroft <apw@canonical.com>
    Acked-by: Brad Figg <brad.figg@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

diff --git a/net/ax25/af_ax25.c b/net/ax25/af_ax25.c
index 608a97b93968..1e9f3e420cad 100644
--- a/net/ax25/af_ax25.c
+++ b/net/ax25/af_ax25.c
@@ -1391,7 +1391,7 @@ static int ax25_getname(struct socket *sock, struct sockaddr *uaddr,
 	ax25_cb *ax25;
 	int err = 0;
 
-	memset(fsa, 0, sizeof(fsa));
+	memset(fsa, 0, sizeof(*fsa));
 	lock_sock(sk);
 	ax25 = ax25_sk(sk);
 
