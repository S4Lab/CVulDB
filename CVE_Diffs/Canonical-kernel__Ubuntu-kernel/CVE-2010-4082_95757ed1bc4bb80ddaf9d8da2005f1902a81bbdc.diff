Canonical-kernel__Ubuntu-kernel
commit 95757ed1bc4bb80ddaf9d8da2005f1902a81bbdc
Author:     Dan Rosenberg <drosenberg@vsecurity.com>
AuthorDate: Wed Sep 15 19:08:24 2010 -0400
Commit:     Tim Gardner <tim.gardner@canonical.com>
CommitDate: Wed Jun 8 08:07:46 2011 -0600

    drivers/video/via/ioctl.c: prevent reading uninitialized stack memory - CVE-2010-4082
    
    commit b4aaa78f4c2f9cde2f335b14f4ca30b01f9651ca upstream.
    
    The VIAFB_GET_INFO device ioctl allows unprivileged users to read 246
    bytes of uninitialized stack memory, because the "reserved" member of
    the viafb_ioctl_info struct declared on the stack is not altered or
    zeroed before being copied back to the user.  This patch takes care of
    it.
    
    CVE-2010-4082
    
    Signed-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>
    Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
    
    (cherry picked from commit 63e70525feb93ddfdadd2eb81d0a71a055343d99 2.6.35.6)
    
    Signed-off-by: Leann Ogasawara <leann.ogasawara@canonical.com>
    Signed-off-by: Paolo Pisati <paolo.pisati@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

diff --git a/drivers/video/via/ioctl.c b/drivers/video/via/ioctl.c
index da03c074e32a..4d553d0b8d7a 100644
--- a/drivers/video/via/ioctl.c
+++ b/drivers/video/via/ioctl.c
@@ -25,6 +25,8 @@ int viafb_ioctl_get_viafb_info(u_long arg)
 {
 	struct viafb_ioctl_info viainfo;
 
+	memset(&viainfo, 0, sizeof(struct viafb_ioctl_info));
+
 	viainfo.viafb_id = VIAID;
 	viainfo.vendor_id = PCI_VIA_VENDOR_ID;
 
