Canonical-kernel__Ubuntu-kernel
commit ccb8f28b0fbae60c761fd35ebb26f1c90bbdaa1a
Author:     Eric Dumazet <eric.dumazet@gmail.com>
AuthorDate: Wed Sep 2 02:40:09 2009 +0000
Commit:     Stefan Bader <stefan.bader@canonical.com>
CommitDate: Tue Dec 1 19:58:48 2009 +0100

    tc: Fix unitialized kernel memory leak
    
    CVE-2009-3228
    
    Three bytes of uninitialized kernel memory are currently leaked to user
    
    Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
    Reviewed-by: Jiri Pirko <jpirko@redhat.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    (cherry picked from commit 16ebb5e0b36ceadc8186f71d68b0c4fa4b6e781b)
    
    Signed-off-by: Leann Ogasawara <leann.ogasawara@canonical.com>
    Signed-off-by: Stefan Bader <stefan.bader@canonical.com>

diff --git a/net/sched/sch_api.c b/net/sched/sch_api.c
index 8ae137e3522b..8f3edce68e10 100644
--- a/net/sched/sch_api.c
+++ b/net/sched/sch_api.c
@@ -1044,6 +1044,8 @@ static int tc_fill_tclass(struct sk_buff *skb, struct Qdisc *q,
 	nlh = NLMSG_NEW(skb, pid, seq, event, sizeof(*tcm), flags);
 	tcm = NLMSG_DATA(nlh);
 	tcm->tcm_family = AF_UNSPEC;
+	tcm->tcm__pad1 = 0;
+	tcm->tcm__pad2 = 0;
 	tcm->tcm_ifindex = q->dev->ifindex;
 	tcm->tcm_parent = q->handle;
 	tcm->tcm_handle = q->handle;
