Canonical-kernel__Ubuntu-kernel
commit efc01e8a6a938375f487870a293a8a39d4358458
Author:     Dan Rosenberg <drosenberg@vsecurity.com>
AuthorDate: Wed Sep 15 11:43:04 2010 +0000
Commit:     Tim Gardner <tim.gardner@canonical.com>
CommitDate: Wed Jun 8 08:07:41 2011 -0600

    drivers/net/eql.c: prevent reading uninitialized stack memory - CVE-2010-3297
    
    commit 44467187dc22fdd33a1a06ea0ba86ce20be3fe3c upstream.
    
    Fixed formatting (tabs and line breaks).
    
    The EQL_GETMASTRCFG device ioctl allows unprivileged users to read 16
    bytes of uninitialized stack memory, because the "master_name" member of
    the master_config_t struct declared on the stack in eql_g_master_cfg()
    is not altered or zeroed before being copied back to the user.  This
    patch takes care of it.
    
    CVE-2010-3297
    
    Signed-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
    
    (cherry picked from commit 073b0b42c9a06e8c3d2e81fac440e3f387c0498a 2.6.35.6)
    
    Signed-off-by: Leann Ogasawara <leann.ogasawara@canonical.com>
    Signed-off-by: Paolo Pisati <paolo.pisati@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

diff --git a/drivers/net/eql.c b/drivers/net/eql.c
index dda2c7944da9..0cb1cf9cf4b0 100644
--- a/drivers/net/eql.c
+++ b/drivers/net/eql.c
@@ -555,6 +555,8 @@ static int eql_g_master_cfg(struct net_device *dev, master_config_t __user *mcp)
 	equalizer_t *eql;
 	master_config_t mc;
 
+	memset(&mc, 0, sizeof(master_config_t));
+
 	if (eql_is_master(dev)) {
 		eql = netdev_priv(dev);
 		mc.max_slaves = eql->max_slaves;
