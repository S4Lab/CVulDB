Canonical-kernel__Ubuntu-kernel
commit 35461c087110494ae30bf37cc1498d5eddf42937
Author:     Jan Beulich <jbeulich@novell.com>
AuthorDate: Tue Jul 22 13:04:18 2008 +0000
Commit:     Tim Gardner <tim.gardner@canonical.com>
CommitDate: Tue Aug 19 13:54:47 2008 -0600

    Fix compiler warning on 64-bit
    
    Picked from upstream 04e1e0cccade330ab3715ce59234f7e3b087e246 to fix warnings
    introduced with CVE-2008-1673.
    
    Signed-off-by: Steve French <sfrench@us.ibm.com>
    Signed-off-by: Stefan Bader <stefan.bader@canonical.com>

diff --git a/fs/cifs/asn1.c b/fs/cifs/asn1.c
index 5dbba896a7df..9b9d96078111 100644
--- a/fs/cifs/asn1.c
+++ b/fs/cifs/asn1.c
@@ -400,7 +400,7 @@ asn1_oid_decode(struct asn1_ctx *ctx,
 	size = eoc - ctx->pointer + 1;
 
 	/* first subid actually encodes first two subids */
-	if (size < 2 || size > ULONG_MAX/sizeof(unsigned long))
+	if (size < 2 || size > UINT_MAX/sizeof(unsigned long))
 		return 0;
 
 	*oid = kmalloc(size * sizeof(unsigned long), GFP_ATOMIC);
