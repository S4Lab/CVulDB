Canonical-kernel__Ubuntu-kernel
commit 61782bbf18ab0b5061917387db3ce67c37c5c954
Author:     Salva Peiró <speiro@ai2.upv.es>
AuthorDate: Wed Oct 16 12:46:50 2013 +0200
Commit:     Tim Gardner <tim.gardner@canonical.com>
CommitDate: Thu Jan 30 03:38:03 2014 -0700

    wanxl: fix info leak in ioctl
    
    CVE-2014-1445
    
    BugLink: http://bugs.launchpad.net/bugs/1271444
    
    The wanxl_ioctl() code fails to initialize the two padding bytes of
    struct sync_serial_settings after the ->loopback member. Add an explicit
    memset(0) before filling the structure to avoid the info leak.
    
    Signed-off-by: Salva Peiró <speiro@ai2.upv.es>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    (cherry picked from commit 2b13d06c9584b4eb773f1e80bbaedab9a1c344e1)
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>
    Acked-by: Brad Figg <brad.figg@canonical.com>

diff --git a/drivers/net/wan/wanxl.c b/drivers/net/wan/wanxl.c
index daee8a0624ee..b52b3786bd01 100644
--- a/drivers/net/wan/wanxl.c
+++ b/drivers/net/wan/wanxl.c
@@ -354,6 +354,7 @@ static int wanxl_ioctl(struct net_device *dev, struct ifreq *ifr, int cmd)
 			ifr->ifr_settings.size = size; /* data size wanted */
 			return -ENOBUFS;
 		}
+		memset(&line, 0, sizeof(line));
 		line.clock_type = get_status(port)->clocking;
 		line.clock_rate = 0;
 		line.loopback = 0;
