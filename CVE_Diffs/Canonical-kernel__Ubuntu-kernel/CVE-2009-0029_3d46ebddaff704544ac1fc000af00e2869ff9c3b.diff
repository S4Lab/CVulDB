Canonical-kernel__Ubuntu-kernel
commit 3d46ebddaff704544ac1fc000af00e2869ff9c3b
Author:     Chris Metcalf <cmetcalf@tilera.com>
AuthorDate: Fri May 18 13:33:24 2012 -0400
Commit:     Luis Henriques <luis.henriques@canonical.com>
CommitDate: Tue Jun 12 10:59:09 2012 +0100

    tilegx: enable SYSCALL_WRAPPERS support
    
    BugLink: http://bugs.launchpad.net/bugs/1008697
    
    commit e6d9668e119af44ae5bcd5f1197174531458afe3 upstream.
    
    Some discussion with the glibc mailing lists revealed that this was
    necessary for 64-bit platforms with MIPS-like sign-extension rules
    for 32-bit values.  The original symptom was that passing (uid_t)-1 to
    setreuid() was failing in programs linked -pthread because of the "setxid"
    mechanism for passing setxid-type function arguments to the syscall code.
    SYSCALL_WRAPPERS handles ensuring that all syscall arguments end up with
    proper sign-extension and is thus the appropriate fix for this problem.
    
    On other platforms (s390, powerpc, sparc64, and mips) this was fixed
    in 2.6.28.6.  The general issue is tracked as CVE-2009-0029.
    
    Signed-off-by: Chris Metcalf <cmetcalf@tilera.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Herton Ronaldo Krzesinski <herton.krzesinski@canonical.com>

diff --git a/arch/tile/Kconfig b/arch/tile/Kconfig
index 0249b8b4db54..532a2a42ab7e 100644
--- a/arch/tile/Kconfig
+++ b/arch/tile/Kconfig
@@ -11,6 +11,7 @@ config TILE
 	select GENERIC_IRQ_PROBE
 	select GENERIC_PENDING_IRQ if SMP
 	select GENERIC_IRQ_SHOW
+	select HAVE_SYSCALL_WRAPPERS if TILEGX
 	select SYS_HYPERVISOR
 
 # FIXME: investigate whether we need/want these options.
