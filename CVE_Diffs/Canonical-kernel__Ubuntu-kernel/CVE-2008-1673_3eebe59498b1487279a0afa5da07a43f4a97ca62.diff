Canonical-kernel__Ubuntu-kernel
commit 3eebe59498b1487279a0afa5da07a43f4a97ca62
Author:     David Howells <dhowells@redhat.com>
AuthorDate: Wed Jul 9 15:06:45 2008 -0700
Commit:     Tim Gardner <tim.gardner@canonical.com>
CommitDate: Tue Aug 19 13:54:57 2008 -0600

    netfilter: nf_nat_snmp_basic: fix a range check in NAT for SNMP
    
    Picked from upstream 252815b0cfe711001eff0327872209986b36d490 to fix warnings
    introduced by CVE-2008-1673.
    
    Fix a range check in netfilter IP NAT for SNMP to always use a big enough size
    variable that the compiler won't moan about comparing it to ULONG_MAX/8 on a
    64-bit platform.
    
    Signed-off-by: David Howells <dhowells@redhat.com>
    Signed-off-by: Patrick McHardy <kaber@trash.net>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Stefan Bader <stefan.bader@canonical.com>

diff --git a/net/ipv4/netfilter/nf_nat_snmp_basic.c b/net/ipv4/netfilter/nf_nat_snmp_basic.c
index 86b14e2bf2db..5f481e64ff6f 100644
--- a/net/ipv4/netfilter/nf_nat_snmp_basic.c
+++ b/net/ipv4/netfilter/nf_nat_snmp_basic.c
@@ -438,8 +438,8 @@ static unsigned char asn1_oid_decode(struct asn1_ctx *ctx,
 				     unsigned int *len)
 {
 	unsigned long subid;
-	unsigned int  size;
 	unsigned long *optr;
+	size_t size;
 
 	size = eoc - ctx->pointer + 1;
 
