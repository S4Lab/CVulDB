Canonical-kernel__Ubuntu-kernel
commit cc5dac61562d486267aaca07c86a3f8d1618365f
Author:     Salva Peir√≥ <speiro@ai2.upv.es>
AuthorDate: Fri Oct 11 12:50:03 2013 +0300
Commit:     Tim Gardner <tim.gardner@canonical.com>
CommitDate: Thu Jan 30 03:38:03 2014 -0700

    farsync: fix info leak in ioctl
    
    CVE-2014-1444
    
    BugLink: http://bugs.launchpad.net/bugs/1271442
    
    The fst_get_iface() code fails to initialize the two padding bytes of
    struct sync_serial_settings after the ->loopback member. Add an explicit
    memset(0) before filling the structure to avoid the info leak.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    (cherry picked from commit 96b340406724d87e4621284ebac5e059d67b2194)
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>
    Acked-by: Brad Figg <brad.figg@canonical.com>

diff --git a/drivers/net/wan/farsync.c b/drivers/net/wan/farsync.c
index beda387f2fc7..433bf990be79 100644
--- a/drivers/net/wan/farsync.c
+++ b/drivers/net/wan/farsync.c
@@ -1971,6 +1971,7 @@ fst_get_iface(struct fst_card_info *card, struct fst_port_info *port,
 	}
 
 	i = port->index;
+	memset(&sync, 0, sizeof(sync));
 	sync.clock_rate = FST_RDL(card, portConfig[i].lineSpeed);
 	/* Lucky card and linux use same encoding here */
 	sync.clock_type = FST_RDB(card, portConfig[i].internalClock) ==
