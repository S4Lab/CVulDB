Canonical-kernel__Ubuntu-kernel
commit 3d498f0afad6ccd0a7a9d325281e851c066c1608
Author:     Dan Carpenter <dan.carpenter@oracle.com>
AuthorDate: Tue Oct 1 17:05:04 2013 +0100
Commit:     Tim Gardner <tim.gardner@canonical.com>
CommitDate: Wed Oct 9 07:30:34 2013 -0600

    cpqarray: fix info leak in ida_locked_ioctl()
    
    BugLink: http://bugs.launchpad.net/bugs/1188355
    
    CVE-2013-2147
    
    The pciinfo struct has a two byte hole after ->dev_fn so stack
    information could be leaked to the user.
    
    This was assigned CVE-2013-2147.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Acked-by: Mike Miller <mike.miller@hp.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    (cherry picked from commit 627aad1c01da6f881e7f98d71fd928ca0c316b1a)
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>
    Acked-by: Andy Whitcroft <andy.whitcroft@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

diff --git a/drivers/block/cpqarray.c b/drivers/block/cpqarray.c
index 6422651ec364..f9caa45f22e0 100644
--- a/drivers/block/cpqarray.c
+++ b/drivers/block/cpqarray.c
@@ -1181,6 +1181,7 @@ out_passthru:
 		ida_pci_info_struct pciinfo;
 
 		if (!arg) return -EINVAL;
+		memset(&pciinfo, 0, sizeof(pciinfo));
 		pciinfo.bus = host->pci_dev->bus->number;
 		pciinfo.dev_fn = host->pci_dev->devfn;
 		pciinfo.board_id = host->board_id;
