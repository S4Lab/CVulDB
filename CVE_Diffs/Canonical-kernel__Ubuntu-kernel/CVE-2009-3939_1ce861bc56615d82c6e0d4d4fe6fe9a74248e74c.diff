Canonical-kernel__Ubuntu-kernel
commit 1ce861bc56615d82c6e0d4d4fe6fe9a74248e74c
Author:     Leann Ogasawara <leann.ogasawara@canonical.com>
AuthorDate: Tue Nov 24 02:22:51 2009 -0800
Commit:     Andy Whitcroft <apw@canonical.com>
CommitDate: Thu Dec 3 09:14:32 2009 +0000

    UBUNTU: [SCSI] megaraid_sas: remove sysfs poll_mode_io world writeable permissions
    
    CVE-2009-3939
    
    /sys/bus/pci/drivers/megaraid_sas/poll_mode_io defaults to being
    world-writable, which seems bad.
    
    This turns off group and user write permissions, so that on typical
    production systems only root can write to it.
    
    Signed-off-by: Leann Ogasawara <leann.ogasawara@canonical.com>

diff --git a/drivers/scsi/megaraid/megaraid_sas.c b/drivers/scsi/megaraid/megaraid_sas.c
index a39addc3a596..08a7f496096b 100644
--- a/drivers/scsi/megaraid/megaraid_sas.c
+++ b/drivers/scsi/megaraid/megaraid_sas.c
@@ -3451,7 +3451,7 @@ out:
 	return retval;
 }
 
-static DRIVER_ATTR(poll_mode_io, S_IRUGO|S_IWUGO,
+static DRIVER_ATTR(poll_mode_io, S_IRUGO|S_IWUSR,
 		megasas_sysfs_show_poll_mode_io,
 		megasas_sysfs_set_poll_mode_io);
 
