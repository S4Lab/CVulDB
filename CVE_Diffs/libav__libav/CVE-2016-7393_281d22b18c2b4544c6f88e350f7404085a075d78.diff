libav__libav
commit 281d22b18c2b4544c6f88e350f7404085a075d78
Author:     Janne Grunau <janne-libav@jannau.net>
AuthorDate: Mon Jun 8 14:48:26 2015 +0200
Commit:     Diego Biurrun <diego@biurrun.de>
CommitDate: Tue Sep 13 10:10:23 2016 +0200

    ac3_parser: add required padding for GetBitContext buffer
    
    Fixes stack buffer overflow errors detected by address sanitizer in
    various fate tests.
    
    Bug-Id: CVE-2016-7393
    CC: libav-stable@libav.org
    
    (cherry picked from commit a9f108bd78e842a47ade2f7c8b22a1764d01d4e6)
    Signed-off-by: Diego Biurrun <diego@biurrun.de>

diff --git a/libavcodec/ac3_parser.c b/libavcodec/ac3_parser.c
index d9ba1fd70..d71bab989 100644
--- a/libavcodec/ac3_parser.c
+++ b/libavcodec/ac3_parser.c
@@ -147,7 +147,7 @@ static int ac3_sync(uint64_t state, AACAC3ParseContext *hdr_info,
     int err;
     union {
         uint64_t u64;
-        uint8_t  u8[8];
+        uint8_t  u8[8 + FF_INPUT_BUFFER_PADDING_SIZE];
     } tmp = { av_be2ne64(state) };
     AC3HeaderInfo hdr;
     GetBitContext gbc;
