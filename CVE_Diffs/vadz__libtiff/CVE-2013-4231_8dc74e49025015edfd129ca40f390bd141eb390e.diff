vadz__libtiff
commit 8dc74e49025015edfd129ca40f390bd141eb390e
Author:     fwarmerdam <fwarmerdam>
AuthorDate: Wed Aug 14 05:18:53 2013 +0000
Commit:     fwarmerdam <fwarmerdam>
CommitDate: Wed Aug 14 05:18:53 2013 +0000

    make more resistent to corrupt/hostile input files (#2450, CVE-2013-4231)

diff --git a/ChangeLog b/ChangeLog
index 449555d2..6fbd83fe 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,5 +1,8 @@
 2013-08-13  Frank Warmerdam  <warmerdam@pobox.com>
 
+	* tools/gif2tiff.c: Be more careful about corrupt or
+	hostile input files (#2450, CVE-2013-4231)
+
 	* tools/tiff2pdf.c: terminate after failure of allocating 
 	ycbcr buffer (bug #2449, CVE-2013-4232)
 
diff --git a/tools/gif2tiff.c b/tools/gif2tiff.c
index 6b7b2023..277ad93d 100644
--- a/tools/gif2tiff.c
+++ b/tools/gif2tiff.c
@@ -333,6 +333,8 @@ readraster(void)
     int status = 1;
 
     datasize = getc(infile);
+    if (datasize > 12)
+	return 0;
     clear = 1 << datasize;
     eoi = clear + 1;
     avail = clear + 2;
