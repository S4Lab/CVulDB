DragonFlyBSD__DragonFlyBSD
commit 162ad19cfcb15718195bfa0f8a7471b9678f33a4
Author:     Matthew Dillon <dillon@apollo.backplane.com>
AuthorDate: Tue Feb 23 09:39:50 2010 -0800
Commit:     Matthew Dillon <dillon@apollo.backplane.com>
CommitDate: Tue Feb 23 09:39:50 2010 -0800

    contrib/expat - Apply two vendor fixes for CVE-2009-3720.
    
    Taken-from: FreeBSD

diff --git a/contrib/expat/lib/xmlparse.c b/contrib/expat/lib/xmlparse.c
index 94e31de9da..e111460d0a 100755
--- a/contrib/expat/lib/xmlparse.c
+++ b/contrib/expat/lib/xmlparse.c
@@ -3725,7 +3725,6 @@ doProlog(XML_Parser parser,
         return XML_ERROR_NO_ELEMENTS;
       default:
         tok = -tok;
-        next = end;
         break;
       }
     }
diff --git a/contrib/expat/lib/xmltok_impl.c b/contrib/expat/lib/xmltok_impl.c
index 1268819252..16dfb85f03 100755
--- a/contrib/expat/lib/xmltok_impl.c
+++ b/contrib/expat/lib/xmltok_impl.c
@@ -1744,7 +1744,7 @@ PREFIX(updatePosition)(const ENCODING *enc,
                        const char *end,
                        POSITION *pos)
 {
-  while (ptr != end) {
+  while (ptr < end) {
     switch (BYTE_TYPE(enc, ptr)) {
 #define LEAD_CASE(n) \
     case BT_LEAD ## n: \
