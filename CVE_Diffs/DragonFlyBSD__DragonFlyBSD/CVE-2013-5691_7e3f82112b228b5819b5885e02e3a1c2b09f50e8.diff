DragonFlyBSD__DragonFlyBSD
commit 7e3f82112b228b5819b5885e02e3a1c2b09f50e8
Author:     François Tigeot <ftigeot@wolfpond.org>
AuthorDate: Wed Sep 18 21:48:58 2013 +0200
Commit:     François Tigeot <ftigeot@wolfpond.org>
CommitDate: Wed Sep 18 22:53:09 2013 +0200

    inet6: Add missing ifioctl credential checks
    
    This fixes issue #2581 (again), but with SIOCSIFBRDADDR and
    SIOCSIFNETMASK ioctls this time.
    
    Security: CVE-2013-5691
    Patch-from: Loganaden Velvindron, inspired by FreeBSD changes

diff --git a/sys/netinet6/in6.c b/sys/netinet6/in6.c
index a8541e27be..de04fce543 100644
--- a/sys/netinet6/in6.c
+++ b/sys/netinet6/in6.c
@@ -611,6 +611,8 @@ in6_control(struct socket *so, u_long cmd, caddr_t data,
 
 	case SIOCSIFADDR:
 	case SIOCSIFDSTADDR:
+	case SIOCSIFBRDADDR:
+	case SIOCSIFNETMASK:
 		/*
 		 * Do not pass those ioctl to driver handler since they are not
 		 * properly setup.  Instead just error out.
