Bilibili__openssl
commit 9f13d4dd5ec420fb2fa0a7b94a6d66bb2700a492
Author:     Dr. Stephen Henson <steve@openssl.org>
AuthorDate: Fri Apr 22 18:44:23 2016 +0100
Commit:     Dr. Stephen Henson <steve@openssl.org>
CommitDate: Sat Apr 23 00:29:04 2016 +0100

    add test for CVE-2016-2109
    
    Reviewed-by: Richard Levitte <levitte@openssl.org>

diff --git a/test/d2i-tests/bad_bio.der b/test/d2i-tests/bad_bio.der
new file mode 100644
index 0000000000..8681f0528d
Binary files /dev/null and b/test/d2i-tests/bad_bio.der differ
diff --git a/test/recipes/25-test_d2i.t b/test/recipes/25-test_d2i.t
index 111fa5b100..9e1a643aaf 100644
--- a/test/recipes/25-test_d2i.t
+++ b/test/recipes/25-test_d2i.t
@@ -15,7 +15,7 @@ use OpenSSL::Test qw/:DEFAULT srctop_file/;
 
 setup("test_d2i");
 
-plan tests => 2;
+plan tests => 3;
 
 ok(run(test(["d2i_test", "X509", "decode",
              srctop_file('test','d2i-tests','bad_cert.der')])),
@@ -24,3 +24,7 @@ ok(run(test(["d2i_test", "X509", "decode",
 ok(run(test(["d2i_test", "GENERAL_NAME", "decode",
              srctop_file('test','d2i-tests','bad_generalname.der')])),
    "Running d2i_test bad_generalname.der");
+
+ok(run(test(["d2i_test", "ASN1_ANY", "BIO",
+             srctop_file('test','d2i-tests','bad_bio.der')])),
+   "Running d2i_test bad_bio.der");
