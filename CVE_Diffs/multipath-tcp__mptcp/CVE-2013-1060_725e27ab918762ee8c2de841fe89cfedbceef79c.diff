multipath-tcp__mptcp
commit 725e27ab918762ee8c2de841fe89cfedbceef79c
Author:     Andy Whitcroft <apw@canonical.com>
AuthorDate: Wed Jul 31 19:09:29 2013 +0100
Commit:     Brad Figg <brad.figg@canonical.com>
CommitDate: Tue Aug 13 13:04:47 2013 -0700

    UBUNTU: [Packaging] supply perf with appropriate prefix to ensure use of local config
    
    If we do not supply an installation prefix when we are building perf
    it will assume it is designed to run relative to the builders HOME.
    This means that as built on a buildd we will check for the system
    configuration relative to the buildd users home rather than in /etc.
    This implies a local user could use this to compromise other users _if_
    there is a buildd user installed on the system and they have access to it.
    
    CVE-2013-1060
    BugLink: http://bugs.launchpad.net/bugs/1206200
    Signed-off-by: Andy Whitcroft <apw@canonical.com>
    Acked-by: Brad Figg <brad.figg@canonical.com>
    Signed-off-by: Tim Gardner <tim.gardner@canonical.com>

diff --git a/debian/rules.d/2-binary-arch.mk b/debian/rules.d/2-binary-arch.mk
index 45dd4cc94b4e..c593ef2510c9 100644
--- a/debian/rules.d/2-binary-arch.mk
+++ b/debian/rules.d/2-binary-arch.mk
@@ -455,7 +455,7 @@ $(stampdir)/stamp-build-perarch: $(stampdir)/stamp-prepare-perarch
 ifeq ($(do_tools),true)
 ifeq ($(do_tools_perf),true)
 	cd $(builddirpa)/tools/perf && \
-		make HAVE_CPLUS_DEMANGLE=1 CROSS_COMPILE=$(CROSS_COMPILE) NO_LIBPYTHON=1 NO_LIBPERL=1
+		make prefix=/usr HAVE_CPLUS_DEMANGLE=1 CROSS_COMPILE=$(CROSS_COMPILE) NO_LIBPYTHON=1 NO_LIBPERL=1
 endif
 	if [ "$(arch)" = "amd64" ] || [ "$(arch)" = "i386" ]; then \
 		cd $(builddirpa)/tools/power/x86/x86_energy_perf_policy && make CROSS_COMPILE=$(CROSS_COMPILE); \
