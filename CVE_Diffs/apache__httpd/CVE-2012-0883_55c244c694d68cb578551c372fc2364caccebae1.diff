apache__httpd
commit 55c244c694d68cb578551c372fc2364caccebae1
Author:     Stefan Fritsch <sf@apache.org>
AuthorDate: Fri Mar 2 20:06:34 2012 +0000
Commit:     Stefan Fritsch <sf@apache.org>
CommitDate: Fri Mar 2 20:06:34 2012 +0000

    Fix insecure handling of LD_LIBRARY_PATH that could lead to the
    current working directory to be searched for DSOs
    
    CVE-2012-0883
    
    
    git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@1296428 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/CHANGES b/CHANGES
index 5e7f017f6f..a3b1d3a1c2 100644
--- a/CHANGES
+++ b/CHANGES
@@ -1,6 +1,10 @@
                                                          -*- coding: utf-8 -*-
 Changes with Apache 2.5.0
 
+  *) SECURITY: CVE-2012-0883 (cve.mitre.org)
+     envvars: Fix insecure handling of LD_LIBRARY_PATH that could lead to the
+     current working directory to be searched for DSOs. [Stefan Fritsch]
+
   *) Fix MPM DSO load failure on AIX.  [Jeff Trawick]
 
   *) core: Add the port number to the vhost's name in the scoreboard.
diff --git a/support/envvars-std.in b/support/envvars-std.in
index cf50c5c75e..9493bc749c 100644
--- a/support/envvars-std.in
+++ b/support/envvars-std.in
@@ -18,7 +18,11 @@
 #
 # This file is generated from envvars-std.in
 #
-@SHLIBPATH_VAR@="@exp_libdir@:$@SHLIBPATH_VAR@"
+if test "x$@SHLIBPATH_VAR@" != "x" ; then
+  @SHLIBPATH_VAR@="@exp_libdir@:$@SHLIBPATH_VAR@"
+else
+  @SHLIBPATH_VAR@="@exp_libdir@"
+fi
 export @SHLIBPATH_VAR@
 #
 @OS_SPECIFIC_VARS@
