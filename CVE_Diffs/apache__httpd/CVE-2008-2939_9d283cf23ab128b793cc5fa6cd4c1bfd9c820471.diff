apache__httpd
commit 9d283cf23ab128b793cc5fa6cd4c1bfd9c820471
Author:     Ruediger Pluem <rpluem@apache.org>
AuthorDate: Tue Aug 5 19:00:04 2008 +0000
Commit:     Ruediger Pluem <rpluem@apache.org>
CommitDate: Tue Aug 5 19:00:04 2008 +0000

    * Prevent XSS attacks when using wildcards in the path of the FTP URL
      (CVE-2008-2939). Discovered by Marc Bevand of Rapid7.
    
    
    git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@682868 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/modules/proxy/mod_proxy_ftp.c b/modules/proxy/mod_proxy_ftp.c
index e2350f4768..31a9ae3de9 100644
--- a/modules/proxy/mod_proxy_ftp.c
+++ b/modules/proxy/mod_proxy_ftp.c
@@ -390,6 +390,7 @@ static apr_status_t proxy_send_dir_filter(ap_filter_t *f,
                                                            c->bucket_alloc));
         }
         if (wildcard != NULL) {
+            wildcard = ap_escape_html(p, wildcard);
             APR_BRIGADE_INSERT_TAIL(out, apr_bucket_pool_create(wildcard,
                                                            strlen(wildcard), p,
                                                            c->bucket_alloc));
