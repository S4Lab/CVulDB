apache__httpd
commit 2fe8ec85fa8ef1340a61e688f3bc43c799add78e
Author:     William A. Rowe Jr <wrowe@apache.org>
AuthorDate: Tue Mar 2 04:46:13 2010 +0000
Commit:     William A. Rowe Jr <wrowe@apache.org>
CommitDate: Tue Mar 2 04:46:13 2010 +0000

    SECURITY: CVE-2010-0408 (cve.mitre.org)
    
    mod_proxy_ajp: Respond with HTTP_BAD_REQUEST when the body is not sent after
    request headers indicate a request body is incoming; this is not a case of
    HTTP_INTERNAL_SERVER_ERROR.
    
    Submitted by: Niku Toivola <niku.toivola sulake.com>
    
    rpluem, jim, wrowe
    
    
    
    git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@917875 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/modules/proxy/mod_proxy_ajp.c b/modules/proxy/mod_proxy_ajp.c
index 635ba32a89..0f5674cbec 100644
--- a/modules/proxy/mod_proxy_ajp.c
+++ b/modules/proxy/mod_proxy_ajp.c
@@ -257,7 +257,7 @@ static int ap_proxy_ajp_request(apr_pool_t *p, request_rec *r,
             ap_log_error(APLOG_MARK, APLOG_DEBUG, 0, r->server,
                          "proxy: ap_get_brigade failed");
             apr_brigade_destroy(input_brigade);
-            return HTTP_INTERNAL_SERVER_ERROR;
+            return HTTP_BAD_REQUEST;
         }
 
         /* have something */
