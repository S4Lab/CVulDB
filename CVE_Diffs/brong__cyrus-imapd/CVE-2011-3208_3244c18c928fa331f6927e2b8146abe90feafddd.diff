brong__cyrus-imapd
commit 3244c18c928fa331f6927e2b8146abe90feafddd
Author:     Bron Gondwana <brong@opera.com>
AuthorDate: Thu Sep 8 19:57:38 2011 +0200
Commit:     Bron Gondwana <brong@opera.com>
CommitDate: Thu Sep 8 20:50:45 2011 +0200

    CVE-2011-3208 - fix buffer overflow in nntpd

diff --git a/imap/nntpd.c b/imap/nntpd.c
index 070f557ee..aa9140b40 100644
--- a/imap/nntpd.c
+++ b/imap/nntpd.c
@@ -4164,7 +4164,9 @@ static struct wildmat *split_wildmats(char *str)
 	else if (*c == '@') wild[n].not = -1;	/* absolute not (feeding) */
 	else wild[n].not = 0;
 
-	strcpy(p, wild[n].not ? c + 1 : c);
+	strncpy(p, wild[n].not ? c + 1 : c, pattern+sizeof(pattern) - p);
+	pattern[sizeof(pattern)-1] = '\0';
+
 	wild[n++].pat = xstrdup(pattern);
     } while (c != str);
     wild[n].pat = NULL;
