tigeli__bind-utils
commit c04e1ac111fb72a72c1a69856adeb51cbc7158f9
Author:     Mark Andrews <marka@isc.org>
AuthorDate: Wed Jul 17 08:03:50 2013 +1000
Commit:     Mark Andrews <marka@isc.org>
CommitDate: Fri Jul 19 09:30:24 2013 +1000

    3621.   [security]      Incorrect bounds checking on private type 'keydata'
                            can lead to a remotely triggerable REQUIRE failure
                            (CVE-2013-4854). [RT #34238]
    
    (cherry picked from commit fdb4ae8f6c00d8ea03bde929bd4e47056972017d)

diff --git a/CHANGES b/CHANGES
index 31f7ddae07..8f54209955 100644
--- a/CHANGES
+++ b/CHANGES
@@ -1,5 +1,9 @@
 	--- 9.8.6rc1 released ---
 
+3621.	[security]	Incorrect bounds checking on private type 'keydata'
+			can lead to a remotely triggerable REQUIRE failure
+			(CVE-2013-4854). [RT #34238]
+
 3615.	[cleanup]	"configure" now finishes by printing a summary
 			of optional BIND features and whether they are
 			active or inactive. ("configure --enable-full-report"
diff --git a/lib/dns/rdata/generic/keydata_65533.c b/lib/dns/rdata/generic/keydata_65533.c
index 2592c30f6a..317e1a8724 100644
--- a/lib/dns/rdata/generic/keydata_65533.c
+++ b/lib/dns/rdata/generic/keydata_65533.c
@@ -176,7 +176,7 @@ fromwire_keydata(ARGS_FROMWIRE) {
 	UNUSED(options);
 
 	isc_buffer_activeregion(source, &sr);
-	if (sr.length < 4)
+	if (sr.length < 16)
 		return (ISC_R_UNEXPECTEDEND);
 
 	isc_buffer_forward(source, sr.length);
