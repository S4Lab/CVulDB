tigeli__bind-utils
commit 2d38b2ea688911e400c296a6998194a8fa97e059
Author:     Mark Andrews <marka@isc.org>
AuthorDate: Tue Jul 14 14:48:42 2015 +1000
Commit:     Mark Andrews <marka@isc.org>
CommitDate: Tue Jul 14 14:51:03 2015 +1000

    4165.   [bug]           An failure to reset a value to NULL in tkey.c could
                            result in an assertion failure. (CVE-2015-5477)
                            [RT #40046]
    
    (cherry picked from commit dbb064aa7972ef918d9a235b713108a4846cbb62)

diff --git a/CHANGES b/CHANGES
index 76185cba99..868f9f9415 100644
--- a/CHANGES
+++ b/CHANGES
@@ -1,3 +1,7 @@
+4165.	[bug]		An failure to reset a value to NULL in tkey.c could
+			result in an assertion failure. (CVE-2015-5477)
+			[RT #40046]
+
 	--- 9.9.7-P1 released ---
 
 4138.	[bug]		An uninitialized value in validator.c could result
diff --git a/lib/dns/tkey.c b/lib/dns/tkey.c
index f46577f01d..0bfc7ef6c5 100644
--- a/lib/dns/tkey.c
+++ b/lib/dns/tkey.c
@@ -650,6 +650,7 @@ dns_tkey_processquery(dns_message_t *msg, dns_tkeyctx_t *tctx,
 		 * Try the answer section, since that's where Win2000
 		 * puts it.
 		 */
+		name = NULL;
 		if (dns_message_findname(msg, DNS_SECTION_ANSWER, qname,
 					 dns_rdatatype_tkey, 0, &name,
 					 &tkeyset) != ISC_R_SUCCESS) {
