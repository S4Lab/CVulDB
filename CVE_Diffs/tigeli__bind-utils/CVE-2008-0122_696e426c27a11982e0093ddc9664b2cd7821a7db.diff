tigeli__bind-utils
commit 696e426c27a11982e0093ddc9664b2cd7821a7db
Author:     Mark Andrews <marka@isc.org>
AuthorDate: Tue Jan 15 04:02:18 2008 +0000
Commit:     Mark Andrews <marka@isc.org>
CommitDate: Tue Jan 15 04:02:18 2008 +0000

    2305.   [security]      inet_network() buffer overflow. CVE-2008-0122.

diff --git a/CHANGES b/CHANGES
index 641b95f56a..05321ce696 100644
--- a/CHANGES
+++ b/CHANGES
@@ -1,3 +1,5 @@
+2305.	[security]	inet_network() buffer overflow. CVE-2008-0122.
+
 2304.	[bug]		Check returns from all dns_rdata_tostruct() calls.
 			[RT #17460]
 
diff --git a/lib/bind/inet/inet_network.c b/lib/bind/inet/inet_network.c
index 4758a00f26..47976cff68 100644
--- a/lib/bind/inet/inet_network.c
+++ b/lib/bind/inet/inet_network.c
@@ -84,9 +84,9 @@ again:
 	}
 	if (!digit)
 		return (INADDR_NONE);
+	if (pp >= parts + 4 || val > 0xffU)
+		return (INADDR_NONE);
 	if (*cp == '.') {
-		if (pp >= parts + 4 || val > 0xffU)
-			return (INADDR_NONE);
 		*pp++ = val, cp++;
 		goto again;
 	}
