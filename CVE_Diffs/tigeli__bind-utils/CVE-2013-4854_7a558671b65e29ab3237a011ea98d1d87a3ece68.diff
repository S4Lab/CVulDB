tigeli__bind-utils
commit 7a558671b65e29ab3237a011ea98d1d87a3ece68
Author:     Mark Andrews <marka@isc.org>
AuthorDate: Wed Jul 17 08:03:50 2013 +1000
Commit:     Mark Andrews <marka@isc.org>
CommitDate: Fri Jul 19 09:27:21 2013 +1000

    3621.   [security]      Incorrect bounds checking on private type 'keydata'
                            can lead to a remotely triggerable REQUIRE failure
                            (CVE-2013-4854). [RT #34238]
    
    (cherry picked from commit fdb4ae8f6c00d8ea03bde929bd4e47056972017d)

diff --git a/CHANGES b/CHANGES
index 875cfaf25d..96d1d7e869 100644
--- a/CHANGES
+++ b/CHANGES
@@ -1,5 +1,9 @@
 	--- 9.9.4rc1 released ---
 
+3621.	[security]	Incorrect bounds checking on private type 'keydata'
+			can lead to a remotely triggerable REQUIRE failure
+			(CVE-2013-4854). [RT #34238]
+
 3617.	[bug]		Named was failing to answer queries during
 			"rndc reload" [RT #34098]
 
diff --git a/lib/dns/rdata/generic/keydata_65533.c b/lib/dns/rdata/generic/keydata_65533.c
index 46bf6fce20..a2d83f456e 100644
--- a/lib/dns/rdata/generic/keydata_65533.c
+++ b/lib/dns/rdata/generic/keydata_65533.c
@@ -194,7 +194,7 @@ fromwire_keydata(ARGS_FROMWIRE) {
 	UNUSED(options);
 
 	isc_buffer_activeregion(source, &sr);
-	if (sr.length < 4)
+	if (sr.length < 16)
 		return (ISC_R_UNEXPECTEDEND);
 
 	isc_buffer_forward(source, sr.length);
