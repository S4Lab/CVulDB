tigeli__bind-utils
commit a5f88548f62ceaec3276fa018996464700070a2e
Author:     Mark Andrews <marka@isc.org>
AuthorDate: Tue Jul 14 14:48:42 2015 +1000
Commit:     Mark Andrews <marka@isc.org>
CommitDate: Tue Jul 14 14:50:14 2015 +1000

    4165.   [bug]           An failure to reset a value to NULL in tkey.c could
                            result in an assertion failure. (CVE-2015-5477)
                            [RT #40046]
    
    (cherry picked from commit dbb064aa7972ef918d9a235b713108a4846cbb62)

diff --git a/CHANGES b/CHANGES
index 491ca7a90a..eb30ea3794 100644
--- a/CHANGES
+++ b/CHANGES
@@ -1,3 +1,7 @@
+4165.	[bug]		An failure to reset a value to NULL in tkey.c could
+			result in an assertion failure. (CVE-2015-5477)
+			[RT #40046]
+
 	--- 9.10.2-P2 released ---
 
 4138.	[bug]		An uninitialized value in validator.c could result
diff --git a/lib/dns/tkey.c b/lib/dns/tkey.c
index f65e0b022f..4f581879de 100644
--- a/lib/dns/tkey.c
+++ b/lib/dns/tkey.c
@@ -655,6 +655,7 @@ dns_tkey_processquery(dns_message_t *msg, dns_tkeyctx_t *tctx,
 		 * Try the answer section, since that's where Win2000
 		 * puts it.
 		 */
+		name = NULL;
 		if (dns_message_findname(msg, DNS_SECTION_ANSWER, qname,
 					 dns_rdatatype_tkey, 0, &name,
 					 &tkeyset) != ISC_R_SUCCESS) {
