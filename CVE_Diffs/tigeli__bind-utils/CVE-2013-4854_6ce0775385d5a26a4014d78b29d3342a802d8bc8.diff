tigeli__bind-utils
commit 6ce0775385d5a26a4014d78b29d3342a802d8bc8
Author:     Mark Andrews <marka@isc.org>
AuthorDate: Wed Jul 17 08:03:50 2013 +1000
Commit:     Mark Andrews <marka@isc.org>
CommitDate: Wed Jul 17 08:10:16 2013 +1000

    3621.   [security]      Incorrect bounds checking on private type 'keydata'
                            can lead to a remotely triggerable REQUIRE failure
                            (CVE-2013-4854). [RT #34238]
    
    (cherry picked from commit fdb4ae8f6c00d8ea03bde929bd4e47056972017d)

diff --git a/CHANGES b/CHANGES
index 2cfcb7b292..26c5c44c01 100644
--- a/CHANGES
+++ b/CHANGES
@@ -1,3 +1,7 @@
+3621.	[security]	Incorrect bounds checking on private type 'keydata'
+			can lead to a remotely triggerable REQUIRE failure
+			(CVE-2013-4854). [RT #34238]
+
 	--- 9.8.5-P1 released ---
 
 3584.	[security]	Caching data from an incompletely signed zone could
diff --git a/lib/dns/rdata/generic/keydata_65533.c b/lib/dns/rdata/generic/keydata_65533.c
index 2592c30f6a..317e1a8724 100644
--- a/lib/dns/rdata/generic/keydata_65533.c
+++ b/lib/dns/rdata/generic/keydata_65533.c
@@ -176,7 +176,7 @@ fromwire_keydata(ARGS_FROMWIRE) {
 	UNUSED(options);
 
 	isc_buffer_activeregion(source, &sr);
-	if (sr.length < 4)
+	if (sr.length < 16)
 		return (ISC_R_UNEXPECTEDEND);
 
 	isc_buffer_forward(source, sr.length);
