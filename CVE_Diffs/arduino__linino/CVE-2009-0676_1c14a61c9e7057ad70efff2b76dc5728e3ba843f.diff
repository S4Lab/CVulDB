arduino__linino
commit 1c14a61c9e7057ad70efff2b76dc5728e3ba843f
Author:     nico <nico@3c298f89-4303-0410-b956-a3cf2f4a3e73>
AuthorDate: Fri Apr 10 12:07:13 2009 +0000
Commit:     nico <nico@3c298f89-4303-0410-b956-a3cf2f4a3e73>
CommitDate: Fri Apr 10 12:07:13 2009 +0000

    [CVE-2009-0676] fix Linux kernel memory disclosure in sock_getsockopt (closes: #4914)
    
    
    
    git-svn-id: svn://svn.openwrt.org/openwrt@15192 3c298f89-4303-0410-b956-a3cf2f4a3e73

diff --git a/branches/8.09/target/linux/generic-2.6/patches-2.6.24/993-cve-2009-0676.patch b/branches/8.09/target/linux/generic-2.6/patches-2.6.24/993-cve-2009-0676.patch
new file mode 100644
index 0000000000..73f7aad638
--- /dev/null
+++ b/branches/8.09/target/linux/generic-2.6/patches-2.6.24/993-cve-2009-0676.patch
@@ -0,0 +1,13 @@
+http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0676
+
+--- a/net/core/sock.c
++++ b/net/core/sock.c
+@@ -691,6 +691,8 @@ int sock_getsockopt(struct socket *sock,
+ 	if (len < 0)
+ 		return -EINVAL;
+ 
++	v.val = 0;
++
+ 	switch(optname) {
+ 	case SO_DEBUG:
+ 		v.val = sock_flag(sk, SOCK_DBG);
diff --git a/branches/8.09/target/linux/generic-2.6/patches-2.6.25/993-cve-2009-0676.patch b/branches/8.09/target/linux/generic-2.6/patches-2.6.25/993-cve-2009-0676.patch
new file mode 100644
index 0000000000..c91a0398bd
--- /dev/null
+++ b/branches/8.09/target/linux/generic-2.6/patches-2.6.25/993-cve-2009-0676.patch
@@ -0,0 +1,13 @@
+http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0676
+
+--- a/net/core/sock.c
++++ b/net/core/sock.c
+@@ -705,6 +705,8 @@ int sock_getsockopt(struct socket *sock,
+ 	if (len < 0)
+ 		return -EINVAL;
+ 
++	v.val = 0;
++
+ 	switch(optname) {
+ 	case SO_DEBUG:
+ 		v.val = sock_flag(sk, SOCK_DBG);
diff --git a/branches/8.09/target/linux/generic-2.6/patches-2.6.26/993-cve-2009-0676.patch b/branches/8.09/target/linux/generic-2.6/patches-2.6.26/993-cve-2009-0676.patch
new file mode 100644
index 0000000000..70ce86d32c
--- /dev/null
+++ b/branches/8.09/target/linux/generic-2.6/patches-2.6.26/993-cve-2009-0676.patch
@@ -0,0 +1,13 @@
+http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0676
+
+--- a/net/core/sock.c
++++ b/net/core/sock.c
+@@ -697,6 +697,8 @@ int sock_getsockopt(struct socket *sock,
+ 	if (len < 0)
+ 		return -EINVAL;
+ 
++	v.val = 0;
++
+ 	switch(optname) {
+ 	case SO_DEBUG:
+ 		v.val = sock_flag(sk, SOCK_DBG);
