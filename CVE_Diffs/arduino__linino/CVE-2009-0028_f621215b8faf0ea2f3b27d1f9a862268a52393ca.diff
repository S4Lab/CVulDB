arduino__linino
commit f621215b8faf0ea2f3b27d1f9a862268a52393ca
Author:     nico <nico@3c298f89-4303-0410-b956-a3cf2f4a3e73>
AuthorDate: Fri Apr 10 12:01:54 2009 +0000
Commit:     nico <nico@3c298f89-4303-0410-b956-a3cf2f4a3e73>
CommitDate: Fri Apr 10 12:01:54 2009 +0000

    [CVE-2009-0028] fix Linux kernel minor signal handling vulnerability (closes: #4912)
    
    
    
    git-svn-id: svn://svn.openwrt.org/openwrt@15190 3c298f89-4303-0410-b956-a3cf2f4a3e73

diff --git a/branches/8.09/target/linux/generic-2.6/patches-2.6.24/991-cve-2009-0028.patch b/branches/8.09/target/linux/generic-2.6/patches-2.6.24/991-cve-2009-0028.patch
new file mode 100644
index 0000000000..2787738563
--- /dev/null
+++ b/branches/8.09/target/linux/generic-2.6/patches-2.6.24/991-cve-2009-0028.patch
@@ -0,0 +1,15 @@
+http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0028
+
+--- a/kernel/fork.c
++++ b/kernel/fork.c
+@@ -1202,7 +1202,9 @@ static struct task_struct *copy_process(
+ 	p->parent_exec_id = p->self_exec_id;
+ 
+ 	/* ok, now we should be set up.. */
+-	p->exit_signal = (clone_flags & CLONE_THREAD) ? -1 : (clone_flags & CSIGNAL);
++	p->exit_signal = (clone_flags & CLONE_THREAD) ? -1 :
++			 (clone_flags & CLONE_PARENT) ? current->group_leader->exit_signal :
++			 (clone_flags & CSIGNAL);
+ 	p->pdeath_signal = 0;
+ 	p->exit_state = 0;
+ 
diff --git a/branches/8.09/target/linux/generic-2.6/patches-2.6.25/991-cve-2009-0028.patch b/branches/8.09/target/linux/generic-2.6/patches-2.6.25/991-cve-2009-0028.patch
new file mode 100644
index 0000000000..685925436b
--- /dev/null
+++ b/branches/8.09/target/linux/generic-2.6/patches-2.6.25/991-cve-2009-0028.patch
@@ -0,0 +1,15 @@
+http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0028
+
+--- a/kernel/fork.c
++++ b/kernel/fork.c
+@@ -1246,7 +1246,9 @@ static struct task_struct *copy_process(
+ 	p->parent_exec_id = p->self_exec_id;
+ 
+ 	/* ok, now we should be set up.. */
+-	p->exit_signal = (clone_flags & CLONE_THREAD) ? -1 : (clone_flags & CSIGNAL);
++	p->exit_signal = (clone_flags & CLONE_THREAD) ? -1 :
++			 (clone_flags & CLONE_PARENT) ? current->group_leader->exit_signal :
++			 (clone_flags & CSIGNAL);
+ 	p->pdeath_signal = 0;
+ 	p->exit_state = 0;
+ 
diff --git a/branches/8.09/target/linux/generic-2.6/patches-2.6.26/991-cve-2009-0028.patch b/branches/8.09/target/linux/generic-2.6/patches-2.6.26/991-cve-2009-0028.patch
new file mode 100644
index 0000000000..8b129a739e
--- /dev/null
+++ b/branches/8.09/target/linux/generic-2.6/patches-2.6.26/991-cve-2009-0028.patch
@@ -0,0 +1,15 @@
+http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0028
+
+--- a/kernel/fork.c
++++ b/kernel/fork.c
+@@ -1114,7 +1114,9 @@ static struct task_struct *copy_process(
+ 	p->parent_exec_id = p->self_exec_id;
+ 
+ 	/* ok, now we should be set up.. */
+-	p->exit_signal = (clone_flags & CLONE_THREAD) ? -1 : (clone_flags & CSIGNAL);
++	p->exit_signal = (clone_flags & CLONE_THREAD) ? -1 :
++			 (clone_flags & CLONE_PARENT) ? current->group_leader->exit_signal :
++			 (clone_flags & CSIGNAL);
+ 	p->pdeath_signal = 0;
+ 	p->exit_state = 0;
+ 
