arduino__linino
commit 8e6a4650f261217cbb8a6411c26236f2937be9ea
Author:     nico <nico@3c298f89-4303-0410-b956-a3cf2f4a3e73>
AuthorDate: Sat May 23 02:36:44 2009 +0000
Commit:     nico <nico@3c298f89-4303-0410-b956-a3cf2f4a3e73>
CommitDate: Sat May 23 02:36:44 2009 +0000

    [CVE-2009-0159] fix stack-based buffer overflow in ntpq
    
    
    git-svn-id: svn://svn.openwrt.org/openwrt@16007 3c298f89-4303-0410-b956-a3cf2f4a3e73

diff --git a/branches/packages_8.09/net/ntpd/Makefile b/branches/packages_8.09/net/ntpd/Makefile
index 81280db821..d8620a57c0 100644
--- a/branches/packages_8.09/net/ntpd/Makefile
+++ b/branches/packages_8.09/net/ntpd/Makefile
@@ -1,5 +1,5 @@
 #
-# Copyright (C) 2006-2008 OpenWrt.org
+# Copyright (C) 2006-2009 OpenWrt.org
 #
 # This is free software, licensed under the GNU General Public License v2.
 # See /LICENSE for more information.
@@ -10,10 +10,10 @@ include $(TOPDIR)/rules.mk
 
 PKG_NAME:=ntp
 PKG_VERSION:=4.2.4p6
-PKG_RELEASE:=2
+PKG_RELEASE:=2.1
 
 PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.gz
-PKG_SOURCE_URL:=http://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/
+PKG_SOURCE_URL:=http://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/
 PKG_MD5SUM:=1961c2c12b66b9046d5df37d0a41b181
 
 PKG_BUILD_DIR:=$(BUILD_DIR)/$(PKG_NAME)-$(PKG_VERSION)
diff --git a/branches/packages_8.09/net/ntpd/patches/901-cve-2009-0159.patch b/branches/packages_8.09/net/ntpd/patches/901-cve-2009-0159.patch
new file mode 100644
index 0000000000..89b588f814
--- /dev/null
+++ b/branches/packages_8.09/net/ntpd/patches/901-cve-2009-0159.patch
@@ -0,0 +1,16 @@
+http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0159
+
+--- a/ntpq/ntpq.c
++++ b/ntpq/ntpq.c
+@@ -3185,9 +3185,9 @@ cookedprint(
+ 				if (!decodeuint(value, &uval))
+ 				    output_raw = '?';
+ 				else {
+-					char b[10];
++					char b[12];
+ 
+-					(void) sprintf(b, "%03lo", uval);
++					(void) snprintf(b, sizeof b, "%03lo", uval);
+ 					output(fp, name, b);
+ 				}
+ 				break;
