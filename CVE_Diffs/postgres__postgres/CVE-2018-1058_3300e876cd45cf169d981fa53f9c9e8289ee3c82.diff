postgres__postgres
commit 3300e876cd45cf169d981fa53f9c9e8289ee3c82
Author:     Tom Lane <tgl@sss.pgh.pa.us>
AuthorDate: Mon Feb 26 12:22:39 2018 -0500
Commit:     Tom Lane <tgl@sss.pgh.pa.us>
CommitDate: Mon Feb 26 12:22:39 2018 -0500

    Schema-qualify references in test_ddl_deparse test script.
    
    This omission seems to be what is causing buildfarm failures on crake.
    
    Security: CVE-2018-1058

diff --git a/src/test/modules/test_ddl_deparse/expected/test_ddl_deparse.out b/src/test/modules/test_ddl_deparse/expected/test_ddl_deparse.out
index e2e49f9d7f..4a5ea9e9ed 100644
--- a/src/test/modules/test_ddl_deparse/expected/test_ddl_deparse.out
+++ b/src/test/modules/test_ddl_deparse/expected/test_ddl_deparse.out
@@ -12,13 +12,13 @@ BEGIN
 	FOR r IN SELECT * FROM pg_event_trigger_ddl_commands()
 	LOOP
 		-- verify that tags match
-		tag = get_command_tag(r.command);
+		tag = public.get_command_tag(r.command);
 		IF tag <> r.command_tag THEN
 			RAISE NOTICE 'tag % doesn''t match %', tag, r.command_tag;
 		END IF;
 
 		-- log the operation
-		cmdtype = get_command_type(r.command);
+		cmdtype = public.get_command_type(r.command);
 		IF cmdtype <> 'grant' THEN
 			RAISE NOTICE 'DDL test: type %, tag %', cmdtype, tag;
 		ELSE
@@ -28,7 +28,7 @@ BEGIN
 		-- if alter table, log more
 		IF cmdtype = 'alter table' THEN
 			FOR r2 IN SELECT *
-						FROM unnest(get_altertable_subcmdtypes(r.command))
+						FROM unnest(public.get_altertable_subcmdtypes(r.command))
 			LOOP
 				RAISE NOTICE '  subcommand: %', r2.unnest;
 			END LOOP;
diff --git a/src/test/modules/test_ddl_deparse/sql/test_ddl_deparse.sql b/src/test/modules/test_ddl_deparse/sql/test_ddl_deparse.sql
index 4d08aaa1c4..e257a215e4 100644
--- a/src/test/modules/test_ddl_deparse/sql/test_ddl_deparse.sql
+++ b/src/test/modules/test_ddl_deparse/sql/test_ddl_deparse.sql
@@ -13,13 +13,13 @@ BEGIN
 	FOR r IN SELECT * FROM pg_event_trigger_ddl_commands()
 	LOOP
 		-- verify that tags match
-		tag = get_command_tag(r.command);
+		tag = public.get_command_tag(r.command);
 		IF tag <> r.command_tag THEN
 			RAISE NOTICE 'tag % doesn''t match %', tag, r.command_tag;
 		END IF;
 
 		-- log the operation
-		cmdtype = get_command_type(r.command);
+		cmdtype = public.get_command_type(r.command);
 		IF cmdtype <> 'grant' THEN
 			RAISE NOTICE 'DDL test: type %, tag %', cmdtype, tag;
 		ELSE
@@ -29,7 +29,7 @@ BEGIN
 		-- if alter table, log more
 		IF cmdtype = 'alter table' THEN
 			FOR r2 IN SELECT *
-						FROM unnest(get_altertable_subcmdtypes(r.command))
+						FROM unnest(public.get_altertable_subcmdtypes(r.command))
 			LOOP
 				RAISE NOTICE '  subcommand: %', r2.unnest;
 			END LOOP;
