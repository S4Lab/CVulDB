openbsd__xenocara
commit 19e04f544ad80de50774cc3dece009624f053148
Author:     matthieu <matthieu@openbsd.org>
AuthorDate: Thu Jan 17 15:41:53 2008 +0000
Commit:     matthieu <matthieu@openbsd.org>
CommitDate: Thu Jan 17 15:41:53 2008 +0000

    Fix from X.Org for CVE-2007-5958 - File existence disclosure.

diff --git a/xserver/Xext/security.c b/xserver/Xext/security.c
index ba057defd..e9d48c94d 100644
--- a/xserver/Xext/security.c
+++ b/xserver/Xext/security.c
@@ -1563,7 +1563,7 @@ SecurityLoadPropertyAccessList(void)
     if (!SecurityPolicyFile)
 	return;
 
-    f = fopen(SecurityPolicyFile, "r");
+    f = Fopen(SecurityPolicyFile, "r");
     if (!f)
     {
 	ErrorF("error opening security policy file %s\n",
@@ -1646,7 +1646,7 @@ SecurityLoadPropertyAccessList(void)
     }
 #endif /* PROPDEBUG */
 
-    fclose(f);
+    Fclose(f);
 } /* SecurityLoadPropertyAccessList */
 
 
