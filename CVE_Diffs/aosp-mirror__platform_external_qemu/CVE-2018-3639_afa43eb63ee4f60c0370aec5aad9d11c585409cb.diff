aosp-mirror__platform_external_qemu
commit afa43eb63ee4f60c0370aec5aad9d11c585409cb
Author:     Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
AuthorDate: Mon May 21 22:54:23 2018 +0100
Commit:     Michael Roth <mdroth@linux.vnet.ibm.com>
CommitDate: Wed Jun 20 20:45:07 2018 -0500

    i386: define the AMD 'virt-ssbd' CPUID feature bit (CVE-2018-3639)
    
    AMD Zen expose the Intel equivalant to Speculative Store Bypass Disable
    via the 0x80000008_EBX[25] CPUID feature bit.
    
    This needs to be exposed to guest OS to allow them to protect
    against CVE-2018-3639.
    
    Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
    Reviewed-by: Daniel P. Berrangé <berrange@redhat.com>
    Signed-off-by: Daniel P. Berrangé <berrange@redhat.com>
    Message-Id: <20180521215424.13520-3-berrange@redhat.com>
    Signed-off-by: Eduardo Habkost <ehabkost@redhat.com>
    (cherry picked from commit 403503b162ffc33fb64cfefdf7b880acf41772cd)
    Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>

diff --git a/target/i386/cpu.c b/target/i386/cpu.c
index bc087e95c3..1acf300cf8 100644
--- a/target/i386/cpu.c
+++ b/target/i386/cpu.c
@@ -490,7 +490,7 @@ static FeatureWordInfo feature_word_info[FEATURE_WORDS] = {
             "ibpb", NULL, NULL, NULL,
             NULL, NULL, NULL, NULL,
             NULL, NULL, NULL, NULL,
-            NULL, NULL, NULL, NULL,
+            NULL, "virt-ssbd", NULL, NULL,
             NULL, NULL, NULL, NULL,
         },
         .cpuid_eax = 0x80000008,
