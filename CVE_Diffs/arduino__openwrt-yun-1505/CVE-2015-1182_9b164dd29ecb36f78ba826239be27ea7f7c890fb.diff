arduino__openwrt-yun-1505
commit 9b164dd29ecb36f78ba826239be27ea7f7c890fb
Author:     Jo-Philipp Wich <jow@openwrt.org>
AuthorDate: Tue Jan 20 12:49:54 2015 +0000
Commit:     Jo-Philipp Wich <jow@openwrt.org>
CommitDate: Tue Jan 20 12:49:54 2015 +0000

    polarssl: patch CVE-2015-1182
    
    Signed-off-by: Jo-Philipp Wich <jow@openwrt.org>
    
    git-svn-id: svn://svn.openwrt.org/openwrt/trunk@44060 3c298f89-4303-0410-b956-a3cf2f4a3e73

diff --git a/package/libs/polarssl/Makefile b/package/libs/polarssl/Makefile
index 18e0f44fe9..384853e29c 100644
--- a/package/libs/polarssl/Makefile
+++ b/package/libs/polarssl/Makefile
@@ -1,5 +1,5 @@
 # 
-# Copyright (C) 2011-2013 OpenWrt.org
+# Copyright (C) 2011-2015 OpenWrt.org
 #
 # This is free software, licensed under the GNU General Public License v2.
 # See /LICENSE for more information.
@@ -9,7 +9,7 @@ include $(TOPDIR)/rules.mk
 
 PKG_NAME:=polarssl
 PKG_VERSION:=1.3.9
-PKG_RELEASE:=1
+PKG_RELEASE:=2
 PKG_USE_MIPS16:=0
 
 PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION)-gpl.tgz
diff --git a/package/libs/polarssl/patches/300-CVE-2015-1182.patch b/package/libs/polarssl/patches/300-CVE-2015-1182.patch
new file mode 100644
index 0000000000..5961d37aa5
--- /dev/null
+++ b/package/libs/polarssl/patches/300-CVE-2015-1182.patch
@@ -0,0 +1,11 @@
+--- a/library/asn1parse.c
++++ b/library/asn1parse.c
+@@ -278,6 +278,8 @@ int asn1_get_sequence_of( unsigned char
+             if( cur->next == NULL )
+                 return( POLARSSL_ERR_ASN1_MALLOC_FAILED );
+ 
++            memset( cur->next, 0, sizeof( asn1_sequence ) );
++
+             cur = cur->next;
+         }
+     }
