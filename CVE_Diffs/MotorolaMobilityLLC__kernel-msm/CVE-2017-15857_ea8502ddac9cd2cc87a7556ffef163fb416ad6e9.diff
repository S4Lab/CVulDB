MotorolaMobilityLLC__kernel-msm
commit ea8502ddac9cd2cc87a7556ffef163fb416ad6e9
Author:     Haibin Liu <haibinl@codeaurora.org>
AuthorDate: Sat Dec 2 02:11:35 2017 +0800
Commit:     PDO SCM Team <hudsoncm@motorola.com>
CommitDate: Wed Jun 27 03:24:19 2018 -0500

    msm: sensor: actuator: check NULL pointer for actuator ctrl
    
    Add NULL pointer checking for actuator ctrl.
    
    Bug-id: A-65122765
    CRs-Fixed: 2152399
    CVE-fixed: CVE-2017-15857
    Mot-CRs-fixed: (CR)
    
    Change-Id: I2e206516e5ea1383c7396625455e1d7403df51cf
    Signed-off-by: Haibin Liu <haibinl@codeaurora.org>
    Signed-off-by: Srikanth A R <arsrikan@motorola.com>
    Reviewed-on: https://gerrit.mot.com/1161536
    SLTApproved: Slta Waiver
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key
    (cherry picked from commit c34e27288146adc7601d13913f871057ad8cc944)
    (cherry picked from commit d3d485d84b5db4681e847d9324e9032e5d40cdfa)

diff --git a/drivers/media/platform/msm/camera_v2/sensor/actuator/msm_actuator.c b/drivers/media/platform/msm/camera_v2/sensor/actuator/msm_actuator.c
index af287f15461f..a64610996000 100644
--- a/drivers/media/platform/msm/camera_v2/sensor/actuator/msm_actuator.c
+++ b/drivers/media/platform/msm/camera_v2/sensor/actuator/msm_actuator.c
@@ -95,13 +95,10 @@ static void msm_actuator_parse_i2c_params(struct msm_actuator_ctrl_t *a_ctrl,
 	struct msm_camera_i2c_reg_array *i2c_tbl = NULL;
 	CDBG("Enter\n");
 
-	if (a_ctrl == NULL) {
-		pr_err("failed. actuator ctrl is NULL");
-		return;
-	}
-
-	if (a_ctrl->i2c_reg_tbl == NULL) {
-		pr_err("failed. i2c reg tabl is NULL");
+	if ((!a_ctrl) ||
+		(!a_ctrl->reg_tbl) ||
+		(!a_ctrl->i2c_reg_tbl)) {
+		pr_err("failed. NULL actuator pointers");
 		return;
 	}
 
diff --git a/drivers/media/platform/msm/camera_v2_2016/sensor/actuator/msm_actuator.c b/drivers/media/platform/msm/camera_v2_2016/sensor/actuator/msm_actuator.c
index 0f3074812056..b1e4c88189d5 100644
--- a/drivers/media/platform/msm/camera_v2_2016/sensor/actuator/msm_actuator.c
+++ b/drivers/media/platform/msm/camera_v2_2016/sensor/actuator/msm_actuator.c
@@ -95,13 +95,10 @@ static void msm_actuator_parse_i2c_params(struct msm_actuator_ctrl_t *a_ctrl,
 	struct msm_camera_i2c_reg_array *i2c_tbl = NULL;
 	CDBG("Enter\n");
 
-	if (a_ctrl == NULL) {
-		pr_err("failed. actuator ctrl is NULL");
-		return;
-	}
-
-	if (a_ctrl->i2c_reg_tbl == NULL) {
-		pr_err("failed. i2c reg tabl is NULL");
+	if ((!a_ctrl) ||
+		(!a_ctrl->reg_tbl) ||
+		(!a_ctrl->i2c_reg_tbl)) {
+		pr_err("failed. NULL actuator pointers");
 		return;
 	}
 
