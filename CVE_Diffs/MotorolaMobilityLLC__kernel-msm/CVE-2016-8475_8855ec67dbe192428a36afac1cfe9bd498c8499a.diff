MotorolaMobilityLLC__kernel-msm
commit 8855ec67dbe192428a36afac1cfe9bd498c8499a
Author:     matt_huang <matt_huang@htc.com>
AuthorDate: Fri Dec 16 14:46:20 2016 +0530
Commit:     lulu2 <lulu2@lenovo.com>
CommitDate: Wed May 16 12:51:55 2018 +0800

    input: misc: fix security vulnerability
    
    initialize the structure before using
    Bug: 32591129
    
    Mot-CRs-fixed: (CR)
    CVE-fixed: CVE-2016-8475
    Change-Id: I9a3af40175d929009522f6c93005d82535c4ccc3
    Signed-off-by: matt_huang <matt_huang@htc.com>
    
    Signed-off-by: Neeraj Kumar <neerajk@motorola.com>
    -----
    
    Change-Id: Ie4b7d517ccb7cf5cf2c6a4ee9624d89558c38b17
    Reviewed-on: https://gerrit.mot.com/932468
    SLTApproved: Slta Waiver <sltawvr@motorola.com>
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key <jirakey@motorola.com>
    Reviewed-by: Vrushali Prakash Bhosale <wkvq37@motorola.com>
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key <jirakey@motorola.com>

diff --git a/drivers/input/misc/vl53L0/stmvl53l0_module.c b/drivers/input/misc/vl53L0/stmvl53l0_module.c
index 383caaefc690..95501d80b9e8 100644
--- a/drivers/input/misc/vl53L0/stmvl53l0_module.c
+++ b/drivers/input/misc/vl53L0/stmvl53l0_module.c
@@ -950,6 +950,8 @@ static void stmvl53l0_enter_sar(struct stmvl53l0_data *data, uint8_t from)
 	if (data->enable_ps_sensor == 0)
 		stmvl53l0_start(data);
 
+	memset(&RMData, 0, sizeof(RMData));
+
 	papi_func_tbl->SetDeviceMode(data,
 		VL53L0_DEVICEMODE_SINGLE_RANGING);
 
@@ -1225,6 +1227,7 @@ struct timeval tv;
 int newv;
 
 do_gettimeofday(&tv);
+memset(&RMData, 0, sizeof(RMData));
 papi_func_tbl->GetRangingMeasurementData(vl53l0_dev, &RMData);
 
 vl53l0_dbgmsg_en("which MODE =%d\n", data->w_mode);
@@ -1455,6 +1458,7 @@ struct device_attribute *attr, const char *buf, size_t count)
 		/* to start */
 		stmvl53l0_start(data);
 	}
+	memset(&RMData, 0, sizeof(RMData));
 	if (VL53L0_DEVICEMODE_SINGLE_RANGING == data->d_mode) {
 		vl53l0_errmsg("Call of VL53L0_DEVICEMODE_SINGLE_RANGING\n");
 		Status = papi_func_tbl->SetGpioConfig(data, 0, 0,
