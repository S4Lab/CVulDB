MotorolaMobilityLLC__kernel-msm
commit 6d18e442ec31c4b65bdbb96910624fcd10dd061a
Author:     Ashwin Pathmudi <jfxr63@motorola.com>
AuthorDate: Mon Jan 30 18:14:00 2017 -0200
Commit:     Marina Silva <mgsilva@motorola.com>
CommitDate: Mon Feb 13 16:33:45 2017 +0000

    fbdev: Validate to->start variable
    
    There is no validation of the to->start variable to check
    if it is negative leading to a potential information
    disclosure. This fix is designed to add additional
    validation to prevent the potential information disclosure.
    
    CVE-Fixed: CVE-2016-8405

diff --git a/drivers/video/fbcmap.c b/drivers/video/fbcmap.c
index f26570d83d14..2a358ae7754a 100644
--- a/drivers/video/fbcmap.c
+++ b/drivers/video/fbcmap.c
@@ -196,7 +196,7 @@ int fb_cmap_to_user(const struct fb_cmap *from, struct fb_cmap_user *to)
 	int tooff = 0, fromoff = 0;
 	int size;
 
-	if (!to || !from)
+	if (!to || !from || (int)(to->start) < 0)
 		return -EINVAL;
 
 	if (to->start > from->start)
