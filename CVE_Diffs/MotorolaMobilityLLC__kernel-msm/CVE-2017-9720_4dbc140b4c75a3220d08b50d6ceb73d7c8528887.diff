MotorolaMobilityLLC__kernel-msm
commit 4dbc140b4c75a3220d08b50d6ceb73d7c8528887
Author:     Fei Zhang <feizhang@codeaurora.org>
AuthorDate: Wed May 17 14:14:54 2017 +0800
Commit:     PDO SCM Team <hudsoncm@motorola.com>
CommitDate: Tue Oct 31 00:43:50 2017 -0500

    msm:camera: correct stats query out of boundary
    
    fix one potential out of boundary query of stats info.
    
    Bug: 36264696
    CRs-Fixed: 2041066
    CVE-fixed: CVE-2017-9720
    Mot-CRs-fixed: (CR)
    
    Change-Id: I13e4bf8802fcce529f9268c272e4727619d5ad8f
    Signed-off-by: Fei Zhang <feizhang@codeaurora.org>
    Signed-off-by: Srikanth A R <arsrikan@motorola.com>
    Reviewed-on: https://gerrit.mot.com/1043255
    SLTApproved: Slta Waiver
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key
    (cherry picked from commit 4d6ad9d90a9f24ff10d1d0d7ce8d4771215a596e)

diff --git a/drivers/media/platform/msm/camera_v2/isp/msm_isp_stats_util.c b/drivers/media/platform/msm/camera_v2/isp/msm_isp_stats_util.c
index b1f7818618ed..e9d44d6476ba 100644
--- a/drivers/media/platform/msm/camera_v2/isp/msm_isp_stats_util.c
+++ b/drivers/media/platform/msm/camera_v2/isp/msm_isp_stats_util.c
@@ -821,7 +821,7 @@ int msm_isp_update_stats_stream(struct vfe_device *vfe_dev, void *arg)
 		update_info = &update_cmd->update_info[i];
 		/*check array reference bounds*/
 		if (STATS_IDX(update_info->stream_handle)
-			> vfe_dev->hw_info->stats_hw_info->num_stats_type) {
+			>= vfe_dev->hw_info->stats_hw_info->num_stats_type) {
 			pr_err("%s: stats idx %d out of bound!", __func__,
 				STATS_IDX(update_info->stream_handle));
 			return -EINVAL;
