MotorolaMobilityLLC__kernel-msm
commit 329b6011177b2fb33520957b9ad2c5bd0bb87ede
Author:     Amarendra Reddy <amarenr@motorola.com>
AuthorDate: Fri Feb 3 10:56:06 2017 -0200
Commit:     Marina Silva <mgsilva@motorola.com>
CommitDate: Wed Feb 15 11:33:07 2017 +0000

    usb: use %pK instead of %p to avoid kernel address leak in u_ctrl_hsic.c
    
    The fix is designed to use %pK instead of %p, which also evaluates
    whether kptr_restrict is set.
    
    Change-Id: Icd845c113b5cf7c8705688f5aa83e252b43aa5a1
    Mot-CRs-fixed:(CR)
    CVE-Fixed:CVE-2016-8404

diff --git a/drivers/usb/gadget/u_ctrl_hsic.c b/drivers/usb/gadget/u_ctrl_hsic.c
index b9536ef08752..c9e7035eb540 100644
--- a/drivers/usb/gadget/u_ctrl_hsic.c
+++ b/drivers/usb/gadget/u_ctrl_hsic.c
@@ -573,7 +573,7 @@ static ssize_t gctrl_read_stats(struct file *file, char __user *ubuf,
 
 		temp += scnprintf(buf + temp, DEBUG_BUF_SIZE - temp,
 				"\nName:        %s\n"
-				"#PORT:%d port: %p\n"
+				"#PORT:%d port: %pK\n"
 				"to_usbhost:    %lu\n"
 				"to_modem:      %lu\n"
 				"cpkt_drp_cnt:  %lu\n"
