MotorolaMobilityLLC__kernel-msm
commit fe286918aa9515e2ba75b12fd184491ece04ec34
Author:     Neeraj Kumar <neerajk@motorola.com>
AuthorDate: Wed Feb 15 15:37:35 2017 -0200
Commit:     Marina Gabriela Silva <mgsilva@motorola.com>
CommitDate: Wed Feb 15 15:37:35 2017 -0200

    misc: qcom: qdsp6v2: initialize params_value
    
    The params_value array is used without initialization potentially
    leading to information disclosure.The fix is designed to initialize
    the params_value array to prevent the potential information disclosure.
    
    Change-Id: Ieb95de5d45b62c34b768aabe345c2c9717632ac1
    Mot-CRs-fixed: (CR)
    CVE-Fixed: CVE-2016-6751

diff --git a/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c b/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c
index e9aba43a632e..6df3b79329b4 100644
--- a/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c
+++ b/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c
@@ -1037,6 +1037,7 @@ static int msm_compr_ioctl_shared(struct snd_pcm_substream *substream,
 			struct snd_dec_ddp *ddp =
 				&compr->info.codec_param.codec.options.ddp;
 			uint32_t params_length = 0;
+			memset(params_value, 0, MAX_AC3_PARAM_SIZE);
 			/* check integer overflow */
 			if (ddp->params_length > UINT_MAX/sizeof(int)) {
 				pr_err("%s: Integer overflow ddp->params_length %d\n",
@@ -1081,6 +1082,7 @@ static int msm_compr_ioctl_shared(struct snd_pcm_substream *substream,
 			struct snd_dec_ddp *ddp =
 				&compr->info.codec_param.codec.options.ddp;
 			uint32_t params_length = 0;
+			memset(params_value, 0, MAX_AC3_PARAM_SIZE);
 			/* check integer overflow */
 			if (ddp->params_length > UINT_MAX/sizeof(int)) {
 				pr_err("%s: Integer overflow ddp->params_length %d\n",
