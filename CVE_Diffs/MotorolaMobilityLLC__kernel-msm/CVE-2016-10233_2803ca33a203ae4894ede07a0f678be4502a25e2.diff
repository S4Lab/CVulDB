MotorolaMobilityLLC__kernel-msm
commit 2803ca33a203ae4894ede07a0f678be4502a25e2
Author:     Trilokesh Rangam <tranga@codeaurora.org>
AuthorDate: Wed Nov 23 09:41:36 2016 +0530
Commit:     a7301c <a7301c@motorola.com>
CommitDate: Sun Apr 15 23:23:35 2018 -0500

    msm-camera: Addressing possible overflow conditions
    
    Changes to address possible integer overflow and incorrect
    array indexing conditions.
    
    Mot-CRs-fixed: (CR)
    CVE-fixed: CVE-2016-10233
    CRs-fixed: 897452
    
    Change-Id: I2f9696ccbc8994d666c30c0c57c274c3bdcf8d91
    Signed-off-by: Trilokesh Rangam <tranga@codeaurora.org>
    Signed-off-by: Srikanth A R <arsrikan@motorola.com>
    Reviewed-on: https://gerrit.mot.com/960358
    SLTApproved: Slta Waiver <sltawvr@motorola.com>
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key <jirakey@motorola.com>
    Reviewed-by: Robert Kubicki <w17311@motorola.com>
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key <jirakey@motorola.com>

diff --git a/drivers/media/platform/msm/camera_v2/common/msm_camera_io_util.c b/drivers/media/platform/msm/camera_v2/common/msm_camera_io_util.c
index d82b2eb602f9..e90c7083a50c 100644
--- a/drivers/media/platform/msm/camera_v2/common/msm_camera_io_util.c
+++ b/drivers/media/platform/msm/camera_v2/common/msm_camera_io_util.c
@@ -509,6 +509,12 @@ int msm_camera_enable_vreg(struct device *dev, struct camera_vreg_t *cam_vreg,
 		pr_err("%s:%d vreg sequence invalid\n", __func__, __LINE__);
 		return -EINVAL;
 	}
+
+	if (cam_vreg == NULL) {
+		pr_err("%s:%d cam_vreg sequence invalid\n", __func__, __LINE__);
+		return -EINVAL;
+	}
+
 	if (!num_vreg_seq)
 		num_vreg_seq = num_vreg;
 
