MotorolaMobilityLLC__kernel-msm
commit 4190eb0262a9d43f2811bb4901e969e424911402
Author:     Dennis Cagle <d-cagle@codeaurora.org>
AuthorDate: Tue Jun 20 12:58:06 2017 +0530
Commit:     PDO SCM Team <hudsoncm@motorola.com>
CommitDate: Mon Sep 4 23:23:21 2017 -0500

    msm: rmnet_ipa: fix security issue
    
    Fix the security issue where mux channel name might
    not be null-terminated in ipa wan driver.
    
    Mot-CRs-fixed: (CR)
    CVE-fixed: CVE-2017-8269
    
    Bug: 33967002
    CRs-Fixed: 2013145
    Change-Id: I3ef440b62cf3861464fb60c1e7f65f2be5e39ed0
    Acked-by: Shihuan Liu <shihuanl@qti.qualcomm.com>
    Signed-off-by: Skylar Chang <chiaweic@codeaurora.org>
    Signed-off-by: Dennis Cagle <d-cagle@codeaurora.org>
    Reviewed-on: https://gerrit.mot.com/1014343
    SLTApproved: Slta Waiver
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key
    (cherry picked from commit 9ec486d5a110b5e92091286ad9cfd64ae6c40a25)

diff --git a/drivers/platform/msm/ipa/rmnet_ipa.c b/drivers/platform/msm/ipa/rmnet_ipa.c
index 373c21fe11ef..e1983d56c1f1 100644
--- a/drivers/platform/msm/ipa/rmnet_ipa.c
+++ b/drivers/platform/msm/ipa/rmnet_ipa.c
@@ -1277,6 +1277,9 @@ static int ipa_wwan_ioctl(struct net_device *dev, struct ifreq *ifr, int cmd)
 			memcpy(mux_channel[rmnet_index].vchannel_name,
 				extend_ioctl_data.u.rmnet_mux_val.vchannel_name,
 				sizeof(mux_channel[rmnet_index].vchannel_name));
+			mux_channel[rmnet_index].vchannel_name[
+				IFNAMSIZ - 1] = '\0';
+
 			IPAWANDBG("cashe device[%s:%d] in IPA_wan[%d]\n",
 				mux_channel[rmnet_index].vchannel_name,
 				mux_channel[rmnet_index].mux_id,
