MotorolaMobilityLLC__kernel-msm
commit 76a3651a6ab6b3bc751114480ae8cd9a94cd98ab
Author:     Venkat Arcot <venkat@motorola.com>
AuthorDate: Tue Aug 23 10:08:42 2016 -0500
Commit:     Venkat Arcot <venkat@motorola.com>
CommitDate: Wed Aug 31 15:58:40 2016 +0000

    CVE-2016-3866 - Elevation of privilege vulnerability in Qualcomm sound driver
    (cherry picked from commit bce7661bb35fb90be000851dbc84419289295438)
    
    Change-Id: Ia7079096b6357601cd604fee325808afd4391059

diff --git a/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c b/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c
index db285ab4ddda..e9aba43a632e 100644
--- a/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c
+++ b/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c
@@ -1,4 +1,4 @@
-/* Copyright (c) 2012-2014, The Linux Foundation. All rights reserved.
+/* Copyright (c) 2012-2014, 2016 The Linux Foundation. All rights reserved.
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License version 2 and
@@ -1087,6 +1087,7 @@ static int msm_compr_ioctl_shared(struct snd_pcm_substream *substream,
 				__func__, ddp->params_length);
 				return -EINVAL;
 			}
+                        params_length = ddp->params_length*sizeof(int);
 			if (params_length > MAX_AC3_PARAM_SIZE) {
 				/*MAX is 36*sizeof(int) this should not happen*/
 				pr_err("%s: params_length(%d) is greater than %zd\n",
