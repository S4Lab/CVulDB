MotorolaMobilityLLC__kernel-msm
commit ecc27f8c86092115b3b376bb70aac2b6aab640f0
Author:     amarenr <amarenr@motorola.com>
AuthorDate: Wed Nov 9 14:15:27 2016 +0530
Commit:     PDO SCM Team <hudsoncm@motorola.com>
CommitDate: Fri Feb 10 02:51:57 2017 -0600

    usb: use %pK instead of %p to avoid kernel address leak in u_ctrl_hsic.c
    
    The fix is designed to use %pK instead of %p, which also evaluates
    whether kptr_restrict is set.
    
    Mot-CRs-fixed:IKSECURITY-1743
    CVE-Fixed:CVE-2016-8404
    
    Change-Id: I035e1b30e9d26b1ea03ff221d7f7ecc10abcbf39
    Signed-off-by: amarenr <amarenr@motorola.com>
    Reviewed-on: https://gerrit.mot.com/918746
    SLTApproved: Slta Waiver <sltawvr@motorola.com>
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key <jirakey@motorola.com>
    Reviewed-by: Vijayakumar Gn <vijaygn@motorola.com>
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key <jirakey@motorola.com>

diff --git a/drivers/usb/gadget/u_ctrl_hsic.c b/drivers/usb/gadget/u_ctrl_hsic.c
index 9ad3e3251828..5b74bc0e3e4c 100644
--- a/drivers/usb/gadget/u_ctrl_hsic.c
+++ b/drivers/usb/gadget/u_ctrl_hsic.c
@@ -574,7 +574,7 @@ static ssize_t gctrl_read_stats(struct file *file, char __user *ubuf,
 
 		temp += scnprintf(buf + temp, DEBUG_BUF_SIZE - temp,
 				"\nName:        %s\n"
-				"#PORT:%d port: %p\n"
+				"#PORT:%d port: %pK\n"
 				"to_usbhost:    %lu\n"
 				"to_modem:      %lu\n"
 				"cpkt_drp_cnt:  %lu\n"
