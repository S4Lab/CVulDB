MotorolaMobilityLLC__kernel-msm
commit 8db1ab97a82e55b74c89581e7e0f0d1e9afb6a68
Author:     Trilokesh Rangam <tranga@codeaurora.org>
AuthorDate: Wed Nov 23 09:41:36 2016 +0530
Commit:     lulu2 <lulu2@lenovo.com>
CommitDate: Wed Jun 6 12:11:34 2018 +0800

    msm-camera: Addressing possible overflow conditions
    
    Changes to address possible integer overflow and incorrect
    array indexing conditions.
    
    Mot-CRs-fixed: (CR)
    CVE-fixed: CVE-2016-10233
    CRs-fixed: 897452
    
    Change-Id: Id90ea34aa9ed7a7490cba82dcb7c1adfea699da5
    Signed-off-by: Trilokesh Rangam <tranga@codeaurora.org>
    Signed-off-by: Srikanth A R <arsrikan@motorola.com>
    Reviewed-on: https://gerrit.mot.com/960369
    SME-Granted: SME Approvals Granted
    SLTApproved: Slta Waiver <sltawvr@motorola.com>
    Tested-by: Jira Key <jirakey@motorola.com>
    Reviewed-by: Robert Kubicki <w17311@motorola.com>
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key <jirakey@motorola.com>

diff --git a/drivers/media/platform/msm/camera_v2_2016/common/msm_camera_io_util.c b/drivers/media/platform/msm/camera_v2_2016/common/msm_camera_io_util.c
index 51a9ea85d1f3..d5b9244dad7e 100644
--- a/drivers/media/platform/msm/camera_v2_2016/common/msm_camera_io_util.c
+++ b/drivers/media/platform/msm/camera_v2_2016/common/msm_camera_io_util.c
@@ -394,6 +394,12 @@ int msm_camera_config_vreg(struct device *dev, struct camera_vreg_t *cam_vreg,
 		pr_err("%s:%d vreg sequence invalid\n", __func__, __LINE__);
 		return -EINVAL;
 	}
+
+	if (cam_vreg == NULL) {
+		pr_err("%s:%d cam_vreg sequence invalid\n", __func__, __LINE__);
+		return -EINVAL;
+	}
+
 	if (!num_vreg_seq)
 		num_vreg_seq = num_vreg;
 
