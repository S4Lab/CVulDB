MotorolaMobilityLLC__kernel-msm
commit 09f07031c088ca2c13f2114bb9a27905496806c5
Author:     rjalagam <rjalagam@motorola.com>
AuthorDate: Thu Aug 10 17:09:02 2017 +0530
Commit:     a7301c <a7301c@motorola.com>
CommitDate: Sun Apr 15 23:23:36 2018 -0500

    msm: ipa: fix security issues in ipa wan driver
    
    Fix the security issue in handling add mux channel event
    in ipa wan driver.
    
    CRs-fixed:2010713
    CVE-fixed: CVE-2017-10999
    Mot-CRs-fixed:(CR)
    
    Change-Id: Iea17d37cb8833579ff53ccab7f625a5a6303c414
    Signed-off-by: Skylar Chang <chiaweic@codeaurora.org>
    Acked-by: Shihuan Liu <shihuanl@qti.qualcomm.com>
    Reviewed-on: https://gerrit.mot.com/1039564
    SME-Granted: SME Approvals Granted
    SLTApproved: Slta Waiver
    Tested-by: Jira Key
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key

diff --git a/drivers/platform/msm/ipa/rmnet_ipa.c b/drivers/platform/msm/ipa/rmnet_ipa.c
index f8153e092b8c..1a81f6eb5ce7 100644
--- a/drivers/platform/msm/ipa/rmnet_ipa.c
+++ b/drivers/platform/msm/ipa/rmnet_ipa.c
@@ -2801,6 +2801,7 @@ static int __init ipa_wwan_init(void)
 	atomic_set(&is_ssr, 0);
 
 	mutex_init(&ipa_to_apps_pipe_handle_guard);
+	mutex_init(&add_mux_channel_lock);
 	ipa_to_apps_hdl = -1;
 	mutex_init(&add_mux_channel_lock);
 
