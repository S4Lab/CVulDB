MotorolaMobilityLLC__kernel-msm
commit c9b1111089a2b8d55361e9d8a659f406bdae0d75
Author:     Siena Richard <sienar@codeaurora.org>
AuthorDate: Fri Sep 15 14:39:19 2017 +0530
Commit:     PDO SCM Team <hudsoncm@motorola.com>
CommitDate: Thu Dec 28 03:00:50 2017 -0600

    ASoC: msm: qdsp6v2: clear address on error
    
    Set address to NULL on error to ensure a stale address is not used.
    
    Change-Id: Ib0f4b942c705b39cb6c565ae79fac3b8709ab2b2
    Mot-CRs-fixed: (CR)
    CVE-fixed: CVE-2017-11016
    CRs-Fixed: 2038685
    Signed-off-by: Siena Richard <sienar@codeaurora.org>
    
    Change-Id: Ib9dea87c8672d3525a929dbaa2213c9b6cee2c02
    Signed-off-by: Neeraj Kumar <neerajk@motorola.com>
    Reviewed-on: https://gerrit.mot.com/1059469
    SME-Granted: SME Approvals Granted
    SLTApproved: Slta Waiver
    Tested-by: Jira Key
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key

diff --git a/sound/soc/msm/qdsp6v2/audio_cal_utils.c b/sound/soc/msm/qdsp6v2/audio_cal_utils.c
index c099a8f00138..21b282029d23 100644
--- a/sound/soc/msm/qdsp6v2/audio_cal_utils.c
+++ b/sound/soc/msm/qdsp6v2/audio_cal_utils.c
@@ -609,7 +609,9 @@ done:
 	return cal_block;
 err:
 	kfree(cal_block->cal_info);
+	cal_block->cal_info = NULL;
 	kfree(cal_block->client_info);
+	cal_block->cal_info = NULL;
 	kfree(cal_block);
 	cal_block = NULL;
 	return cal_block;
