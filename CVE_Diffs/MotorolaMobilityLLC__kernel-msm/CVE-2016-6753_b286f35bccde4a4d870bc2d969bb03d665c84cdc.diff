MotorolaMobilityLLC__kernel-msm
commit b286f35bccde4a4d870bc2d969bb03d665c84cdc
Author:     Vineet Angadi <vineetv@motorola.com>
AuthorDate: Thu Oct 6 15:56:23 2016 +0530
Commit:     a7301c <a7301c@motorola.com>
CommitDate: Wed Nov 2 14:34:04 2016 -0500

    cgroup: fix possible leak in kernel addresses when using %p
    
    The format specifier %p can leak kernel addresses while not valuing the
    kptr_restrict system settings.The fix is designed to use %pK instead of %p, which also evaluates whether kptr_restrict is set.
    
    Mot-CRs-fixed: IKSECURITY-1624
    CVE-Fixed: CVE-2016-6753
    
    Change-Id: Iaef4024eb25a5c630c929b086261f21b7439219e
    Signed-off-by: Vineet Angadi V <vineetv@motorola.com>
    Reviewed-on: https://gerrit.mot.com/906561
    SLTApproved: Slta Waiver <sltawvr@motorola.com>
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key <jirakey@motorola.com>
    Reviewed-by: Vijayakumar Gn <vijaygn@motorola.com>
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key <jirakey@motorola.com>
    (cherry picked from commit 0de0417588f431e0cac60a616217c4bca99d6285)
    Reviewed-on: https://gerrit.mot.com/908987

diff --git a/kernel/cgroup.c b/kernel/cgroup.c
index bf2543b6f341..359a50e63e1e 100644
--- a/kernel/cgroup.c
+++ b/kernel/cgroup.c
@@ -5566,7 +5566,7 @@ static int cgroup_css_links_read(struct seq_file *seq, void *v)
 		struct task_struct *task;
 		int count = 0;
 
-		seq_printf(seq, "css_set %p\n", cset);
+		seq_printf(seq, "css_set %pK\n", cset);
 
 		list_for_each_entry(task, &cset->tasks, cg_list) {
 			if (count++ > MAX_TASKS_SHOWN_PER_CSS)
