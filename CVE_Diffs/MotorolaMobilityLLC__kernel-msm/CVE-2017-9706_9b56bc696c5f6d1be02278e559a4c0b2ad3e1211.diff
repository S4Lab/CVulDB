MotorolaMobilityLLC__kernel-msm
commit 9b56bc696c5f6d1be02278e559a4c0b2ad3e1211
Author:     Bharath Gopal <gopalb@codeaurora.org>
AuthorDate: Mon May 15 17:30:23 2017 +0530
Commit:     PDO SCM Team <hudsoncm@motorola.com>
CommitDate: Mon Oct 23 08:18:03 2017 -0500

    msm: mdss: Buffer overflow while processing gamut table data
    
    Modified the size of the gamut table data-structure in order to
    avoid a buffer overflow while copying data from user-space.
    
    Mot-CRs-fixed: (CR)
    CVE-Fixed: CVE-2017-9706
    
    Change-Id: I8c5fa1caff450a2d25d7859bd159ab4a60045e54
    Signed-off-by: Bharath Gopal <gopalb@codeaurora.org>
    Signed-off-by: Ashwin Pathmudi <jfxr63@motorola.com>
    Reviewed-on: https://gerrit.mot.com/1062591
    SLTApproved: Slta Waiver
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key
    Reviewed-by: Bang Nguyen <bangnguyen@motorola.com>
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key

diff --git a/drivers/video/msm/mdss/mdss_mdp_pp.h b/drivers/video/msm/mdss/mdss_mdp_pp.h
index adb4160f046e..6604d6ba946c 100644
--- a/drivers/video/msm/mdss/mdss_mdp_pp.h
+++ b/drivers/video/msm/mdss/mdss_mdp_pp.h
@@ -1,5 +1,5 @@
 /*
- * Copyright (c) 2014-2016, The Linux Foundation. All rights reserved.
+ * Copyright (c) 2014-2015, 2017, The Linux Foundation. All rights reserved.
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License version 2 and
@@ -153,7 +153,7 @@ struct mdss_pp_res_type {
 	struct mdp_hist_lut_data enhist_disp_cfg[MDSS_BLOCK_DISP_NUM];
 	struct mdp_dither_cfg_data dither_disp_cfg[MDSS_BLOCK_DISP_NUM];
 	struct mdp_gamut_cfg_data gamut_disp_cfg[MDSS_BLOCK_DISP_NUM];
-	uint16_t gamut_tbl[MDSS_BLOCK_DISP_NUM][GAMUT_TOTAL_TABLE_SIZE];
+	uint16_t gamut_tbl[MDSS_BLOCK_DISP_NUM][GAMUT_TOTAL_TABLE_SIZE * 3];
 	u32 hist_data[MDSS_BLOCK_DISP_NUM][HIST_V_SIZE];
 	struct pp_sts_type pp_disp_sts[MDSS_BLOCK_DISP_NUM];
 	/* physical info */
