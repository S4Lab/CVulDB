MotorolaMobilityLLC__kernel-msm
commit 7f3367eee5505e8387a891dab79eeb69f2a40dcb
Author:     Nick Desaulniers <ndesaulniers@google.com>
AuthorDate: Mon Apr 10 14:58:23 2017 +0530
Commit:     PDO SCM Team <hudsoncm@motorola.com>
CommitDate: Mon Jun 5 04:08:56 2017 -0500

    tracing: do not leak kernel addresses
    
    This likely breaks tracing tools like trace-cmd.  It logs in the same
    format but now addresses are all 0x0.
    
    Mot-CRs-fixed:(CR)
    CVE-Fixed:CVE-2017-0630
    Bug: 34277115
    Change-Id: Ifb0d4d2a184bf0d95726de05b1acee0287a375d9
    Signed-off-by: Amarendra Reddy <amarenr@motorola.com>
    Reviewed-on: https://gerrit.mot.com/977315
    SME-Granted: SME Approvals Granted
    SLTApproved: Slta Waiver <sltawvr@motorola.com>
    Tested-by: Jira Key <jirakey@motorola.com>
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key <jirakey@motorola.com>
    (cherry picked from commit 1280d9d6fd8d959bac9a880dc44bc45e0477dc17)

diff --git a/kernel/trace/trace_printk.c b/kernel/trace/trace_printk.c
index a9077c1b4ad3..d492b1b5e87a 100644
--- a/kernel/trace/trace_printk.c
+++ b/kernel/trace/trace_printk.c
@@ -272,7 +272,7 @@ static int t_show(struct seq_file *m, void *v)
 	const char *str = *fmt;
 	int i;
 
-	seq_printf(m, "0x%lx : \"", *(unsigned long *)fmt);
+	seq_printf(m, "0x%lx : \"", 0L);
 
 	/*
 	 * Tabs and new lines need to be converted.
