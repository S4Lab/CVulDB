MotorolaMobilityLLC__kernel-msm
commit 5f3e9da02b0526b76390f479e9e903f2ef3d2c8e
Author:     amarenr <amarenr@motorola.com>
AuthorDate: Wed Nov 9 13:08:31 2016 +0530
Commit:     a7301c <a7301c@motorola.com>
CommitDate: Sun Apr 15 23:23:34 2018 -0500

    usb: use %pK instead of %p to avoid kernel address leak in u_data_hsic.c
    
    The fix is designed to use %pK instead of %p, which also evaluates
    whether kptr_restrict is set.
    
    Mot-CRs-fixed:(CR)
    CVE-Fixed:CVE-2016-8403
    
    Change-Id: I18ca3e70e36176349fb9884b5055043836217385
    Signed-off-by: amarenr <amarenr@motorola.com>
    Reviewed-on: https://gerrit.mot.com/918745
    SLTApproved: Slta Waiver <sltawvr@motorola.com>
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key <jirakey@motorola.com>
    Reviewed-by: Vijayakumar Gn <vijaygn@motorola.com>
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key <jirakey@motorola.com>

diff --git a/drivers/usb/gadget/u_data_hsic.c b/drivers/usb/gadget/u_data_hsic.c
index c02c798a82ae..2dccf37c949f 100644
--- a/drivers/usb/gadget/u_data_hsic.c
+++ b/drivers/usb/gadget/u_data_hsic.c
@@ -538,7 +538,9 @@ static void ghsic_data_connect_w(struct work_struct *w)
 	struct gdata_port	*port =
 		container_of(w, struct gdata_port, connect_w);
 	int			ret;
-
+	printk("%s: connected=%d, CH_READY=%d, port=%pK\n",
+		__func__, atomic_read(&port->connected),
+		test_bit(CH_READY, &port->bridge_sts), port);
 	if (!port || !atomic_read(&port->connected) ||
 		!test_bit(CH_READY, &port->bridge_sts))
 		return;
@@ -740,6 +742,8 @@ static int ghsic_data_port_alloc(unsigned port_num, enum gadget_type gtype)
 	pdrv->driver.owner = THIS_MODULE;
 
 	platform_driver_register(pdrv);
+	pr_debug("%s: port:%pK portno:%d\n", __func__, port, port_num);
+
 	return 0;
 }
 
