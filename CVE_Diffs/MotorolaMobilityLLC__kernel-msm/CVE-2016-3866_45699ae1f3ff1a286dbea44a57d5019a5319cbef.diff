MotorolaMobilityLLC__kernel-msm
commit 45699ae1f3ff1a286dbea44a57d5019a5319cbef
Author:     Venkat Arcot <venkat@motorola.com>
AuthorDate: Tue Aug 23 10:08:42 2016 -0500
Commit:     Venkat Arcot <venkat@motorola.com>
CommitDate: Mon Aug 29 21:13:27 2016 +0000

    CVE-2016-3866 - Elevation of privilege vulnerability in Qualcomm sound driver

diff --git a/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c b/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c
index db285ab4ddda..e9aba43a632e 100644
--- a/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c
+++ b/sound/soc/msm/qdsp6v2/msm-compr-q6-v2.c
@@ -1,4 +1,4 @@
-/* Copyright (c) 2012-2014, The Linux Foundation. All rights reserved.
+/* Copyright (c) 2012-2014, 2016 The Linux Foundation. All rights reserved.
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License version 2 and
@@ -1087,6 +1087,7 @@ static int msm_compr_ioctl_shared(struct snd_pcm_substream *substream,
 				__func__, ddp->params_length);
 				return -EINVAL;
 			}
+                        params_length = ddp->params_length*sizeof(int);
 			if (params_length > MAX_AC3_PARAM_SIZE) {
 				/*MAX is 36*sizeof(int) this should not happen*/
 				pr_err("%s: params_length(%d) is greater than %zd\n",
