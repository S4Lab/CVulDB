MotorolaMobilityLLC__kernel-msm
commit 6f7c91142af51aced3d7be2a0e721f62b126fe38
Author:     Ashwin Pathmudi <jfxr63@motorola.com>
AuthorDate: Tue Nov 15 17:43:25 2016 +0530
Commit:     a7301c <a7301c@motorola.com>
CommitDate: Mon Nov 21 09:47:22 2016 -0600

    msm: mdss: Replace %p by %pK
    
    for printing kernel pointers that need to be hidden
    from unprivileged users we use %pK instead of %p which
    checks if kptr_restrict is  set
    
    CVE-Fixed: CVE-2016-6757
    
    Change-Id: I2a055e12384fe67a659046089f476788e7eb9344
    Signed-off-by: Ashwin Pathmudi <jfxr63@motorola.com>
    Reviewed-on: https://gerrit.mot.com/921277
    SME-Granted: SME Approvals Granted
    SLTApproved: Slta Waiver <sltawvr@motorola.com>
    Tested-by: Jira Key <jirakey@motorola.com>
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key <jirakey@motorola.com>

diff --git a/drivers/video/msm/mdss/mdss_quickdraw.c b/drivers/video/msm/mdss/mdss_quickdraw.c
index 0ce0fdfb56c8..81b58dcec900 100644
--- a/drivers/video/msm/mdss/mdss_quickdraw.c
+++ b/drivers/video/msm/mdss/mdss_quickdraw.c
@@ -31,7 +31,7 @@ static int set_overlay(struct msm_fb_data_type *mfd,
 	int ret;
 	struct mdp_overlay overlay;
 
-	pr_debug("%s+: (buffer: %p)\n", __func__, buffer);
+	pr_debug("%s+: (buffer: %pK)\n", __func__, buffer);
 
 	if (!buffer) {
 		pr_err("%s: buffer is NULL\n", __func__);
@@ -69,7 +69,7 @@ static int set_overlay(struct msm_fb_data_type *mfd,
 	overlay_id = overlay.id;
 
 exit:
-	pr_debug("%s-: (buffer: %p) (ret: %d)\n", __func__, buffer,
+	pr_debug("%s-: (buffer: %pK) (ret: %d)\n", __func__, buffer,
 		ret);
 
 	return ret;
@@ -101,7 +101,7 @@ static int play_overlay(struct msm_fb_data_type *mfd,
 	int ret = -EINVAL;
 	struct msmfb_overlay_data ovdata;
 
-	pr_debug("%s+: (buffer: %p)\n", __func__, buffer);
+	pr_debug("%s+: (buffer: %pK)\n", __func__, buffer);
 
 	if (!buffer) {
 		pr_err("%s: buffer is NULL\n", __func__);
@@ -122,7 +122,7 @@ static int play_overlay(struct msm_fb_data_type *mfd,
 	ret = mdss_mdp_overlay_play(mfd, &ovdata);
 
 exit:
-	pr_debug("%s-: (buffer: %p) (ret: %d)\n", __func__, buffer,
+	pr_debug("%s-: (buffer: %pK) (ret: %d)\n", __func__, buffer,
 		ret);
 
 	return ret;
