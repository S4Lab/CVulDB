mohamed-anwar__os
commit 1d7ec4d7fac90de8af28655a017b1b1ab5d0b24a
Author:     glebius <glebius@FreeBSD.org>
AuthorDate: Tue May 17 22:28:42 2016 +0000
Commit:     glebius <glebius@FreeBSD.org>
CommitDate: Tue May 17 22:28:42 2016 +0000

    Use unsigned version of min() when handling arguments of SETFKEY ioctl.
    
    Submitted by:   C Turt <cturt hardenedbsd.org>
    Security:       SA-16:18
    Security:       CVE-2016-1886

diff --git a/sys/dev/kbd/kbd.c b/sys/dev/kbd/kbd.c
index 389ef7575bb..6a386088ff1 100644
--- a/sys/dev/kbd/kbd.c
+++ b/sys/dev/kbd/kbd.c
@@ -996,7 +996,7 @@ genkbd_commonioctl(keyboard_t *kbd, u_long cmd, caddr_t arg)
 			splx(s);
 			return (error);
 		}
-		kbd->kb_fkeytab[fkeyp->keynum].len = imin(fkeyp->flen, MAXFK);
+		kbd->kb_fkeytab[fkeyp->keynum].len = min(fkeyp->flen, MAXFK);
 		bcopy(fkeyp->keydef, kbd->kb_fkeytab[fkeyp->keynum].str,
 		    kbd->kb_fkeytab[fkeyp->keynum].len);
 		break;
