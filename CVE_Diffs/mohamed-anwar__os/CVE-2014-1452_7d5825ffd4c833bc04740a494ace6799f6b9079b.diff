mohamed-anwar__os
commit 7d5825ffd4c833bc04740a494ace6799f6b9079b
Author:     delphij <delphij@FreeBSD.org>
AuthorDate: Tue Jan 14 18:58:57 2014 +0000
Commit:     delphij <delphij@FreeBSD.org>
CommitDate: Tue Jan 14 18:58:57 2014 +0000

    Fix bsnmpd remote denial of service vulnerability.
    
    Reported by:    dinoex
    Submitted by:   harti
    Security:       FreeBSD-SA-14:01.bsnmpd
    Security:       CVE-2014-1452

diff --git a/contrib/bsnmp/lib/snmpagent.c b/contrib/bsnmp/lib/snmpagent.c
index e2aa2647dd4..a425c376d62 100644
--- a/contrib/bsnmp/lib/snmpagent.c
+++ b/contrib/bsnmp/lib/snmpagent.c
@@ -510,6 +510,11 @@ snmp_getbulk(struct snmp_pdu *pdu, struct asn_buf *resp_b,
 	for (cnt = 0; cnt < pdu->error_index; cnt++) {
 		eomib = 1;
 		for (i = non_rep; i < pdu->nbindings; i++) {
+
+			if (resp->nbindings == SNMP_MAX_BINDINGS)
+				/* PDU is full */
+				goto done;
+
 			if (cnt == 0) 
 				result = do_getnext(&context, &pdu->bindings[i],
 				    &resp->bindings[resp->nbindings], pdu);
