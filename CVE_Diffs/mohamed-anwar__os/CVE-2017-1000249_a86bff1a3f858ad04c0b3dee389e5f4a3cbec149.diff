mohamed-anwar__os
commit a86bff1a3f858ad04c0b3dee389e5f4a3cbec149
Author:     gordon <gordon@FreeBSD.org>
AuthorDate: Thu Sep 7 19:23:08 2017 +0000
Commit:     gordon <gordon@FreeBSD.org>
CommitDate: Thu Sep 7 19:23:08 2017 +0000

    MFC r323278: Fix an incorrectly used conditional causing buffer overflow.
    
    Reported by:    Thomas Jarosch of Intra2net AG
    Reviewed by:    emaste, jhb
    Approved by:    re (marius)
    Security:       CVE-2017-1000249

diff --git a/contrib/file/src/readelf.c b/contrib/file/src/readelf.c
index 90dae392f69..f3212871d62 100644
--- a/contrib/file/src/readelf.c
+++ b/contrib/file/src/readelf.c
@@ -509,7 +509,7 @@ do_bid_note(struct magic_set *ms, unsigned char *nbuf, uint32_t type,
     size_t noff, size_t doff, int *flags)
 {
 	if (namesz == 4 && strcmp((char *)&nbuf[noff], "GNU") == 0 &&
-	    type == NT_GNU_BUILD_ID && (descsz >= 4 || descsz <= 20)) {
+	    type == NT_GNU_BUILD_ID && (descsz >= 4 && descsz <= 20)) {
 		uint8_t desc[20];
 		const char *btype;
 		uint32_t i;
