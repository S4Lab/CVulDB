mohamed-anwar__os
commit 2f6a20e2cac3e778fbb0861a358511c49298db94
Author:     delphij <delphij@FreeBSD.org>
AuthorDate: Thu Dec 10 21:23:46 2009 +0000
Commit:     delphij <delphij@FreeBSD.org>
CommitDate: Thu Dec 10 21:23:46 2009 +0000

    Correct a DoS issue when processing XML document with malformed
    UTF-8 sequences.
    
    Obtained from:  expat CVS (revisions 1.14 and 1.15)
    Security:       CVE-2009-3560

diff --git a/lib/xmltok_impl.c b/lib/xmltok_impl.c
index 12688192522..16dfb85f031 100644
--- a/lib/xmltok_impl.c
+++ b/lib/xmltok_impl.c
@@ -1744,7 +1744,7 @@ PREFIX(updatePosition)(const ENCODING *enc,
                        const char *end,
                        POSITION *pos)
 {
-  while (ptr != end) {
+  while (ptr < end) {
     switch (BYTE_TYPE(enc, ptr)) {
 #define LEAD_CASE(n) \
     case BT_LEAD ## n: \
