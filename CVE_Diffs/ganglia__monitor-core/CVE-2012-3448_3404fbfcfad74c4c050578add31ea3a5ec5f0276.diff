ganglia__monitor-core
commit 3404fbfcfad74c4c050578add31ea3a5ec5f0276
Author:     Kostas Georgiou <georgiou@opengamma.com>
AuthorDate: Tue Aug 14 14:12:06 2012 +0100
Commit:     Daniel Pocock <daniel@pocock.com.au>
CommitDate: Wed Aug 15 18:37:52 2012 +0200

    [CVE-2012-3448] Backporting fix for arbitrary PHP code execution

diff --git a/web/graph.php b/web/graph.php
index cbeaeeef..cb5c2f76 100644
--- a/web/graph.php
+++ b/web/graph.php
@@ -122,7 +122,7 @@ if (!$graph) {
 
 $graph_file = "$graphdir/$graph.php";
 
-if ( is_readable($graph_file) ) {
+if ( is_readable($graph_file) and realpath($graphdir) === dirname(realpath($graph_file)) ) {
     include_once($graph_file);
 
     $graph_function = "graph_${graph}";
