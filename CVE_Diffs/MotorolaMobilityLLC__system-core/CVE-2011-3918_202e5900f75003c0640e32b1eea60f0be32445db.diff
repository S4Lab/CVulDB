MotorolaMobilityLLC__system-core
commit 202e5900f75003c0640e32b1eea60f0be32445db
Author:     Nick Kralevich <nnk@google.com>
AuthorDate: Fri Jan 27 13:06:53 2012 -0800
Commit:     Nick Kralevich <nnk@google.com>
CommitDate: Fri Jan 27 13:06:53 2012 -0800

    Restrict zygote to system user.
    
    CVE-2011-3918: Address denial of service attack against Android's
    zygote process. This change enforces that only UID=system can
    directly connect to zygote to spawn processes.
    
    Change-Id: I89f5f05fa44ba8582920b66854df3e79527ae067

diff --git a/rootdir/init.rc b/rootdir/init.rc
index b9f111e28..729951369 100644
--- a/rootdir/init.rc
+++ b/rootdir/init.rc
@@ -417,7 +417,7 @@ service surfaceflinger /system/bin/surfaceflinger
 
 service zygote /system/bin/app_process -Xzygote /system/bin --zygote --start-system-server
     class main
-    socket zygote stream 666
+    socket zygote stream 660 root system
     onrestart write /sys/android_power/request_state wake
     onrestart write /sys/power/state on
     onrestart restart media
