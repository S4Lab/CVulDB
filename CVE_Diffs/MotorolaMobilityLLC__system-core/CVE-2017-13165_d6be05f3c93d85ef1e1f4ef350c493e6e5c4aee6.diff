MotorolaMobilityLLC__system-core
commit d6be05f3c93d85ef1e1f4ef350c493e6e5c4aee6
Author:     Nick Kralevich <nnk@google.com>
AuthorDate: Fri Aug 25 12:55:52 2017 -0700
Commit:     PDO SCM Team <hudsoncm@motorola.com>
CommitDate: Thu Dec 28 03:01:16 2017 -0600

    init.rc: Lock down access to /proc/net/fib_trie
    
    Make /proc/net/fib_trie only readable to root.
    
    Mot-CRs-fixed: (CR)
    CVE-fixed: CVE-2017-13165
    Bug: 31269937
    
    Test: Device boots, file has appropriate permissions.
    Change-Id: I0d01ce5c043d576344a6732b0b9ff93d62fcaa34
    Reviewed-on: https://gerrit.mot.com/1090052
    SLTApproved: Slta Waiver
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key

diff --git a/rootdir/init.rc b/rootdir/init.rc
index be85f3371..1baabd56e 100755
--- a/rootdir/init.rc
+++ b/rootdir/init.rc
@@ -130,6 +130,9 @@ on init
     write /proc/sys/net/ipv4/conf/all/accept_redirects 0
     write /proc/sys/net/ipv6/conf/all/accept_redirects 0
 
+    # /proc/net/fib_trie leaks interface IP addresses
+    chmod 0400 /proc/net/fib_trie
+
     # Create cgroup mount points for process groups
     mkdir /dev/cpuctl
     mount cgroup none /dev/cpuctl cpu
