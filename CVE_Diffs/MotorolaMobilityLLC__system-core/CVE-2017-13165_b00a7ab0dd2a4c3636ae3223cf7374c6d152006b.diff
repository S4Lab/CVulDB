MotorolaMobilityLLC__system-core
commit b00a7ab0dd2a4c3636ae3223cf7374c6d152006b
Author:     Nick Kralevich <nnk@google.com>
AuthorDate: Fri Aug 25 12:55:52 2017 -0700
Commit:     PDO SCM Team <hudsoncm@motorola.com>
CommitDate: Thu Dec 21 22:18:11 2017 -0600

    init.rc: Lock down access to /proc/net/fib_trie
    
    Make /proc/net/fib_trie only readable to root.
    
    Mot-CRs-fixed: (CR)
    CVE-fixed: CVE-2017-13165
    Bug: 31269937
    
    Test: Device boots, file has appropriate permissions.
    Change-Id: I0d01ce5c043d576344a6732b0b9ff93d62fcaa34
    Reviewed-on: https://gerrit.mot.com/1089946
    SLTApproved: Slta Waiver
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key

diff --git a/rootdir/init.rc b/rootdir/init.rc
index 9ad3b230c..4e247613a 100755
--- a/rootdir/init.rc
+++ b/rootdir/init.rc
@@ -137,6 +137,9 @@ on init
     write /proc/sys/net/ipv4/conf/all/accept_redirects 0
     write /proc/sys/net/ipv6/conf/all/accept_redirects 0
 
+    # /proc/net/fib_trie leaks interface IP addresses
+    chmod 0400 /proc/net/fib_trie
+
     # Create cgroup mount points for process groups
     mkdir /dev/cpuctl
     mount cgroup none /dev/cpuctl cpu
