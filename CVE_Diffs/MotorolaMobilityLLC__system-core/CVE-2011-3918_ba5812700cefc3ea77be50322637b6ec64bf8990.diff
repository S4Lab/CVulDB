MotorolaMobilityLLC__system-core
commit ba5812700cefc3ea77be50322637b6ec64bf8990
Author:     Nick Kralevich <nnk@google.com>
AuthorDate: Fri Jan 27 13:06:53 2012 -0800
Commit:     Nick Kralevich <nnk@google.com>
CommitDate: Fri Apr 27 14:18:02 2012 -0700

    Restrict zygote to system user.
    
    CVE-2011-3918: Address denial of service attack against Android's
    zygote process. This change enforces that only UID=system can
    directly connect to zygote to spawn processes.
    
    Change-Id: I89f5f05fa44ba8582920b66854df3e79527ae067

diff --git a/rootdir/init.rc b/rootdir/init.rc
index 28cd26cba..236c97b18 100644
--- a/rootdir/init.rc
+++ b/rootdir/init.rc
@@ -414,7 +414,7 @@ service surfaceflinger /system/bin/surfaceflinger
 
 service zygote /system/bin/app_process -Xzygote /system/bin --zygote --start-system-server
     class main
-    socket zygote stream 666
+    socket zygote stream 660 root system
     onrestart write /sys/android_power/request_state wake
     onrestart write /sys/power/state on
     onrestart restart media
