MotorolaMobilityLLC__system-core
commit 03ac92f2fbb0c233f55e014eaf8e2db80ed7a2fb
Author:     Nick Kralevich <nnk@google.com>
AuthorDate: Fri Aug 25 12:55:52 2017 -0700
Commit:     chenyt9 <chenyt9@lenovo.com>
CommitDate: Fri Apr 20 13:42:59 2018 +0800

    init.rc: Lock down access to /proc/net/fib_trie
    
    Make /proc/net/fib_trie only readable to root.
    
    Mot-CRs-fixed: (CR)
    CVE-fixed: CVE-2017-13165
    Bug: 31269937
    
    Test: Device boots, file has appropriate permissions.
    Change-Id: I0d01ce5c043d576344a6732b0b9ff93d62fcaa34
    Reviewed-on: https://gerrit.mot.com/1089946
    SLTApproved: Slta Waiver
    SME-Granted: SME Approvals Granted
    Tested-by: Jira Key
    Reviewed-by: Igor Kovalenko <igork@motorola.com>
    Submit-Approved: Jira Key
    (cherry picked from commit 1f258437d93da67eb9663fede69a38e576c89775)

diff --git a/rootdir/init.rc b/rootdir/init.rc
index f5751c26e..fc71ed5eb 100755
--- a/rootdir/init.rc
+++ b/rootdir/init.rc
@@ -126,6 +126,9 @@ on init
     write /proc/sys/net/ipv4/conf/all/accept_redirects 0
     write /proc/sys/net/ipv6/conf/all/accept_redirects 0
 
+    # /proc/net/fib_trie leaks interface IP addresses
+    chmod 0400 /proc/net/fib_trie
+
     # Create cgroup mount points for process groups
     mkdir /dev/cpuctl
     mount cgroup none /dev/cpuctl cpu
