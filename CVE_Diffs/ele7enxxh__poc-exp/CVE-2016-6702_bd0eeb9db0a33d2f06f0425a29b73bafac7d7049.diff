ele7enxxh__poc-exp
commit bd0eeb9db0a33d2f06f0425a29b73bafac7d7049
Author:     ele7enxxh <ele7enxxh@qq.com>
AuthorDate: Thu Dec 15 16:36:38 2016 +0800
Commit:     ele7enxxh <ele7enxxh@qq.com>
CommitDate: Thu Dec 15 16:36:38 2016 +0800

    poc for CVE-2016-6702

diff --git a/CVE-2016-6702/CVE-2016-6702 b/CVE-2016-6702/CVE-2016-6702
new file mode 100644
index 0000000..dd2fb16
Binary files /dev/null and b/CVE-2016-6702/CVE-2016-6702 differ
diff --git a/CVE-2016-6702/README.md b/CVE-2016-6702/README.md
new file mode 100644
index 0000000..a381fa2
--- /dev/null
+++ b/CVE-2016-6702/README.md
@@ -0,0 +1,21 @@
+## Description
+
+A remote code execution vulnerability in libjpeg(the affected version is 4.4.4, 5.0.2, 5.1.1). It could occur while decompressing a specially crafted file.
+
+http://androidxref.com/5.1.1_r6/xref/external/jpeg/jmemmgr.c#648
+http://androidxref.com/5.1.1_r6/xref/external/jpeg/jmemmgr.c#672
+```cpp
+GLOBAL(void)
+jpeg_open_backing_store (j_common_ptr cinfo, backing_store_ptr info,
+	long total_bytes_needed);
+
+jpeg_open_backing_store(cinfo, & bptr->b_s_info,
+	(long) bptr->rows_in_array *
+	(long) bptr->blocksperrow *
+	(long) SIZEOF(JBLOCK));
+```
+This function uses ashmem to get a shared memory of total\_bytes\_needed,  by controling the value of bptr->rows\_in\_array and bptr->samplesperrow, the size can greater than 2^32 and suddenly integer overflow occur.
+
+## Poc
+
+djpeg -color 256 CVE-2016-6702
