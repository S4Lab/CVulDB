liquidware__liquidware_beagleboard_linux
commit 9a936a2e0526089194159eae31238e36b1c19e74
Author:     Olof Johansson <olof@lixom.net>
AuthorDate: Sun Aug 6 20:51:25 2006 -0500
Commit:     Paul Mackerras <paulus@samba.org>
CommitDate: Fri Aug 18 07:23:29 2006 +1000

    [POWERPC] powerpc: Clear HID0 attention enable on PPC970 at boot time
    
    Clear HID0[en_attn] at CPU init time on PPC970.  Closes CVE-2006-4093.
    
    Signed-off-by: Olof Johansson <olof@lixom.net>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

diff --git a/arch/powerpc/kernel/cpu_setup_power4.S b/arch/powerpc/kernel/cpu_setup_power4.S
index f69af2c5d7b..76e97aa71c4 100644
--- a/arch/powerpc/kernel/cpu_setup_power4.S
+++ b/arch/powerpc/kernel/cpu_setup_power4.S
@@ -76,6 +76,8 @@ _GLOBAL(__setup_cpu_ppc970)
 	mfspr	r0,SPRN_HID0
 	li	r11,5			/* clear DOZE and SLEEP */
 	rldimi	r0,r11,52,8		/* set NAP and DPM */
+	li	r11,0
+	rldimi	r0,r11,32,31		/* clear EN_ATTN */
 	mtspr	SPRN_HID0,r0
 	mfspr	r0,SPRN_HID0
 	mfspr	r0,SPRN_HID0
