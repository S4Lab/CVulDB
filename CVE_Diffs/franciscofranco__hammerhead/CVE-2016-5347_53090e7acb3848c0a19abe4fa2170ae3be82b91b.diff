franciscofranco__hammerhead
commit 53090e7acb3848c0a19abe4fa2170ae3be82b91b
Author:     Xiaojun Sang <xsang@codeaurora.org>
AuthorDate: Fri Dec 16 16:25:27 2016 +0800
Commit:     Francisco Franco <franciscofranco.1990@gmail.com>
CommitDate: Wed Jul 5 17:29:54 2017 +0000

    ASoC: soc: msm: initialize buffer to prevent kernel data leakage
    
    To prevent potential kernel stack data leakage, initialize
    channel_map[].
    
    CRs-Fixed: 1100878
    CAF-Change-Id: I7b81cea20485bc7514551672bb54c7fd455049e3
    Signed-off-by: Xiaojun Sang <xsang@codeaurora.org>
    CVE-2016-5347
    [haggertk]: Backport to 3.4/msm8974
     * Same logic in our msm-pcm-routing-v2.c as opposed to original
       msm-qti-pp-config.c
    
    Change-Id: Iea0b630d1785e03d16da2d4f651846ab06d73e23
    Signed-off-by: Francisco Franco <franciscofranco.1990@gmail.com>

diff --git a/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c b/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c
index 8639bed87ba..220a36a315c 100644
--- a/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c
+++ b/sound/soc/msm/qdsp6v2/msm-pcm-routing-v2.c
@@ -1063,7 +1063,7 @@ static int msm_routing_set_multimedia2_vol_mixer(struct snd_kcontrol *kcontrol,
 static int msm_routing_get_channel_map_mixer(struct snd_kcontrol *kcontrol,
 					struct snd_ctl_elem_value *ucontrol)
 {
-	char channel_map[PCM_FORMAT_MAX_NUM_CHANNEL];
+	char channel_map[PCM_FORMAT_MAX_NUM_CHANNEL] = {0};
 	int i;
 
 	adm_get_multi_ch_map(channel_map);
