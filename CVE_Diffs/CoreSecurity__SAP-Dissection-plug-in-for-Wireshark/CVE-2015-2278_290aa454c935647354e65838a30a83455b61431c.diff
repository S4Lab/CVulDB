CoreSecurity__SAP-Dissection-plug-in-for-Wireshark
commit 290aa454c935647354e65838a30a83455b61431c
Author:     Martin Gallo <mgallo@coresecurity.com>
AuthorDate: Fri Sep 18 16:13:44 2015 -0300
Commit:     Martin Gallo <mgallo@coresecurity.com>
CommitDate: Fri Sep 18 16:13:44 2015 -0300

    Initialize v array
    
    As pointed by https://github.com/ret5et on https://github.com/CoreSecurity/pysap/pull/4, fix for `CVE-2015-2278` didn't address the issue that the array `p` was pointing to was uninitialized. This fixes it by zeroing all arrays the function declares.

diff --git a/src/vpa108csulzh.cpp b/src/vpa108csulzh.cpp
index d2fe3b4..0bf932c 100644
--- a/src/vpa108csulzh.cpp
+++ b/src/vpa108csulzh.cpp
@@ -213,6 +213,10 @@ int CsObjectInt::BuildHufTree (
 
   /* Generate counts for each bit length .............................*/
   memset(c, 0, sizeof(c));
+  memset(u, 0, sizeof(u));
+  memset(v, 0, sizeof(v));
+  memset(x, 0, sizeof(x));
+
   p = b;  i = n;
   do
   {
