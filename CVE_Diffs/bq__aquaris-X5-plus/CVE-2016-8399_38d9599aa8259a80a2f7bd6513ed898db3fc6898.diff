bq__aquaris-X5-plus
commit 38d9599aa8259a80a2f7bd6513ed898db3fc6898
Author:     Ravi Kumar Siddojigari <rsiddoji@codeaurora.org>
AuthorDate: Wed Nov 23 16:57:47 2016 +0530
Commit:     Gerrit - the friendly Code Review server <code-review@localhost>
CommitDate: Thu Dec 15 01:04:38 2016 -0800

    net: add additional args validation in ping_common_sendmsg()
    
    adding  validation of the len variable in ping_common_sendmsg()
    to check if it is less than icmph_len which canleading to
    an overflow issue.
    
    Addressing issue reported under CVE-2016-8399.
    
    Change-Id: I98f7b070b41312832b6a347ea1c11b9c700159a7
    Signed-off-by: Ravi Kumar Siddojigari <rsiddoji@codeaurora.org>

diff --git a/net/ipv4/ping.c b/net/ipv4/ping.c
index f8c8f60ad7e..aaa70dd6666 100644
--- a/net/ipv4/ping.c
+++ b/net/ipv4/ping.c
@@ -651,7 +651,7 @@ int ping_common_sendmsg(int family, struct msghdr *msg, size_t len,
 			void *user_icmph, size_t icmph_len) {
 	u8 type, code;
 
-	if (len > 0xFFFF)
+	if (len > 0xFFFF || len < icmph_len)
 		return -EMSGSIZE;
 
 	/*
