FFmpeg__FFmpeg
commit 2647ca45814a4ba60643a312f8caf0891fc3fc04
Author:     Michael Niedermayer <michael@niedermayer.cc>
AuthorDate: Sat Dec 10 20:15:12 2016 +0100
Commit:     Michael Niedermayer <michael@niedermayer.cc>
CommitDate: Wed Feb 8 21:17:50 2017 +0100

    avformat/options_table: Set the default maximum number of streams to 1000
    
    Fixes CVE-2016-9561, Note the security relevance of this is disputed as
    running out of memory can happen with valid files
    
    Suggested-by: Andreas Cadhalpun <andreas.cadhalpun@googlemail.com>
    Reviewed-by: Andreas Cadhalpun <andreas.cadhalpun@googlemail.com>
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
    (cherry picked from commit 30581c51e72a7a7ea1572c1c6039f6e4c590a55c)
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavformat/options_table.h b/libavformat/options_table.h
index 10cd793ef1..1ffce5e068 100644
--- a/libavformat/options_table.h
+++ b/libavformat/options_table.h
@@ -109,7 +109,7 @@ static const AVOption avformat_options[] = {
 {"dump_separator", "set information dump field separator", OFFSET(dump_separator), AV_OPT_TYPE_STRING, {.str = ", "}, CHAR_MIN, CHAR_MAX, D|E},
 {"codec_whitelist", "List of decoders that are allowed to be used", OFFSET(codec_whitelist), AV_OPT_TYPE_STRING, { .str = NULL },  CHAR_MIN, CHAR_MAX, D },
 {"format_whitelist", "List of demuxers that are allowed to be used", OFFSET(format_whitelist), AV_OPT_TYPE_STRING, { .str = NULL },  CHAR_MIN, CHAR_MAX, D },
-{"max_streams", "maximum number of streams", OFFSET(max_streams), AV_OPT_TYPE_INT, { .i64 = INT_MAX }, 0, INT_MAX, D },
+{"max_streams", "maximum number of streams", OFFSET(max_streams), AV_OPT_TYPE_INT, { .i64 = 1000 }, 0, INT_MAX, D },
 {NULL},
 };
 
