FFmpeg__FFmpeg
commit 976a7b72a3f51c18fee573985987bdcdd445af0d
Author:     Luca Barbato <lu_zero@gentoo.org>
AuthorDate: Tue Aug 6 03:52:48 2013 +0200
Commit:     Reinhard Tartler <siretart@tauware.de>
CommitDate: Sat Feb 1 14:02:20 2014 -0500

    avi: directly resync on DV in AVI read failure
    
    Reported-by: Mateusz "j00ru" Jurczyk and Gynvael Coldwind
    CC: libav-stable@libav.org
    (cherry picked from commit ceec6e792e4b5baaa23b220f4fd33417631f5288)
    Signed-off-by: Reinhard Tartler <siretart@tauware.de>
    
    Adresses CVE-2013-0856
    (cherry picked from commit 61057f4604eb909ac2b37f08c7d2b0ed758fd4bf)
    Signed-off-by: Reinhard Tartler <siretart@tauware.de>

diff --git a/libavformat/avidec.c b/libavformat/avidec.c
index 11d086cbe8..8d06c9a1d2 100644
--- a/libavformat/avidec.c
+++ b/libavformat/avidec.c
@@ -986,6 +986,8 @@ static int avi_read_packet(AVFormatContext *s, AVPacket *pkt)
         int size = avpriv_dv_get_packet(avi->dv_demux, pkt);
         if (size >= 0)
             return size;
+        else
+            goto resync;
     }
 
     if(avi->non_interleaved){
