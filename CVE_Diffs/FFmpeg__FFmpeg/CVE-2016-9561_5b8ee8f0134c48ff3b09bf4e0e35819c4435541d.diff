FFmpeg__FFmpeg
commit 5b8ee8f0134c48ff3b09bf4e0e35819c4435541d
Author:     Michael Niedermayer <michael@niedermayer.cc>
AuthorDate: Sat Dec 10 20:15:12 2016 +0100
Commit:     Michael Niedermayer <michael@niedermayer.cc>
CommitDate: Wed Feb 8 20:32:01 2017 +0100

    avformat/options_table: Set the default maximum number of streams to 1000
    
    Fixes CVE-2016-9561, Note the security relevance of this is disputed as
    running out of memory can happen with valid files
    
    Suggested-by: Andreas Cadhalpun <andreas.cadhalpun@googlemail.com>
    Reviewed-by: Andreas Cadhalpun <andreas.cadhalpun@googlemail.com>
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
    (cherry picked from commit 30581c51e72a7a7ea1572c1c6039f6e4c590a55c)
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavformat/options_table.h b/libavformat/options_table.h
index 930813a9d1..416a0dae1c 100644
--- a/libavformat/options_table.h
+++ b/libavformat/options_table.h
@@ -103,7 +103,7 @@ static const AVOption avformat_options[] = {
 {"format_whitelist", "List of demuxers that are allowed to be used", OFFSET(format_whitelist), AV_OPT_TYPE_STRING, { .str = NULL },  CHAR_MIN, CHAR_MAX, D },
 {"protocol_whitelist", "List of protocols that are allowed to be used", OFFSET(protocol_whitelist), AV_OPT_TYPE_STRING, { .str = NULL },  CHAR_MIN, CHAR_MAX, D },
 {"protocol_blacklist", "List of protocols that are not allowed to be used", OFFSET(protocol_blacklist), AV_OPT_TYPE_STRING, { .str = NULL },  CHAR_MIN, CHAR_MAX, D },
-{"max_streams", "maximum number of streams", OFFSET(max_streams), AV_OPT_TYPE_INT, { .i64 = INT_MAX }, 0, INT_MAX, D },
+{"max_streams", "maximum number of streams", OFFSET(max_streams), AV_OPT_TYPE_INT, { .i64 = 1000 }, 0, INT_MAX, D },
 {NULL},
 };
 
