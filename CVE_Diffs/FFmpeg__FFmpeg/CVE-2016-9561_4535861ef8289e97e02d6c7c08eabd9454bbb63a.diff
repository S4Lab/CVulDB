FFmpeg__FFmpeg
commit 4535861ef8289e97e02d6c7c08eabd9454bbb63a
Author:     Michael Niedermayer <michael@niedermayer.cc>
AuthorDate: Sat Dec 10 20:15:12 2016 +0100
Commit:     Michael Niedermayer <michael@niedermayer.cc>
CommitDate: Fri Feb 3 15:59:14 2017 +0100

    avformat/options_table: Set the default maximum number of streams to 1000
    
    Fixes CVE-2016-9561, Note the security relevance of this is disputed as
    running out of memory can happen with valid files
    
    Suggested-by: Andreas Cadhalpun <andreas.cadhalpun@googlemail.com>
    Reviewed-by: Andreas Cadhalpun <andreas.cadhalpun@googlemail.com>
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
    (cherry picked from commit 30581c51e72a7a7ea1572c1c6039f6e4c590a55c)
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavformat/options_table.h b/libavformat/options_table.h
index 935da94ce6..20f87c4024 100644
--- a/libavformat/options_table.h
+++ b/libavformat/options_table.h
@@ -102,7 +102,7 @@ static const AVOption avformat_options[] = {
 {"codec_whitelist", "List of decoders that are allowed to be used", OFFSET(codec_whitelist), AV_OPT_TYPE_STRING, { .str = NULL },  CHAR_MIN, CHAR_MAX, D },
 {"format_whitelist", "List of demuxers that are allowed to be used", OFFSET(format_whitelist), AV_OPT_TYPE_STRING, { .str = NULL },  CHAR_MIN, CHAR_MAX, D },
 {"protocol_whitelist", "List of protocols that are allowed to be used", OFFSET(protocol_whitelist), AV_OPT_TYPE_STRING, { .str = NULL },  CHAR_MIN, CHAR_MAX, D },
-{"max_streams", "maximum number of streams", OFFSET(max_streams), AV_OPT_TYPE_INT, { .i64 = INT_MAX }, 0, INT_MAX, D },
+{"max_streams", "maximum number of streams", OFFSET(max_streams), AV_OPT_TYPE_INT, { .i64 = 1000 }, 0, INT_MAX, D },
 {NULL},
 };
 
