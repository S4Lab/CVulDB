FauxFaux__PuTTYTray
commit 5936c55c7f2d44f61c07bac36f3fb4e21872d320
Author:     Ben Harris <bjh21@bjh21.me.uk>
AuthorDate: Tue Oct 13 20:33:12 2015 +0100
Commit:     Ben Harris <bjh21@bjh21.me.uk>
CommitDate: Tue Oct 27 19:59:46 2015 +0000

    Check the x argument to check_boundary() more carefully.
    
    This is a minimal fix for CVE-2015-5309, and while it's probably
    unnecessary now, it seems worth committing for defence in depth and to
    give downstreams something reasonably non-intrusive to cherry-pick.

diff --git a/terminal.c b/terminal.c
index c7e2647e..ae85eb58 100644
--- a/terminal.c
+++ b/terminal.c
@@ -2344,7 +2344,7 @@ static void check_boundary(Terminal *term, int x, int y)
     termline *ldata;
 
     /* Validate input coordinates, just in case. */
-    if (x == 0 || x > term->cols)
+    if (x <= 0 || x > term->cols)
 	return;
 
     ldata = scrlineptr(y);
