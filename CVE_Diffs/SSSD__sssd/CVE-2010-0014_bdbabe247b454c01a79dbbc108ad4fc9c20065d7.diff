SSSD__sssd
commit bdbabe247b454c01a79dbbc108ad4fc9c20065d7
Author:     Sumit Bose <sbose@redhat.com>
AuthorDate: Thu Jan 7 10:26:02 2010 +0100
Commit:     Stephen Gallagher <sgallagh@redhat.com>
CommitDate: Mon Jan 11 08:19:20 2010 -0500

    Fix return value when offline and TGT is valid
    
    Fixes CVE-2010-0014

diff --git a/server/providers/krb5/krb5_auth.c b/server/providers/krb5/krb5_auth.c
index a124371ed..4386a7ede 100644
--- a/server/providers/krb5/krb5_auth.c
+++ b/server/providers/krb5/krb5_auth.c
@@ -939,7 +939,7 @@ static void krb5_resolve_done(struct tevent_req *req)
                 DEBUG(1, ("pam_add_response failed.\n"));
             }
 
-            pam_status = PAM_SUCCESS;
+            pam_status = PAM_AUTHINFO_UNAVAIL;
             dp_err = DP_ERR_OFFLINE;
             goto done;
         }
