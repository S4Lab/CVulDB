TurboVNC__turbovnc
commit 133113c23ee171002352a90cb196d7e1630f19e1
Author:     DRC <dcommander@users.sourceforge.net>
AuthorDate: Fri Dec 12 16:00:35 2014 +0000
Commit:     DRC <dcommander@users.sourceforge.net>
CommitDate: Fri Dec 12 16:00:35 2014 +0000

    From 7553082b9b883b5f130044f3d53bce2f0b660e52 Mon Sep 17 00:00:00 2001
    From: Alan Coopersmith <alan.coopersmith@oracle.com>
    Date: Sun, 26 Jan 2014 17:18:54 -0800
    Subject: xcmisc: unvalidated length in SProcXCMiscGetXIDList() [CVE-2014-8096]
    
    Signed-off-by: Alan Coopersmith <alan.coopersmith@oracle.com>
    Reviewed-by: Peter Hutterer <peter.hutterer@who-t.net>
    
    
    git-svn-id: svn+ssh://svn.code.sf.net/p/turbovnc/code/trunk@2939 799e4f7b-5fd2-41f6-823c-2ecc41bc7f0b

diff --git a/unix/Xvnc/programs/Xserver/Xext/xcmisc.c b/unix/Xvnc/programs/Xserver/Xext/xcmisc.c
index 99a6ece4..4f7d7d27 100644
--- a/unix/Xvnc/programs/Xserver/Xext/xcmisc.c
+++ b/unix/Xvnc/programs/Xserver/Xext/xcmisc.c
@@ -161,6 +161,7 @@ static int
 SProcXCMiscGetXIDList(ClientPtr client)
 {
     REQUEST(xXCMiscGetXIDListReq);
+    REQUEST_SIZE_MATCH(xXCMiscGetXIDListReq);
 
     swaps(&stuff->length);
     swapl(&stuff->count);
