TurboVNC__turbovnc
commit 0ce339073153cea223a2a7233bc2f3f8aa0d4e4a
Author:     DRC <dcommander@users.sourceforge.net>
AuthorDate: Fri Dec 12 16:10:31 2014 +0000
Commit:     DRC <dcommander@users.sourceforge.net>
CommitDate: Fri Dec 12 16:10:31 2014 +0000

    From a0ece23a8bd300c8be10812d368dc8058c97c63e Mon Sep 17 00:00:00 2001
    From: Alan Coopersmith <alan.coopersmith@oracle.com>
    Date: Sun, 26 Jan 2014 20:02:20 -0800
    Subject: xfixes: unvalidated length in SProcXFixesSelectSelectionInput
     [CVE-2014-8102]
    
    Signed-off-by: Alan Coopersmith <alan.coopersmith@oracle.com>
    Reviewed-by: Peter Hutterer <peter.hutterer@who-t.net>
    
    
    git-svn-id: svn+ssh://svn.code.sf.net/p/turbovnc/code/trunk@2944 799e4f7b-5fd2-41f6-823c-2ecc41bc7f0b

diff --git a/unix/Xvnc/programs/Xserver/xfixes/select.c b/unix/Xvnc/programs/Xserver/xfixes/select.c
index a896846a..918a550a 100644
--- a/unix/Xvnc/programs/Xserver/xfixes/select.c
+++ b/unix/Xvnc/programs/Xserver/xfixes/select.c
@@ -204,6 +204,7 @@ SProcXFixesSelectSelectionInput(ClientPtr client)
 {
     REQUEST(xXFixesSelectSelectionInputReq);
 
+    REQUEST_SIZE_MATCH(xXFixesSelectSelectionInputReq);
     swaps(&stuff->length);
     swapl(&stuff->window);
     swapl(&stuff->selection);
