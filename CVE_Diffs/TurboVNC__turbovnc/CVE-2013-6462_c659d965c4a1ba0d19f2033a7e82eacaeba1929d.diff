TurboVNC__turbovnc
commit c659d965c4a1ba0d19f2033a7e82eacaeba1929d
Author:     DRC <dcommander@users.sourceforge.net>
AuthorDate: Fri Dec 12 14:20:04 2014 +0000
Commit:     DRC <dcommander@users.sourceforge.net>
CommitDate: Fri Dec 12 14:20:04 2014 +0000

    From 4d024ac10f964f6bd372ae0dd14f02772a6e5f63 Mon Sep 17 00:00:00 2001
    From: Alan Coopersmith <alan.coopersmith at oracle.com>
    Date: Mon, 23 Dec 2013 18:34:02 -0800
    Subject: [PATCH:libXfont] CVE-2013-6462: unlimited sscanf overflows stack
     buffer in bdfReadCharacters()
    
    Fixes cppcheck warning:
     [lib/libXfont/src/bitmap/bdfread.c:341]: (warning)
      scanf without field width limits can crash with huge input data.
    
    Signed-off-by: Alan Coopersmith <alan.coopersmith at oracle.com>
    Reviewed-by: Matthieu Herrb <matthieu at herrb.eu>
    Reviewed-by: Jeremy Huddleston Sequoia <jeremyhu at apple.com>
    
    
    git-svn-id: svn+ssh://svn.code.sf.net/p/turbovnc/code/trunk@2924 799e4f7b-5fd2-41f6-823c-2ecc41bc7f0b

diff --git a/unix/Xvnc/lib/libXfont/bitmap/bdfread.c b/unix/Xvnc/lib/libXfont/bitmap/bdfread.c
index e2770dc1..e11c5d26 100644
--- a/unix/Xvnc/lib/libXfont/bitmap/bdfread.c
+++ b/unix/Xvnc/lib/libXfont/bitmap/bdfread.c
@@ -338,7 +338,7 @@ bdfReadCharacters(FontFilePtr file, FontPtr pFont, bdfFileState *pState,
 	char        charName[100];
 	int         ignore;
 
-	if (sscanf((char *) line, "STARTCHAR %s", charName) != 1) {
+	if (sscanf((char *) line, "STARTCHAR %99s", charName) != 1) {
 	    bdfError("bad character name in BDF file\n");
 	    goto BAILOUT;	/* bottom of function, free and return error */
 	}
