TurboVNC__turbovnc
commit 08c40b3ea902f5d8d5e100865cc22f7532c976bf
Author:     DRC <dcommander@users.sourceforge.net>
AuthorDate: Fri Dec 12 16:07:08 2014 +0000
Commit:     DRC <dcommander@users.sourceforge.net>
CommitDate: Fri Dec 12 16:07:08 2014 +0000

    From b5f9ef03df6a650571b29d3d1c1d2b67c6e84336 Mon Sep 17 00:00:00 2001
    From: Julien Cristau <jcristau@debian.org>
    Date: Tue, 28 Oct 2014 10:30:04 +0100
    Subject: render: check request size before reading it [CVE-2014-8100 1/2]
    
    Otherwise we may be reading outside of the client request.
    
    Signed-off-by: Julien Cristau <jcristau@debian.org>
    Reviewed-by: Alan Coopersmith <alan.coopersmith@oracle.com>
    Signed-off-by: Alan Coopersmith <alan.coopersmith@oracle.com>
    
    
    git-svn-id: svn+ssh://svn.code.sf.net/p/turbovnc/code/trunk@2942 799e4f7b-5fd2-41f6-823c-2ecc41bc7f0b

diff --git a/unix/Xvnc/programs/Xserver/render/render.c b/unix/Xvnc/programs/Xserver/render/render.c
index 344ca75e..5716558a 100644
--- a/unix/Xvnc/programs/Xserver/render/render.c
+++ b/unix/Xvnc/programs/Xserver/render/render.c
@@ -271,6 +271,8 @@ ProcRenderQueryVersion(ClientPtr client)
 
     REQUEST(xRenderQueryVersionReq);
 
+    REQUEST_SIZE_MATCH(xRenderQueryVersionReq);
+
     pRenderClient->major_version = stuff->majorVersion;
     pRenderClient->minor_version = stuff->minorVersion;
 
