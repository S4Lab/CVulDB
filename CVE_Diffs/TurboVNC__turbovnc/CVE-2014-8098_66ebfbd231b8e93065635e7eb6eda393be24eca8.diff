TurboVNC__turbovnc
commit 66ebfbd231b8e93065635e7eb6eda393be24eca8
Author:     Adam Jackson <ajax@redhat.com>
AuthorDate: Mon Nov 10 12:13:46 2014 -0500
Commit:     DRC <information@virtualgl.org>
CommitDate: Tue Aug 8 15:35:21 2017 -0500

    glx: Length-checking for non-generated vendor private requests [CVE-2014-8098 6/8]
    
    Reviewed-by: Keith Packard <keithp@keithp.com>
    Reviewed-by: Michal Srb <msrb@suse.com>
    Reviewed-by: Andy Ritger <aritger@nvidia.com>
    Signed-off-by: Adam Jackson <ajax@redhat.com>
    Signed-off-by: Alan Coopersmith <alan.coopersmith@oracle.com>

diff --git a/unix/Xvnc/programs/Xserver/glx/indirect_program.c b/unix/Xvnc/programs/Xserver/glx/indirect_program.c
index 3b50ecd5..566e645e 100644
--- a/unix/Xvnc/programs/Xserver/glx/indirect_program.c
+++ b/unix/Xvnc/programs/Xserver/glx/indirect_program.c
@@ -69,6 +69,8 @@ DoGetProgramString(struct __GLXclientStateRec *cl, GLbyte * pc,
     __GLXcontext *const cx = __glXForceCurrent(cl, req->contextTag, &error);
     ClientPtr client = cl->client;
 
+    REQUEST_FIXED_SIZE(xGLXVendorPrivateWithReplyReq, 8);
+
     pc += __GLX_VENDPRIV_HDR_SIZE;
     if (cx != NULL) {
         GLenum target;
diff --git a/unix/Xvnc/programs/Xserver/glx/swap_interval.c b/unix/Xvnc/programs/Xserver/glx/swap_interval.c
index 7533d264..90636f1c 100644
--- a/unix/Xvnc/programs/Xserver/glx/swap_interval.c
+++ b/unix/Xvnc/programs/Xserver/glx/swap_interval.c
@@ -50,6 +50,8 @@ DoSwapInterval(__GLXclientState * cl, GLbyte * pc, int do_swap)
     __GLXcontext *cx;
     GLint interval;
 
+    REQUEST_FIXED_SIZE(xGLXVendorPrivateReq, 4);
+
     cx = __glXLookupContextByTag(cl, tag);
 
     if ((cx == NULL) || (cx->pGlxScreen == NULL)) {
