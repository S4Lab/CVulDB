k-takata__Onigmo
commit 32d1be0c7e745bdcb5cf0f82d6aaf6c5cc1ae882
Author:     K.Takata <kentkt@csc.jp>
AuthorDate: Mon Jul 17 13:42:47 2017 +0900
Commit:     K.Takata <kentkt@csc.jp>
CommitDate: Mon Jul 17 13:42:47 2017 +0900

    Add a test for CVE-2017-9228

diff --git a/testpy.py b/testpy.py
index 44f33da..c6b635b 100755
--- a/testpy.py
+++ b/testpy.py
@@ -1284,6 +1284,7 @@ def main():
     x3("\\(((?:[^(]|\\g<0>)*)\\)", "((abc)(abc))", 1, 11, 1)
     x3("\\(((?:[^(]|(\\g<0>))*)\\)", "((abc)(abc))", 6, 11, 2)
     n("[\\6000", "a", err=onigmo.ONIGERR_TOO_BIG_NUMBER)   # CVE-2017-9226
+    n("[\\H- ]", "", err=onigmo.ONIGERR_UNMATCHED_RANGE_SPECIFIER_IN_CHAR_CLASS)  # CVE-2017-9228
 
     # ONIG_OPTION_FIND_LONGEST option
     x2("foo|foobar", "foobar", 0, 3)
