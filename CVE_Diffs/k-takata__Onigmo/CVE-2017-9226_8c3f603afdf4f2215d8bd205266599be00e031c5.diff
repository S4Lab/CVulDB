k-takata__Onigmo
commit 8c3f603afdf4f2215d8bd205266599be00e031c5
Author:     K.Takata <kentkt@csc.jp>
AuthorDate: Mon Jul 17 12:44:18 2017 +0900
Commit:     K.Takata <kentkt@csc.jp>
CommitDate: Mon Jul 17 12:50:06 2017 +0900

    Add a test for CVE-2017-9226

diff --git a/testpy.py b/testpy.py
index 26d43fe..44f33da 100755
--- a/testpy.py
+++ b/testpy.py
@@ -1283,6 +1283,7 @@ def main():
     x3("\\(((?:[^(]|\\g<0>)*)\\)", "(abc)(abc)", 1, 4, 1)   # Issue #48
     x3("\\(((?:[^(]|\\g<0>)*)\\)", "((abc)(abc))", 1, 11, 1)
     x3("\\(((?:[^(]|(\\g<0>))*)\\)", "((abc)(abc))", 6, 11, 2)
+    n("[\\6000", "a", err=onigmo.ONIGERR_TOO_BIG_NUMBER)   # CVE-2017-9226
 
     # ONIG_OPTION_FIND_LONGEST option
     x2("foo|foobar", "foobar", 0, 3)
